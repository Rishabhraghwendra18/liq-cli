<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Dist</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.2/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.2/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.2/favicon_yellow.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.2/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.2/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2021-02-27T09:22:09+00:00">2021-02-27T09:22:09+00:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="yellow">82.26%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         11.43
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>4</b> files in total.
    <b>5326</b> relevant lines. 
    <span class="green"><b>4381</b> lines covered</span> and
    <span class="red"><b>945</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#492aacf5bf1da67ce38330f05575b76085e81713" class="src_link" title="completion.sh">completion.sh</a></td>
        <td class="red strong">0.0 %</td>
        <td>240</td>
        <td>127</td>
        <td>0</td>
        <td>127</td>
        <td>0.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4a0d84ea2272c5ebb783c856281f0ccec1638c0f" class="src_link" title="install.sh">install.sh</a></td>
        <td class="red strong">0.0 %</td>
        <td>929</td>
        <td>517</td>
        <td>0</td>
        <td>517</td>
        <td>0.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#974ec74da59508a7de47d18417955274b6ff54d1" class="src_link" title="liq-shell.sh">liq-shell.sh</a></td>
        <td class="red strong">0.0 %</td>
        <td>381</td>
        <td>140</td>
        <td>0</td>
        <td>140</td>
        <td>0.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a13aa571c8f50d36a64038c0d139b624fa456626" class="src_link" title="liq.sh">liq.sh</a></td>
        <td class="green strong">96.46 %</td>
        <td>4694</td>
        <td>4542</td>
        <td>4381</td>
        <td>161</td>
        <td>13.4</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.15.1 
        and simplecov-html v0.10.2<br/>
        using /usr/local/bin/bash bats --no-tempdir-cleanup --formatter tap /home/liq/test/
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="492aacf5bf1da67ce38330f05575b76085e81713">
  <div class="header">
    <h3>completion.sh</h3>
    <h4><span class="red">0.0 %</span> covered</h4>
    <div>
      <b>127</b> relevant lines. 
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>127</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># After updating this file, run &#39;./install.sh&#39; and open a new terminal for the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># changes to take effect.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># TODO: we could generate this from the help docs... make the spec central!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">_liq() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Most of this fuction is setup for various handler functions. The actual dispatch is at the very end.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # TODO: include &#39;global-vars.sh&#39; (and maybe break into &#39;common&#39; and &#39;runtime&#39;?) once we build this file.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">  local LIQ_DB_BASENAME=&quot;.liq&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">  local LIQ_DB=&quot;${HOME}/${LIQ_DB_BASENAME}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">  local GLOBAL_ACTIONS=&quot;help ?&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  # Using &#39;GROUPS&#39; was causing errors; set by some magic.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">  local ACTION_GROUPS=&quot;meta orgs projects work&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">  local TOKEN COMP_FUNC CUR OPTS PREV WORK_COUNT TOKEN_COUNT IS_LIQ_ENV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">  if [[ -n &quot;${COMP_WORDS}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    CUR=&quot;${COMP_WORDS[COMP_CWORD]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    PREV=&quot;${COMP_WORDS[COMP_CWORD-1]}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">  if [[ -n &quot;${COMP_WORDS}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    WORD_COUNT=${#COMP_WORDS[@]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    WORD_COUND=0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">  if [[ &quot;$CUR&quot; == &#39;?&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    CUR=&#39;help&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">  no-opts() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    COMPREPLY=( $(compgen -W &quot;&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">  std-reply() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    COMPREPLY=( $(compgen -W &quot;${OPTS}&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">  proj-paths-reply() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    local MATCH=&quot;${1}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    if [[ &quot;${CUR}&quot; != */* ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -o nospace -W &quot;$(find ~/playground -type d -maxdepth 1 -mindepth 1 -not -name &quot;.*&quot; | awk -F/ &#39;{ print $NF&quot;/&quot; }&#39;)&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      # TODO: check that &#39;MATCH&#39; matches /^[a-z0-9-_ *?]$/i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">      # TODO: source and use LIQ_PLAYGROUND</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -W &quot;$(ls -d &quot;${HOME}/playground/${CUR}&quot;${MATCH} | awk -F/ &#39;{ print $(NF - 1)&quot;/&quot;$NF }&#39;)&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">  comp-liq() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    OPTS=&quot;${GLOBAL_ACTIONS} ${ACTION_GROUPS}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    [[ &quot;${IS_LIQ_ENV}&quot; == true ]] &amp;&amp; OPTS=&quot;${OPTS} quit&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    std-reply</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">  comp-liq-help() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    OPTS=&quot;${ACTION_GROUPS}&quot;; std-reply</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">  comp-func-builder() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    local TOKEN_PATH=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    local VAR_KEY=&quot;${2}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    local NO_SQUASH_ACTIONS=&quot;${3:-}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    local OPT</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    local ACTIONS_VAR=&quot;${VAR_KEY}_ACTIONS&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    local GROUPS_VAR=&quot;${VAR_KEY}_GROUPS&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    # These functions are dynamic based on the ACTION and GROUP vars so don&#39;t need to be overriden; doing so may kill</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    # custom completion functions. Note that this means that a previously defined function with a new def needs to be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    # unset first.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    if ! type -t comp-liq-${TOKEN_PATH} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      # tThe double escape is first for this string, and then when it goes through &#39;eval&#39;. This way we keep the function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      # response dynamic rather than freezing it at the point in time when it&#39;s built.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      echo &quot;comp-liq-${TOKEN_PATH}() { OPTS=\&quot;\\\${${ACTIONS_VAR}:-} \\\${${GROUPS_VAR}:-}\&quot;; std-reply; }&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    if ! type -t comp-liq-help-${TOKEN_PATH} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      echo &quot;comp-liq-help-${TOKEN_PATH}() { OPTS=\&quot;\\\${${ACTIONS_VAR}:-} \\\${${GROUPS_VAR}:-}\&quot;; std-reply; }&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    for OPT in ${!ACTIONS_VAR}; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      if [[ -z &quot;$NO_SQUASH_ACTIONS&quot; ]] || ! type -t comp-liq-${TOKEN_PATH}-${OPT} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">        echo &quot;function comp-liq-${TOKEN_PATH}-${OPT}() { no-opts; }&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">        echo &quot;function comp-liq-help-${TOKEN_PATH}-${OPT}() { no-opts; }&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  # environments group</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">  local ENVIRONMENTS_ACTIONS=&quot;add delete deselect list select set show update&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;environments&#39; &#39;ENVIRONMENTS&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  # meta group</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">  local META_ACTIONS=&quot;bash-config init next&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">  local META_GROUPS=&quot;exts&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;meta&#39; &#39;META&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">  META_EXTS_ACTIONS=&quot;install list uninstall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;meta-exts&#39; &#39;META_EXTS&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">  comp-liq-meta-exts-install() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    if [[ &quot;${PREV}&quot; == &#39;install&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -W &quot;--local --registry&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    elif [[ &quot;${PREV}&quot; == &quot;--local&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      proj-paths-reply &quot;*-ext-*&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    # Currently no completion for registry packages.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">  comp-liq-meta-exts-uninstall() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    # TODO: this is essentially the same logic aas &#39;liq meta exts list&#39;; change completion to use &#39;rollup-bash&#39; and share code</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    if [[ -f ${LIQ_DB}/exts/exts.sh ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -W &quot;$(cat &quot;${LIQ_DB}/exts/exts.sh&quot; | awk -F/ &#39;NF { print $(NF-3)&quot;/&quot;$(NF-2) }&#39;)&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">  local ORGS_ACTIONS=&quot;affiliate create list show select&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">  local ORGS_GROUPS=&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  # will override the &#39;comp-liq-orgs&#39;, but want to generate the &#39;help&#39; completer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;orgs&#39; &#39;ORGS&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  # helper funtion for &#39;--org&#39; option values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">  comp-selector-orgs() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    COMPREPLY=( $(compgen -W &quot;$(find ~/${LIQ_DB_BASENAME}/orgs -maxdepth 1 -mindepth 1 -type l -exec basename {} \;)&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  # Handles generating COMPREPLY when using common orgs parameters. Returns true (0) if COMPREPLY is generated and false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  # if the caller still needs to generate COMPREPLY. If COMPREPLY is not set, then this function may update &#39;OPTS&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  # which should be declared locally before invoking comp-builder-ors-common-params. Thus, the general usage is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  # something like:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  # ```</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  # local OPTS=&quot;--foo --bar&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  # comp-builder-orgs-common-params || std-reply</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  # ```</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">  comp-builder-orgs-common-params() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    if [[ &quot;${PREV}&quot; == &quot;--org&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">      comp-selector-orgs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      return 0 # bash true; meaning &quot;the COMPREPLY has been handled&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">      if [[ &quot;${COMP_LINE}&quot; != *--org* ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">        if [[ -z &quot;${OPTS}&quot; ]]; then OPTS=&quot;--org&quot;; else OPTS=&quot;${OPTS} --org&quot;; fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      return 1 # bash false; mening &quot;the COMPREPLY has not been handled&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">  local PROJECTS_ACTIONS=&quot;build close create edit publish qa sync test&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">  local PROJECTS_GROUPS=&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;projects&#39; &#39;PROJECTS&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">  comp-liq-projects-create() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">    if [[ &quot;${PREV}&quot; == &quot;create&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -W &quot;--new --source&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">    elif [[ &quot;${PREV}&quot; == &quot;--new&quot; ]] || [[ &quot;${PREV}&quot; == &quot;-n&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">      COMPREPLY=( $(compgen -W &quot;raw&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">  comp-liq-projects-close() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    if [[ &quot;${COMP_LINE}&quot; != *&#39;/&#39;? ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      proj-paths-reply &#39;*&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">  local WORK_ACTIONS=&quot;diff-master edit ignore-rest involve list merge qa report resume save stage start status stop submit sync&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">  local WORK_GROUPS=&quot;issues links&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;work&#39; &#39;WORK&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">  comp-liq-work-stage() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">    # TODO: &#39;nospace&#39; is very unfortunately innefective (on MacOS 10.x AFAIK)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">    COMPREPLY=( $(compgen -o nospace -W &quot;$(for d in ${CUR}*; do [[ -d &quot;$d&quot; ]] &amp;&amp; echo &quot;$d/&quot; || echo &quot;$d&quot;; done)&quot; -- ${CUR}) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">  local WORK_ISSUES_ACTIONS=&quot;--add --list --remove&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;work-issues&#39; &#39;WORK_ISSUES&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">  local WORK_LINKS_ACTIONS=&quot;add list remove&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">  eval &quot;$(comp-func-builder &#39;work-links&#39; &#39;WORK_LINKS&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">  comp-liq-work-links-remove() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    OPTS=&quot;$(yalc check || true)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    # TODO: code adapated from &#39;work-links-list&#39;; once we build completion, let&#39;s share</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">    OPTS=&quot;$(echo &quot;$OPTS&quot; | awk -F: &#39;{print $2}&#39; | tr &quot;&#39;&quot; &#39;&quot;&#39; | jq -r &#39;.[]&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">    std-reply</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">  comp-liq-work-status() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">    local EX_OPTS=&quot;--list-projects --list-issues --pr-ready&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    local COMMON_OPTS=&quot;--no-fetch&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">    local i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">    for i in $COMMON_OPTS; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">      [[ $COMP_LINE != *&quot; ${i}&quot;* ]]  &amp;&amp; OPTS=&quot;${i} ${OPTS}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">    local EXES=false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">    for i in $EX_OPTS; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      if [[ $COMP_LINE == *&quot; ${i}&quot;* ]]; then EXES=true; break; fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">    [[ &quot;${EXES}&quot; == &#39;false&#39; ]] &amp;&amp; OPTS=&quot;${EX_OPTS} ${OPTS}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    # have they specified work?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">    local AFTER</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">    AFTER=&quot;${COMP_LINE/* status/}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    AFTER=&quot;${AFTER%$CUR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">    if [[ &quot;${PREV}&quot; == &#39;status&#39; ]] || ! { echo &quot;${AFTER}&quot; | grep -qE &#39;(^| )[a-zA-Z0-9][a-zA-Z0-9_.-]*( |$)&#39;; }; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      OPTS=&quot;${OPTS} $(find &quot;${LIQ_DB}/work&quot; -type f -maxdepth 1 -exec basename {} \;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">    std-reply</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  # TODO: Should we use LIQ_EXTS_DB here? This way, we&#39;re sidestepping the need to &#39;build&#39; the completion script...</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">  source &quot;${LIQ_DB}/exts/comps.sh&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">  TOKEN_COUNT=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">  if [[ &quot;${COMP_LINE}&quot; != &#39;liq &#39;* ]]; then # we are in the &#39;shell&#39; case, which omits the leading &#39;liq&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    COMP_FUNC=&#39;comp-liq&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">    IS_LIQ_ENV=true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">    COMP_FUNC=&#39;comp&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">    IS_LIQ_ENV=false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">  # Now we&#39;ve registered all the local and modular completion functions. We&#39;ll analyze the token stream to figure out</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  # which completion function to call:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">  [[ -n &quot;${COMP_WORDS}&quot; ]] &amp;&amp; for TOKEN in ${COMP_WORDS[@]}; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">    if [[ &quot;$TOKEN&quot; != -* ]] &amp;&amp; { (( $TOKEN_COUNT + 1 &lt; $WORD_COUNT )) || [[ &quot;${TOKEN}&quot; == &#39;liq&#39; ]]; }; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">      if [[ &quot;$(type -t &quot;${COMP_FUNC}-${TOKEN}&quot;)&quot; == &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">        COMP_FUNC=&quot;${COMP_FUNC}-${TOKEN}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">        TOKEN_COUNT=$(( $TOKEN_COUNT + 1 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">      TOKEN_COUNT=$(( $TOKEN_COUNT + 1 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  # Execute the compeltion function determined above:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">  $COMP_FUNC</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">  return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">complete -F _liq liq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"># complete -F _liq</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4a0d84ea2272c5ebb783c856281f0ccec1638c0f">
  <div class="header">
    <h3>install.sh</h3>
    <h4><span class="red">0.0 %</span> covered</h4>
    <div>
      <b>517</b> relevant lines. 
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>517</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby">#!/usr/bin/env bash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># http://linuxcommand.org/lc3_adv_tput.php</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">red=`tput setaf 1`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">green=`tput setaf 2`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">yellow=`tput setaf 3`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">blue=`tput setaf 4`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">purple=`tput setaf 5`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">cyan=`tput setaf 6`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">white=`tput setaf 7`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">bold=`tput bold`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">red_b=&quot;${red}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">green_b=&quot;${green}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">yellow_b=&quot;${yellow}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">blue_b=&quot;${blue}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">purple_b=&quot;${purple}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">cyan_b=&quot;${cyan}${bold}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">white_b=&quot;${white}${bold}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">underline=`tput smul`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">red_u=&quot;${red}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">green_u=&quot;${green}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">yellow_u=&quot;${yellow}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">blue_u=&quot;${blue}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">purple_u=&quot;${purple}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">cyan_u=&quot;${cyan}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">white_u=&quot;${white}${underline}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">red_bu=&quot;${red}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">green_bu=&quot;${green}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">yellow_bu=&quot;${yellow}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">blue_bu=&quot;${blue}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">purple_bu=&quot;${purple}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">cyan_bu=&quot;${cyan}${bold}${underline}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">white_bu=&quot;${white}${bold}${underline}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">reset=`tput sgr0`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">list-add-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    # TODO: enforce no newlines in item</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    if [[ -n &quot;$ITEM&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      if [[ -z &quot;${!LIST_VAR:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">        eval $LIST_VAR=&#39;&quot;$ITEM&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        # echo $LIST_VAR=&#39;&quot;${!LIST_VAR}&quot;$&#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;&quot;${ITEM}&quot;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">        eval $LIST_VAR=&#39;&quot;${!LIST_VAR}&quot;$&#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;&quot;${ITEM}&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">list-add-uniq() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    # TODO: enforce no newlines in item</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    if [[ -z $(list-get-index $LIST_VAR &quot;$ITEM&quot;) ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      list-add-item $LIST_VAR &quot;$ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"># Echos the number of items in the list.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"># Takes single argument, the list var name.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"># list-add-item A B C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"># list-count MY_LIST # echos &#39;3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">list-count() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">  if [[ -z &quot;${!1:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    echo -n &quot;0&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    echo -e &quot;${!1}&quot; | wc -l | tr -d &#39;[:space:]&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">list-from-csv() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">  local CSV=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">  if [[ -z &quot;$CSV&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    CSV=&quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    unset ${LIST_VAR}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">  if [[ -n &quot;$CSV&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    local ADDR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    while IFS=&#39;,&#39; read -ra ADDR; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      for i in &quot;${ADDR[@]}&quot;; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">        i=&quot;$(echo &quot;$i&quot; | awk &#39;{$1=$1};1&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">        list-add-item &quot;$LIST_VAR&quot; &quot;$i&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    done &lt;&lt;&lt; &quot;$CSV&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">list-get-index() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">  local TEST=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">  local INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    if [[ &quot;${ITEM}&quot; == &quot;${TEST}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      echo $INDEX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">    INDEX=$(($INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">list-get-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">  local INDEX=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">  local CURR_INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">    if (( $CURR_INDEX == $INDEX )) ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      echo -n &quot;${ITEM%\\n}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">    CURR_INDEX=$(($CURR_INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"># Echoes the frist item in the named list matching the given prefix.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"># LIST=&quot;foo bar&quot;$&#39;\n&#39;&quot;foo baz&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"># list-get-item-by-prefix LIST &quot;foo &quot; # echoes &#39;foo bar&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">list-get-item-by-prefix() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">  local PREFIX=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    if [[ &quot;${ITEM}&quot; == &quot;${PREFIX}&quot;* ]] ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">      echo -n &quot;${ITEM%\\n}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"># Joins a list with a given string and echos the result. We use &#39;echo -e&#39; for the join string, so &#39;\n&#39;, &#39;\t&#39;, etc. will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"># work.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"># Takes (1) the list variable name, (2) the join string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"># list-add-item MY_LIST A B C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"># list-join MY_LIST &#39;||&#39; # echos &#39;A||B||C&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">list-join() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">  local JOIN_STRING=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">  local CURR_INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">  local COUNT</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">  COUNT=&quot;$(list-count $LIST_VAR)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">    echo -n &quot;$ITEM&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    CURR_INDEX=$(($CURR_INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">    if (( $CURR_INDEX &lt; $COUNT )) ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      echo -ne &quot;$JOIN_STRING&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">list-replace-by-string() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">  local TEST_ITEM=&quot;${2}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">  local NEW_ITEM=&quot;${3}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">  local ITEM INDEX NEW_LIST</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">  INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">  for ITEM in ${!LIST_VAR:-}; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    if [[ &quot;$(list-get-item $LIST_VAR $INDEX)&quot; == &quot;$TEST_ITEM&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">      list-add-item NEW_LIST &quot;$NEW_ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">      list-add-item NEW_LIST &quot;$ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    INDEX=$(($INDEX + 1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">  eval $LIST_VAR=&#39;&quot;&#39;&quot;$NEW_LIST&quot;&#39;&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">list-quote() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">    echo -n &quot;&#39;$(echo &quot;$ITEM&quot; | sed -e &quot;s/&#39;/&#39;\&quot;&#39;\&quot;&#39;/&quot;)&#39; &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">list-rm-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">    local ITEM NEW_ITEMS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">    ITEM=${ITEM//\/\\/}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">    ITEM=${ITEM//#/\\#}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    ITEM=${ITEM//./\\.}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    ITEM=${ITEM//[/\\[}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">    # echo &quot;ITEM: $ITEM&quot; &gt;&amp;2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">    NEW_ITEMS=&quot;$(echo &quot;${!LIST_VAR}&quot; | sed -e &#39;\#^&#39;&quot;${ITEM}&quot;&#39;$#d&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">    eval $LIST_VAR=&#39;&quot;&#39;&quot;$NEW_ITEMS&quot;&#39;&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">if [[ $(uname) == &#39;Darwin&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">  GNU_GETOPT=&quot;$(brew --prefix gnu-getopt)/bin/getopt&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="220">
          
          
          <code class="ruby">  GNU_GETOPT=&quot;$(which getopt)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"># Usage:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">#   eval &quot;$(setSimpleOptions SHORT LONG= SPECIFY_SHORT:X LONG_SPEC:S= -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">#     || ( contextHelp; echoerrandexit &quot;Bad options.&quot;; )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"># Note the use of the intermediate TMP is important to preserve the exit value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"># setSimpleOptions. E.g., doing &#39;eval &quot;$(setSimpleOptions ...)&quot;&#39; will work fine,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"># but because the last statement is the eval of the results, and not the function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"># call itself, the return of setSimpleOptions gets lost.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"># Instead, it&#39;s generally recommended to be strict, &#39;set -e&#39;, and use the TMP-form.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">setSimpleOptions() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">  local VAR_SPEC LOCAL_DECLS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">  local LONG_OPTS=&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">  local SHORT_OPTS=&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  # Bash Bug? This looks like a straight up bug in bash, but the left-paren in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">  # &#39;--)&#39; was matching the &#39;$(&#39; and causing a syntax error. So we use &#39;]&#39; and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  # replace it later.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">  local CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">    --]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">      break;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">  while true; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    if (( $# == 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      echoerrandexit &quot;setSimpleOptions: No argument to process; did you forget to include the &#39;--&#39; marker?&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">    VAR_SPEC=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">    local VAR_NAME LOWER_NAME SHORT_OPT LONG_OPT IS_PASSTHRU</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">    IS_PASSTHRU=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == *&#39;^&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">      IS_PASSTHRU=true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">      VAR_SPEC=${VAR_SPEC/%^/}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">    local OPT_ARG=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == *&#39;=&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">      OPT_ARG=&#39;:&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      VAR_SPEC=${VAR_SPEC/%=/}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="262">
          
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == &#39;--&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    elif [[ &quot;$VAR_SPEC&quot; == *&#39;:&#39;* ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">      VAR_NAME=$(echo &quot;$VAR_SPEC&quot; | cut -d: -f1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">      SHORT_OPT=$(echo &quot;$VAR_SPEC&quot; | cut -d: -f2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">    else # each input is a variable name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      VAR_NAME=&quot;$VAR_SPEC&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">      SHORT_OPT=$(echo &quot;${VAR_NAME::1}&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">    VAR_NAME=$(echo &quot;$VAR_NAME&quot; | tr -d &quot;=&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    LOWER_NAME=$(echo &quot;$VAR_NAME&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">    LONG_OPT=&quot;$(echo &quot;${LOWER_NAME}&quot; | tr &#39;_&#39; &#39;-&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">    if [[ -n &quot;${SHORT_OPT}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">      SHORT_OPTS=&quot;${SHORT_OPTS:-}${SHORT_OPT}${OPT_ARG}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">    LONG_OPTS=$( ( test ${#LONG_OPTS} -gt 0 &amp;&amp; echo -n &quot;${LONG_OPTS},&quot;) || true &amp;&amp; echo -n &quot;${LONG_OPT}${OPT_ARG}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">    LOCAL_DECLS=&quot;${LOCAL_DECLS:-}local ${VAR_NAME}=&#39;&#39;;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">    local CASE_SELECT=&quot;-${SHORT_OPT}|--${LONG_OPT}]&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">    if [[ &quot;$IS_PASSTHRU&quot; == true ]]; then # handle passthru</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">        ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">          ${CASE_SELECT}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">          list-add-item _PASSTHRU &quot;\$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">      if [[ -n &quot;$OPT_ARG&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="292">
          
          
          <code class="ruby">        CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">          ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">            list-add-item _PASSTHRU &quot;\$2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">            shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">        ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">          shift;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">    else # non-passthru vars</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">      local VAR_SETTER=&quot;${VAR_NAME}=true;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">      if [[ -n &quot;$OPT_ARG&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">        LOCAL_DECLS=&quot;${LOCAL_DECLS}local ${VAR_NAME}_SET=&#39;&#39;;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">        VAR_SETTER=${VAR_NAME}&#39;=&quot;${2}&quot;; &#39;${VAR_NAME}&#39;_SET=true; shift;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">      if [[ -z &quot;$SHORT_OPT&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">        CASE_SELECT=&quot;--${LONG_OPT}]&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">      ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">        ${CASE_SELECT}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">          $VAR_SETTER</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">          _OPTS_COUNT=\$(( \$_OPTS_COUNT + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">          shift;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  done # main while loop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">  CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">    case &quot;\${1}&quot; in</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">      $CASE_HANDLER</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">  # replace the &#39;]&#39;; see &#39;Bash Bug?&#39; above</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">  CASE_HANDLER=$(echo &quot;$CASE_HANDLER&quot; | perl -pe &#39;s/\]$/)/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">  echo &quot;$LOCAL_DECLS&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">  cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">local TMP # see https://unix.stackexchange.com/a/88338/84520</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">local _PASSTHRU=&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">TMP=\$(${GNU_GETOPT} -o &quot;${SHORT_OPTS}&quot; -l &quot;${LONG_OPTS}&quot; -- &quot;\$@&quot;) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">  || exit \$?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">eval set -- &quot;\$TMP&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">local _OPTS_COUNT=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">while true; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">  $CASE_HANDLER</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">if [[ -n &quot;\$_PASSTHRU&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">  eval set -- \$(list-quote _PASSTHRU) &quot;\$@&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">echoerr() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">  if [[ -z &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">    echo -e &quot;${red}$*${reset}&quot; | fold -sw 82 &gt;&amp;2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">    echo -e &quot;${red}$*${reset}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">echowarn() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="364">
          
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">  if [[ -z &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">    echo -e &quot;${yellow}$*${reset}&quot; | fold -sw 82 &gt;&amp;2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="371">
          
          
          <code class="ruby">    echo -e &quot;${yellow}$*${reset}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">echoerrandexit() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;) || $(echo &quot;Bad options: $*&quot;; exit -10)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">  local MSG=&quot;$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">  local EXIT_CODE=&quot;${2:-10}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">  # TODO: consider providing &#39;passopts&#39; method which coordites with &#39;setSimpleOptions&#39; to recreate option string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">  if [[ -n &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">    echoerr --no-fold &quot;$MSG&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">    echoerr &quot;$MSG&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">  exit $EXIT_CODE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="391">
          
          
          <code class="ruby">echo &quot;Starting liq install...&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby"># TODO: move to bash-toolkit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby"># Prints line with any standard format. First arg is the format name, everything else, along with any options, are</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby"># passed through to echo.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">echofmt() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_NEWLINE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">  local COLOR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">  [[ -n &quot;${!COLOR}&quot; ]]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">  OPTS=&quot;-e&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">  if [[ -n &quot;$NO_NEWLINE&quot; ]]; then OPTS=&quot;$OPTS -n&quot;; fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">  echo ${OPTS} &quot;${!COLOR}$*${reset}&quot; | fold -sw 82</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby"># Prints the line in green. Any options are passed through to echo.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">echogreen() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">  echofmt green &quot;$@&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby"># Basic indent of a line.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby">indent() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">  cat | sed -e &#39;s/^/  /&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby"># Folds the summary with a hanging indent.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">_help-func-summary() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">  local FUNC_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">  local OPTIONS=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">  local STD_FOLD=82</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="422">
          
          
          <code class="ruby">  local WIDTH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">  WIDTH=$(( $STD_FOLD - 2 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">  (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby">    # echo -n &quot;${underline}${yellow}${FUNC_NAME}${reset} &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">    echo -n &quot;${FUNC_NAME} &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">    [[ -z &quot;$OPTIONS&quot; ]] || echo -n &quot;${OPTIONS}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="429">
          
          
          <code class="ruby">    echo -n &quot;: &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    cat</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="431">
          
          
          <code class="ruby">  ) | fold -sw $WIDTH | sed -E \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">    -e &quot;1 s/^([[:alpha:]-]+) /\\1 ${green}/&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">    -e &quot;1,/:/ s/:/${reset}:/&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="434">
          
          
          <code class="ruby">    -e &quot;1 s/^([[:alpha:]-]+)/${yellow}${underline}\\1${reset}/&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">    -e &#39;2,$s/^/  /&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">    # We fold, then color because fold sees the control characters as just plain characters, so it throws the fold off.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">    # The non-printing characters are only really understood as such by the terminal and individual programs that</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">    # support it (which fold should, but, as this is written, doesn&#39;t).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby">    # 1 &amp; 2) make options green</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">    # 3) yellow underline function name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">    # 4) add hanging indent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby"># Prints and indents the help for each action</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">_help-actions-list() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">  local GROUP=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="447">
          
          
          <code class="ruby">  local ACTION</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">  for ACTION in &quot;$@&quot;; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    help-$GROUP-$ACTION -i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">_help-sub-group-list() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">  local PREFIX=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">  local GROUPS_VAR=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="458">
          
          
          <code class="ruby">  if [[ -n &quot;${!GROUPS_VAR}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">    local SG</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">    echo &quot;$( {  echo -e &quot;\n${bold}Sub-groups${reset}:&quot;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">                for SG in ${!GROUPS_VAR}; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">                  echo &quot;* $( SUMMARY_ONLY=true; help-${PREFIX}-${SG} )&quot;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">                done; } | indent)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">helpActionPrefix() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="468">
          
          
          <code class="ruby">  if [[ -z &quot;${INDENT:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">    echo -n &quot;liq $1 &quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby">colorerr() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">  # TODO: in the case of long output, it would be nice to notice whether we saw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby">  # error or not and tell the user to scroll back and check the logs. e.g., if</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">  # we see an error and then 20+ lines of stuff, then emit advice.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="477">
          
          
          <code class="ruby">  (eval &quot;$@ 2&gt; &gt;(echo -n \&quot;${red}\&quot;; cat -; tput sgr0)&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="480">
          
          
          <code class="ruby"># TODO: is this better? We switched to it for awhile, but there were problems.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby"># The reasons for both the initial switch and the switchback are now obscured</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby"># but may have been due to failure of the original code to exit with the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby"># underling error status from the eval, which has since been fixed. The</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby"># switchback was, in part, because of problems with syncronous calls. Of course,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"># it didn&#39;t wait as we would like, but it was also causing functional problems</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby"># with... somethnig.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby"># TODO: We are currently not using colorerrbg anywhere.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="488">
          
          
          <code class="ruby">colorerrbg() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">  (eval &quot;$@&quot; 2&gt;&amp;1&gt;&amp;3|sed &#39;s/^\(.*\)$/&#39;$&#39;\e&#39;&#39;[31m\1&#39;$&#39;\e&#39;&#39;[m/&#39;&gt;&amp;2)3&gt;&amp;1 &amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby"># Verifies access to github.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">check-git-access() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">  # if we don&#39;t supress the output, then we get noise even when successful</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="495">
          
          
          <code class="ruby">  ssh -qT git@github.com 2&gt; /dev/null || if [ $? -ne 1 ]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">    echoerrandexit &quot;Could not connect to github; try to add add your GitHub key like:\nssh-add /example/path/to/key&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">change-working-project() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">  if [[ -n &quot;$PROJECT&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">    if ! [[ -d &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">      echoerrandexit &quot;No such project &#39;${PROJECT}&#39; found locally.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">findFile() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">  local SEARCH_DIR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">  local FILE_NAME=&quot;${2}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="512">
          
          
          <code class="ruby">  local RES_VAR=&quot;${3}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">  local FOUND_FILE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">  local START_DIR=&quot;$SEARCH_DIR&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="516">
          
          
          <code class="ruby">  while SEARCH_DIR=&quot;$(cd &quot;$SEARCH_DIR&quot;; echo $PWD)&quot; &amp;&amp; [[ &quot;${SEARCH_DIR}&quot; != &quot;/&quot; ]]; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">    FOUND_FILE=`find -L &quot;$SEARCH_DIR&quot; -maxdepth 1 -mindepth 1 -name &quot;${FILE_NAME}&quot; -type f | grep &quot;${FILE_NAME}&quot; || true`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">    if [ -z &quot;$FOUND_FILE&quot; ]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">      SEARCH_DIR=&quot;$SEARCH_DIR/..&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="525">
          
          
          <code class="ruby">  if [ -z &quot;$FOUND_FILE&quot; ]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">    echoerr &quot;Could not find &#39;${FILE_NAME}&#39; in &#39;$START_DIR&#39; or any parent directory.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="527">
          
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    eval $RES_VAR=&quot;$FOUND_FILE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">findBase() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="534">
          
          
          <code class="ruby">  findFile &quot;${PWD}&quot; package.json PACKAGE_FILE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="535">
          
          
          <code class="ruby">  BASE_DIR=&quot;$( cd &quot;$( dirname &quot;${PACKAGE_FILE}&quot; )&quot; &amp;&amp; pwd )&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">sourceFile() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="539">
          
          
          <code class="ruby">  local SEARCH_DIR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="540">
          
          
          <code class="ruby">  local FILE_NAME=&quot;${2}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">  local PROJFILE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">  findFile &quot;$SEARCH_DIR&quot; &quot;$FILE_NAME&quot; PROJFILE &amp;&amp; {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="543">
          
          
          <code class="ruby">    source &quot;$PROJFILE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">    # TODO: this works (at time of note) because all the files we currently source are in the root, but it&#39;s a bit odd and should be reworked.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    BASE_DIR=&quot;$( cd &quot;$( dirname &quot;${PROJFILE}&quot; )&quot; &amp;&amp; pwd )&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="546">
          
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="548">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">sourceCatalystfile() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">  sourceFile &quot;${PWD}&quot; &#39;.catalyst&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="552">
          
          
          <code class="ruby">  return $? # TODO: is this how this works in bash?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">requireCatalystfile() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="556">
          
          
          <code class="ruby">  sourceCatalystfile \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">    || echoerrandexit &quot;Run &#39;liq projects init&#39; from project root.&quot; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">requireNpmPackage() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="561">
          
          
          <code class="ruby">  findFile &quot;${BASE_DIR}&quot; &#39;package.json&#39; PACKAGE_FILE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby">sourceWorkspaceConfig() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="565">
          
          
          <code class="ruby">  sourceFile &quot;${PWD}&quot; &quot;${_WORKSPACE_CONFIG}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">  return $? # TODO: is this how this works in bash?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="567">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">requirePackage() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">  requireNpmPackage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="571">
          
          
          <code class="ruby">  PACKAGE=&quot;$(cat $PACKAGE_FILE)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">  PACKAGE_NAME=&quot;$(echo &quot;$PACKAGE&quot; | jq --raw-output &quot;.name&quot;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">requireEnvironment() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">  requireCatalystfile</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="577">
          
          
          <code class="ruby">  requirePackage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">  CURR_ENV_FILE=&quot;${LIQ_ENV_DB}/${PACKAGE_NAME}/curr_env&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="579">
          
          
          <code class="ruby">  if [[ ! -L &quot;$CURR_ENV_FILE&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="580">
          
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">    echoerrandexit &quot;No environment currently selected.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="583">
          
          
          <code class="ruby">  CURR_ENV=`readlink &quot;${CURR_ENV_FILE}&quot; | xargs basename`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="584">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="585">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="586">
          
          
          <code class="ruby">addLineIfNotPresentInFile() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="587">
          
          
          <code class="ruby">  local FILE=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="588">
          
          
          <code class="ruby">  local LINE=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">  touch &quot;$FILE&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="590">
          
          
          <code class="ruby">  grep &quot;$LINE&quot; &quot;$FILE&quot; &gt; /dev/null || echo &quot;$LINE&quot; &gt;&gt; &quot;$FILE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">requireArgs() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="594">
          
          
          <code class="ruby">  local COUNT=$#</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">  local I=1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="596">
          
          
          <code class="ruby">  while (( $I &lt;= $COUNT )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="597">
          
          
          <code class="ruby">    if [[ -z ${!I:-} ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="598">
          
          
          <code class="ruby">      if [[ -z $ACTION ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">        echoerr &quot;Global action &#39;$COMPONENT&#39; requires $COUNT additional arguments.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">        echoerr &quot;&#39;$COMPONENT $ACTION&#39; requires $COUNT additional arguments.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="603">
          
          
          <code class="ruby">      # TODO: as &#39;requireArgs&#39; this should straight up exit.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="604">
          
          
          <code class="ruby">      return 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">    I=$(( I + 1 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">  return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby">contextHelp() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">  # TODO: this is a bit of a workaround until all the ACTION helps are broken</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="614">
          
          
          <code class="ruby">  # out into ther own function.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">  if type -t help-${GROUP}-${ACTION} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">    help-${GROUP}-${ACTION}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="618">
          
          
          <code class="ruby">    help-${GROUP}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="619">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby">exactUserArgs() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby">  local REQUIRED_ARGS=()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="624">
          
          
          <code class="ruby">  while true; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="625">
          
          
          <code class="ruby">    case &quot;$1&quot; in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby">      --)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="627">
          
          
          <code class="ruby">        break;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">      *)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="629">
          
          
          <code class="ruby">        REQUIRED_ARGS+=(&quot;$1&quot;);;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="630">
          
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="631">
          
          
          <code class="ruby">    shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="633">
          
          
          <code class="ruby">  shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="635">
          
          
          <code class="ruby">  if (( $# &lt; ${#REQUIRED_ARGS[@]} )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">    echoerrandexit &quot;Insufficient number of arguments.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">  elif (( $# &gt; ${#REQUIRED_ARGS[@]} )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">    echoerrandexit &quot;Found extra arguments.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">    local I=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="643">
          
          
          <code class="ruby">    while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">      eval &quot;${REQUIRED_ARGS[$I]}=&#39;$1&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">      shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">      I=$(( $I + 1 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby">requireGlobals() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="652">
          
          
          <code class="ruby">  local COUNT=$#</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="653">
          
          
          <code class="ruby">  local I=1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">  while (( $I &lt;= $COUNT )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="655">
          
          
          <code class="ruby">    local GLOBAL_NAME=${!I}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="656">
          
          
          <code class="ruby">    if [[ -z ${!GLOBAL_NAME:-} ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="657">
          
          
          <code class="ruby">      echoerr &quot;&#39;${GLOBAL_NAME}&#39; not set. Try:\nliq ${COMPONENT} configure&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">      exit 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="659">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="660">
          
          
          <code class="ruby">    I=$(( I + 1 ))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="661">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="662">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="663">
          
          
          <code class="ruby">  return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="664">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="665">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby">loadCurrEnv() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="667">
          
          
          <code class="ruby">  resetEnv() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="668">
          
          
          <code class="ruby">    CURR_ENV=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="669">
          
          
          <code class="ruby">    CURR_ENV_TYPE=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="670">
          
          
          <code class="ruby">    CURR_ENV_PURPOSE=&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="672">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="673">
          
          
          <code class="ruby">  local PACKAGE_NAME=`cat $BASE_DIR/package.json | jq --raw-output &quot;.name&quot;`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="674">
          
          
          <code class="ruby">  local CURR_ENV_FILE=&quot;${LIQ_ENV_DB}/${PACKAGE_NAME}/curr_env&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="675">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">  if [[ -f &quot;${CURR_ENV_FILE}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    source &quot;$CURR_ENV_FILE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="678">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="679">
          
          
          <code class="ruby">    resetEnv</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="680">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby">getPackageDef() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="684">
          
          
          <code class="ruby">  local VAR_NAME=&quot;$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="685">
          
          
          <code class="ruby">  local FQN_PACKAGE_NAME=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">  # The project we&#39;re looking at might be our own or might be a dependency.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="688">
          
          
          <code class="ruby">  if [[ -z &quot;$FQN_PACKAGE_NAME&quot; ]] || [[ &quot;$FQN_PACKAGE_NAME&quot; == &quot;$PACKAGE_NAME&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="689">
          
          
          <code class="ruby">    eval &quot;$VAR_NAME=\&quot;\$PACKAGE\&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="691">
          
          
          <code class="ruby">    eval &quot;$VAR_NAME=\$(npm explore \&quot;$FQN_PACKAGE_NAME\&quot; -- cat package.json)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="692">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="693">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="695">
          
          
          <code class="ruby">getProvidedServiceValues() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">  local SERV_KEY=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">  local FIELD_LABEL=&quot;$2&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">  local SERV_PACKAGE SERV_NAME SERV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="700">
          
          
          <code class="ruby">  if [[ -n &quot;$SERV_KEY&quot; ]];then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby">    # local SERV_IFACE=`echo &quot;$SERV_KEY&quot; | cut -d: -f1`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="702">
          
          
          <code class="ruby">    local SERV_PACKAGE_NAME=`echo &quot;$SERV_KEY&quot; | cut -d: -f2`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="703">
          
          
          <code class="ruby">    SERV_NAME=`echo &quot;$SERV_KEY&quot; | cut -d: -f3`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">    getPackageDef SERV_PACKAGE &quot;$SERV_PACKAGE_NAME&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">    SERV_PACKAGE=&quot;$PACKAGE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">  echo &quot;$SERV_PACKAGE&quot; | jq --raw-output &quot;.catalyst.provides | .[] | select(.name == \&quot;$SERV_NAME\&quot;) | .\&quot;${FIELD_LABEL}\&quot; | @sh&quot; | tr -d &quot;&#39;&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">    || ( ( [[ -n $SERV_PACKAGE_NAME ]] &amp;&amp; echoerrandexit &quot;$SERV_PACKAGE_NAME package.json does not define .catalyst.provides[${SERV_NAME}].&quot; ) || \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="711">
          
          
          <code class="ruby">         echoerrandexit &quot;Local package.json does not define .catalyst.provides[${SERV_NAME}].&quot; )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="714">
          
          
          <code class="ruby">getRequiredParameters() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">  getProvidedServiceValues &quot;${1:-}&quot; &quot;params-req&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby"># TODO: this is not like the others; it should take an optional package name, and the others should work with package names, not service specs. I.e., decompose externally.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby"># TODO: Or maybe not. Have a set of &quot;objective&quot; service key manipulators to build from and extract parts?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">getConfigConstants() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="721">
          
          
          <code class="ruby">  local SERV_IFACE=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; | jq --raw-output &quot;.catalyst.requires | .[] | select(.iface==\&quot;$SERV_IFACE\&quot;) | .\&quot;config-const\&quot; | keys | @sh&quot; | tr -d &quot;&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="724">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="725">
          
          
          <code class="ruby">getCtrlScripts() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">  getProvidedServiceValues &quot;${1:-}&quot; &quot;ctrl-scripts&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="727">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="728">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">pressAnyKeyToContinue() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">  read -n 1 -s -r -p &quot;Press any key to continue...&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">  echo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="732">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="734">
          
          
          <code class="ruby">getCatPackagePaths() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="735">
          
          
          <code class="ruby">  local NPM_ROOT=`npm root`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">  local CAT_PACKAGE_PATHS=`find -L &quot;$NPM_ROOT&quot;/\@* -maxdepth 2 -name &quot;.catalyst&quot; -not -path &quot;*.prelink/*&quot; -exec dirname {} \;`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="737">
          
          
          <code class="ruby">  CAT_PACKAGE_PATHS=&quot;${CAT_PACKAGE_PATHS} &quot;`find -L &quot;$NPM_ROOT&quot; -maxdepth 2 -name &quot;.catalyst&quot; -not -path &quot;*.prelink/*&quot; -exec dirname {} \;`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="738">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">  echo &quot;$CAT_PACKAGE_PATHS&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby"># Takes a project name and checks that the local repo is clean. By specifyng &#39;--check-branch&#39; (which will take a comma</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="743">
          
          
          <code class="ruby"># separated list of branch names) or &#39;--check-all-branches&#39;, the function will also check that the current head of each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="744">
          
          
          <code class="ruby"># branch is present in the remote repo. The branch checks do not include a &#39;fetch&#39;, so local information may be out of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="745">
          
          
          <code class="ruby"># date.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">requireCleanRepo() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">  eval &quot;$(setSimpleOptions CHECK_BRANCH= CHECK_ALL_BRANCHES -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="749">
          
          
          <code class="ruby">  local _IP=&quot;$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="750">
          
          
          <code class="ruby">  _IP=&quot;${_IP/@/}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="751">
          
          
          <code class="ruby">  # TODO: the &#39;_WORK_BRANCH&#39; here seem to be more of a check than a command to check that branch.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">  _IP=${_IP/@/}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="754">
          
          
          <code class="ruby">  local BRANCHES_TO_CHECK</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">  if [[ -n &quot;$CHECK_ALL_BRANCHES&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="756">
          
          
          <code class="ruby">    BRANCHES_TO_CHECK=&quot;$(git branch --list --format=&#39;%(refname:lstrip=-1)&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="757">
          
          
          <code class="ruby">  elif [[ -n &quot;$CHECK_BRANCH&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="758">
          
          
          <code class="ruby">    list-from-csv BRANCHES_TO_CHECK &quot;$CHECK_BRANCH&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="759">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="761">
          
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${_IP}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="763">
          
          
          <code class="ruby">  echo &quot;Checking ${_IP}...&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="764">
          
          
          <code class="ruby">  # credit: https://stackoverflow.com/a/8830922/929494</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby">  # look for uncommitted changes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">  if ! git diff --quiet || ! git diff --cached --quiet; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="767">
          
          
          <code class="ruby">    echoerrandexit &quot;Found uncommitted changes.\n$(git status --porcelain)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby">  # check for untracked files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="770">
          
          
          <code class="ruby">  if (( $({ git status --porcelain 2&gt;/dev/null| grep &#39;^??&#39; || true; } | wc -l) != 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="771">
          
          
          <code class="ruby">    echoerrandexit &quot;Found untracked files.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">  # At this point, the local repo is clean. Now we look at any branches of interest to make sure they&#39;ve been pushed.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">  if [[ -n &quot;$BRANCHES_TO_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">    local BRANCH_TO_CHECK</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">    for BRANCH_TO_CHECK in $BRANCHES_TO_CHECK; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="777">
          
          
          <code class="ruby">      if [[ &quot;$BRANCH_TO_CHECK&quot; == master ]] \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="778">
          
          
          <code class="ruby">         &amp;&amp; ! git merge-base --is-ancestor master upstream/master; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="779">
          
          
          <code class="ruby">        echoerrandexit &quot;Local master has not been pushed to upstream master.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">      # if the repo was created without forking, then there&#39;s no separate workspace</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="782">
          
          
          <code class="ruby">      if git remote | grep -e &#39;^workspace$&#39; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">          &amp;&amp; ! git merge-base --is-ancestor &quot;$BRANCH_TO_CHECK&quot; &quot;workspace/${BRANCH_TO_CHECK}&quot;; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="784">
          
          
          <code class="ruby">        echoerrandexit &quot;Local branch &#39;$BRANCH_TO_CHECK&#39; has not been pushed to workspace.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="789">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="790">
          
          
          <code class="ruby"># For each &#39;involved project&#39; in the indicated unit of work (default to current unit of work), checks that the repo is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby"># clean.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="792">
          
          
          <code class="ruby">requireCleanRepos() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="793">
          
          
          <code class="ruby">  local _WORK_NAME=&quot;${1:-curr_work}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="794">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">  ( # isolate the source</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="796">
          
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/${_WORK_NAME}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="797">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="798">
          
          
          <code class="ruby">    local IP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="799">
          
          
          <code class="ruby">    for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">      requireCleanRepo &quot;$IP&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">  )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="803">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby">defineParameters() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="806">
          
          
          <code class="ruby">  local SERVICE_DEF_VAR=&quot;$1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="807">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">  echo &quot;Enter required parameters. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="809">
          
          
          <code class="ruby">  local PARAM_NAME</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="811">
          
          
          <code class="ruby">    read -p &quot;Required parameter: &quot; PARAM_NAME</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="812">
          
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="813">
          
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="814">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="815">
          
          
          <code class="ruby">      eval $SERVICE_DEF_VAR&#39;=$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;params-req\&quot;: (.\&quot;params-req\&quot; + [\&quot;&#39;$PARAM_NAME&#39;\&quot;]) }&quot;)&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="816">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="819">
          
          
          <code class="ruby">  PARAM_NAME=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="820">
          
          
          <code class="ruby">  echo &quot;Enter optional parameters. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="821">
          
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">    read -p &quot;Optional parameter: &quot; PARAM_NAME</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="823">
          
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="824">
          
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="826">
          
          
          <code class="ruby">      eval $SERVICE_DEF_VAR=&#39;$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;params-opt\&quot;: (.\&quot;params-opt\&quot; + [\&quot;&#39;$PARAM_NAME&#39;\&quot;]) }&quot;)&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="830">
          
          
          <code class="ruby">  PARAM_NAME=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="831">
          
          
          <code class="ruby">  echo &quot;Enter configuration constants. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="832">
          
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="833">
          
          
          <code class="ruby">    read -p &quot;Configuration constant: &quot; PARAM_NAME</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="834">
          
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="835">
          
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="837">
          
          
          <code class="ruby">      local PARAM_VAL=&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="838">
          
          
          <code class="ruby">      require-answer &quot;Value: &quot; PARAM_VAL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="839">
          
          
          <code class="ruby">      eval $SERVICE_DEF_VAR=&#39;$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;config-const\&quot;: (.\&quot;config-const\&quot; + { \&quot;&#39;$PARAM_NAME&#39;\&quot; : \&quot;&#39;$PARAM_VAL&#39;\&quot; }) }&quot;)&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="840">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="842">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="843">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="844">
          
          
          <code class="ruby">BREW_UPDATED=&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="845">
          
          
          <code class="ruby">brewInstall() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="846">
          
          
          <code class="ruby">  local EXEC=&quot;$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="847">
          
          
          <code class="ruby">  local INSTALL_TEST=&quot;$2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="848">
          
          
          <code class="ruby">  local POST_INSTALL=&quot;${3:-}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="849">
          
          
          <code class="ruby">  if ! $INSTALL_TEST; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="850">
          
          
          <code class="ruby">    if ! which -s brew; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="851">
          
          
          <code class="ruby">      echoerr &quot;Required executable &#39;${EXEC}&#39; not found.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="852">
          
          
          <code class="ruby">      echoerr &quot;Install Homebrew and re-run installation, or install &#39;${EXEC}&#39; manually.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="853">
          
          
          <code class="ruby">      echoerrandexit https://brew.sh/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby">    # else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby">    doInstall() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="857">
          
          
          <code class="ruby">      test -n &quot;${BREW_UPDATED}&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="858">
          
          
          <code class="ruby">        || brew update \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="859">
          
          
          <code class="ruby">        || echoerrandexit &quot;&#39;brew update&#39; exited with errors. Please update Homebrew and re-run Catalyst CLI installation.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="860">
          
          
          <code class="ruby">      BREW_UPDATED=true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="861">
          
          
          <code class="ruby">      brew install $EXEC \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="862">
          
          
          <code class="ruby">        || (echo &quot;First install attempt failed. Re-running often fixes brew install issue; trying again...&quot;; brew install $EXEC) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="863">
          
          
          <code class="ruby">        || echoerrandexit &quot;&#39;brew install ${EXEC}&#39; exited with errors. Otherwise, please install &#39;${EXEC}&#39; and re-run Catalyst CLI installation.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="864">
          
          
          <code class="ruby">      if test -n &quot;$POST_INSTALL&quot;; then eval &quot;$POST_INSTALL&quot;; fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="865">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="866">
          
          
          <code class="ruby">    giveFeedback() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="867">
          
          
          <code class="ruby">      echo &quot;Catalyst CLI requires &#39;${EXEC}&#39;. Please install with Homebrew (recommended) or manually.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="868">
          
          
          <code class="ruby">      exit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="869">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="870">
          
          
          <code class="ruby">    yes-no \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="871">
          
          
          <code class="ruby">      &quot;Catalyst CLI requires command &#39;${EXEC}&#39;. OK to attempt install via Homebrew? (Y/n) &quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="872">
          
          
          <code class="ruby">      Y \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="873">
          
          
          <code class="ruby">      doInstall \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="874">
          
          
          <code class="ruby">      giveFeedback</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="876">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="877">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="878">
          
          
          <code class="ruby">APT_UPDATED=false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="879">
          
          
          <code class="ruby">function apt-install() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="880">
          
          
          <code class="ruby">  local EXEC=&quot;$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="881">
          
          
          <code class="ruby">  local INSTALL_TEST=&quot;$2&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="882">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="883">
          
          
          <code class="ruby">  if ! ${INSTALL_TEST}; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="884">
          
          
          <code class="ruby">    echo &quot;Installing &#39;${EXEC}&#39;...&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="885">
          
          
          <code class="ruby">    if [[ &quot;${APT_UPDATED}&quot;  == &#39;false&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="886">
          
          
          <code class="ruby">      sudo apt-get -q update || echoerrandexit &quot;Could not install &#39;${EXEC}&#39; while performing &#39;apt-get update&#39;.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="887">
          
          
          <code class="ruby">      APT_UPDATED=false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="889">
          
          
          <code class="ruby">    sudo apt-get -qqy &quot;${EXEC}&quot; || echoerrandexit &quot;Could not install  &#39;${EXEC}&#39; while performing &#39;apt-get install&#39;.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="890">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="891">
          
          
          <code class="ruby">    echo &quot;Found &#39;${EXEC}&#39;...&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="892">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="893">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="894">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="895">
          
          
          <code class="ruby">if [[ $(uname) == &#39;Darwin&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="896">
          
          
          <code class="ruby">  brewInstall jq &#39;which -s jq&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="897">
          
          
          <code class="ruby">  # Without the &#39;eval&#39;, the tick quotes are treated as part of the filename.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="898">
          
          
          <code class="ruby">  # Without the tickquotes we&#39;re vulnerable to spaces in the path.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="899">
          
          
          <code class="ruby">  brewInstall gnu-getopt \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">    &quot;eval test -f &#39;$(brew --prefix gnu-getopt)/bin/getopt&#39;&quot; \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">    &quot;addLineIfNotPresentInFile ~/.bash_profile &#39;alias gnu-getopt=\&quot;\$(brew --prefix gnu-getopt)/bin/getopt\&quot;&#39;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="902">
          
          
          <code class="ruby">else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="903">
          
          
          <code class="ruby">  apt-install jq &#39;which jq&#39; # &#39;-s&#39; is not supported on linux and a /dev/null redirect doesn&#39;t interpret correctly (?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="904">
          
          
          <code class="ruby">  apt-install nodejs &#39;which nodejs&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="905">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="906">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="907">
          
          
          <code class="ruby">for i in /etc/bash_completion.d /usr/local/etc/bash_completion.d; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="908">
          
          
          <code class="ruby">  if [[ -e &quot;${i}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="909">
          
          
          <code class="ruby">    COMPLETION_PATH=&quot;${i}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="910">
          
          
          <code class="ruby">    break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="911">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby">done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="913">
          
          
          <code class="ruby">cp ./dist/completion.sh &quot;${COMPLETION_PATH}/liq&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="914">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">COMPLETION_SETUP=false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="916">
          
          
          <code class="ruby">for i in /etc/bash.bashrc &quot;${HOME}/.bash_profile&quot; &quot;${HOME}/.profile&quot;; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="917">
          
          
          <code class="ruby">  if [[ -e &quot;${i}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="918">
          
          
          <code class="ruby">    addLineIfNotPresentInFile &quot;${i}&quot; &quot;[ -d &#39;$COMPLETION_PATH&#39; ] &amp;&amp; . &#39;${COMPLETION_PATH}/liq&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">    COMPLETION_SETUP=true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="920">
          
          
          <code class="ruby">    break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="922">
          
          
          <code class="ruby">done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="923">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="924">
          
          
          <code class="ruby">if [[ &quot;${COMPLETION_SETUP}&quot; == &#39;false&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="925">
          
          
          <code class="ruby">  echoerr &quot;Completion support not set up; could not find likely bash profile/rc.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="926">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="927">
          
          
          <code class="ruby"># TODO: accept &#39;-e&#39; option which exchos the source command so user can do &#39;eval ./install.sh -e&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="928">
          
          
          <code class="ruby"># TODO: only echo if lines added (here or in POST_INSTALL)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="929">
          
          
          <code class="ruby">[[ -z &quot;${PS1}&quot; ]] || echo &quot;You must open a new shell or &#39;source ~/.bash_profile&#39; to enable completion updates.&quot;</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="974ec74da59508a7de47d18417955274b6ff54d1">
  <div class="header">
    <h3>liq-shell.sh</h3>
    <h4><span class="red">0.0 %</span> covered</h4>
    <div>
      <b>140</b> relevant lines. 
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>140</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby">#!/usr/bin/env bash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">SETUP=$(cat &lt;&lt;&#39;EOF&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">[[ -e /etc/bash.bashrc ]] &amp;&amp; source /etc/bash.bashrc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">[[ -e &quot;${HOME}/.bashrc&quot; ]] &amp;&amp; source &quot;${HOME}/.bashrc&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">[[ -e &quot;${HOME}/.profile&quot; ]] &amp;&amp; source &quot;${HOME}/.profile&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">PS4=&#39;$(echo $(date +&quot;%Y/%m/%d (%H:%M)&quot;) $(history 1) &gt;&gt; /tmp/trace.txt)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">PS1=&#39;liq&gt; &#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">set show-all-if-ambiguous on</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"># the _liq function should have been sourced as part of the users</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">complete -D -F _liq</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">complete -I -F _liq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"># bind &quot;TAB:menu-complete&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">bind &quot;set show-all-if-ambiguous on&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">preexec() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  # handle or one special shell command</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">  if [[ &quot;$1&quot; == &#39;quit&#39; ]] || [[ &quot;$1&quot; == &#39;q&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    exit 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">  if [[ &quot;${1}&quot; == &#39;\&#39;* ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    eval ${1:1}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    # echo -e &quot;executing:\nliq ${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    liq $1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">  return 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"># enables command substitution when preexec returns 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">shopt -s extdebug</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"># https://github.com/rcaloras/bash-preexec 10b41c5ed8dc28fe5bb6970cb8e12e618aa5a998</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"># bash-preexec.sh -- Bash support for ZSH-like &#39;preexec&#39; and &#39;precmd&#39; functions.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"># https://github.com/rcaloras/bash-preexec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"># &#39;preexec&#39; functions are executed before each interactive command is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"># executed, with the interactive command as its argument. The &#39;precmd&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"># function is executed before each prompt is displayed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"># Author: Ryan Caloras (ryan@bashhub.com)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"># Forked from Original Author: Glyph Lefkowitz</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"># V0.4.1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"># General Usage:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">#  1. Source this file at the end of your bash profile so as not to interfere</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">#     with anything else that&#39;s using PROMPT_COMMAND.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">#  2. Add any precmd or preexec functions by appending them to their arrays:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">#       e.g.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">#       precmd_functions+=(my_precmd_function)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">#       precmd_functions+=(some_other_precmd_function)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">#       preexec_functions+=(my_preexec_function)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">#  3. Consider changing anything using the DEBUG trap or PROMPT_COMMAND</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">#     to use preexec and precmd instead. Preexisting usages will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">#     preserved, but doing so manually may be less surprising.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">#  Note: This module requires two Bash features which you must not otherwise be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">#  using: the &quot;DEBUG&quot; trap, and the &quot;PROMPT_COMMAND&quot; variable. If you override</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">#  either of these after bash-preexec has been installed it will most likely break.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"># Make sure this is bash that&#39;s running and return otherwise.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">if [[ -z &quot;${BASH_VERSION:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    return 1;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"># Avoid duplicate inclusion</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">if [[ &quot;${__bp_imported:-}&quot; == &quot;defined&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">__bp_imported=&quot;defined&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"># Should be available to each precmd and preexec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"># functions, should they want it. $? and $_ are available as $? and $_, but</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"># $PIPESTATUS is available only in a copy, $BP_PIPESTATUS.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"># TODO: Figure out how to restore PIPESTATUS before each precmd or preexec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"># function.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">__bp_last_ret_value=&quot;$?&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">BP_PIPESTATUS=(&quot;${PIPESTATUS[@]}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">__bp_last_argument_prev_command=&quot;$_&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">__bp_inside_precmd=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">__bp_inside_preexec=0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"># Initial PROMPT_COMMAND string that is removed from PROMPT_COMMAND post __bp_install</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">__bp_install_string=$&#39;__bp_trap_string=&quot;$(trap -p DEBUG)&quot;\ntrap - DEBUG\n__bp_install&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"># Fails if any of the given variables are readonly</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"># Reference https://stackoverflow.com/a/4441178</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">__bp_require_not_readonly() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">  local var</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">  for var; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    if ! ( unset &quot;$var&quot; 2&gt; /dev/null ); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      echo &quot;bash-preexec requires write access to ${var}&quot; &gt;&amp;2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      return 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"># Remove ignorespace and or replace ignoreboth from HISTCONTROL</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"># so we can accurately invoke preexec with a command from our</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"># history even if it starts with a space.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">__bp_adjust_histcontrol() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    local histcontrol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    histcontrol=&quot;${HISTCONTROL//ignorespace}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    # Replace ignoreboth with ignoredups</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">    if [[ &quot;$histcontrol&quot; == *&quot;ignoreboth&quot;* ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">        histcontrol=&quot;ignoredups:${histcontrol//ignoreboth}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    fi;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">    export HISTCONTROL=&quot;$histcontrol&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"># This variable describes whether we are currently in &quot;interactive mode&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"># i.e. whether this shell has just executed a prompt and is waiting for user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"># input.  It documents whether the current command invoked by the trace hook is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"># run interactively by the user; it&#39;s set immediately after the prompt hook,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"># and unset as soon as the trace hook is run.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">__bp_preexec_interactive_mode=&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"># Trims leading and trailing whitespace from $2 and writes it to the variable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"># name passed as $1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">__bp_trim_whitespace() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">    local var=${1:?} text=${2:-}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    text=&quot;${text#&quot;${text%%[![:space:]]*}&quot;}&quot;   # remove leading whitespace characters</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">    text=&quot;${text%&quot;${text##*[![:space:]]}&quot;}&quot;   # remove trailing whitespace characters</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    printf -v &quot;$var&quot; &#39;%s&#39; &quot;$text&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"># Trims whitespace and removes any leading or trailing semicolons from $2 and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"># writes the resulting string to the variable name passed as $1. Used for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"># manipulating substrings in PROMPT_COMMAND</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">__bp_sanitize_string() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">    local var=${1:?} text=${2:-} sanitized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    __bp_trim_whitespace sanitized &quot;$text&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">    sanitized=${sanitized%;}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    sanitized=${sanitized#;}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">    __bp_trim_whitespace sanitized &quot;$sanitized&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    printf -v &quot;$var&quot; &#39;%s&#39; &quot;$sanitized&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"># This function is installed as part of the PROMPT_COMMAND;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"># It sets a variable to indicate that the prompt was just displayed,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"># to allow the DEBUG trap to know that the next command is likely interactive.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">__bp_interactive_mode() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    __bp_preexec_interactive_mode=&quot;on&quot;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"># This function is installed as part of the PROMPT_COMMAND.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"># It will invoke any functions defined in the precmd_functions array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">__bp_precmd_invoke_cmd() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">    # Save the returned value from our last command, and from each process in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    # its pipeline. Note: this MUST be the first thing done in this function.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    __bp_last_ret_value=&quot;$?&quot; BP_PIPESTATUS=(&quot;${PIPESTATUS[@]}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    # Don&#39;t invoke precmds if we are inside an execution of an &quot;original</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    # prompt command&quot; by another precmd execution loop. This avoids infinite</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">    # recursion.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">    if (( __bp_inside_precmd &gt; 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    local __bp_inside_precmd=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">    # Invoke every function defined in our function array.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">    local precmd_function</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    for precmd_function in &quot;${precmd_functions[@]}&quot;; do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">        # Only execute this function if it actually exists.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">        # Test existence of functions with: declare -[Ff]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">        if type -t &quot;$precmd_function&quot; 1&gt;/dev/null; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">            __bp_set_ret_value &quot;$__bp_last_ret_value&quot; &quot;$__bp_last_argument_prev_command&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">            # Quote our function invocation to prevent issues with IFS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">            &quot;$precmd_function&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"># Sets a return value in $?. We may want to get access to the $? variable in our</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"># precmd functions. This is available for instance in zsh. We can simulate it in bash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"># by setting the value here.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">__bp_set_ret_value() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">    return ${1:-}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">__bp_in_prompt_command() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="196">
          
          
          <code class="ruby">    local prompt_command_array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    IFS=$&#39;\n;&#39; read -rd &#39;&#39; -a prompt_command_array &lt;&lt;&lt; &quot;$PROMPT_COMMAND&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">    local trimmed_arg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    __bp_trim_whitespace trimmed_arg &quot;${1:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">    local command trimmed_command</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">    for command in &quot;${prompt_command_array[@]:-}&quot;; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">        __bp_trim_whitespace trimmed_command &quot;$command&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">        if [[ &quot;$trimmed_command&quot; == &quot;$trimmed_arg&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">            return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"># This function is installed as the DEBUG trap.  It is invoked before each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"># interactive prompt display.  Its purpose is to inspect the current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"># environment to attempt to detect if the current command is being invoked</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"># interactively, and invoke &#39;preexec&#39; if so.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">__bp_preexec_invoke_exec() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">    # Save the contents of $_ so that it can be restored later on.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    # https://stackoverflow.com/questions/40944532/bash-preserve-in-a-debug-trap#40944702</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">    __bp_last_argument_prev_command=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    # Don&#39;t invoke preexecs if we are inside of another preexec.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">    if (( __bp_inside_preexec &gt; 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">    local __bp_inside_preexec=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">    # Checks if the file descriptor is not standard out (i.e. &#39;1&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    # __bp_delay_install checks if we&#39;re in test. Needed for bats to run.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">    # Prevents preexec from being invoked for functions in PS1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    if [[ ! -t 1 &amp;&amp; -z &quot;${__bp_delay_install:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    if [[ -n &quot;${COMP_LINE:-}&quot; ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">        # We&#39;re in the middle of a completer. This obviously can&#39;t be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">        # an interactively issued command.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">    if [[ -z &quot;${__bp_preexec_interactive_mode:-}&quot; ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">        # We&#39;re doing something related to displaying the prompt.  Let the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">        # prompt set the title instead of me.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">        # If we&#39;re in a subshell, then the prompt won&#39;t be re-displayed to put</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">        # us back into interactive mode, so let&#39;s not set the variable back.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">        # In other words, if you have a subshell like</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">        #   (sleep 1; sleep 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">        # You want to see the &#39;sleep 2&#39; as a set_command_title as well.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">        if [[ 0 -eq &quot;${BASH_SUBSHELL:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">            __bp_preexec_interactive_mode=&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">    if  __bp_in_prompt_command &quot;${BASH_COMMAND:-}&quot;; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">        # If we&#39;re executing something inside our prompt_command then we don&#39;t</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">        # want to call preexec. Bash prior to 3.1 can&#39;t detect this at all :/</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">        __bp_preexec_interactive_mode=&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="262">
          
          
          <code class="ruby">    local this_command</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">    this_command=$(</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">        export LC_ALL=C</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">        HISTTIMEFORMAT= builtin history 1 | sed &#39;1 s/^ *[0-9][0-9]*[* ] //&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">    # Sanity check to make sure we have something to invoke our function with.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">    if [[ -z &quot;$this_command&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    # Invoke every function defined in our function array.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">    local preexec_function</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">    local preexec_function_ret_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">    local preexec_ret_value=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">    for preexec_function in &quot;${preexec_functions[@]:-}&quot;; do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">        # Only execute each function if it actually exists.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">        # Test existence of function with: declare -[fF]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="281">
          
          
          <code class="ruby">        if type -t &quot;$preexec_function&quot; 1&gt;/dev/null; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">            __bp_set_ret_value ${__bp_last_ret_value:-}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">            # Quote our function invocation to prevent issues with IFS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">            &quot;$preexec_function&quot; &quot;$this_command&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">            preexec_function_ret_value=&quot;$?&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">            if [[ &quot;$preexec_function_ret_value&quot; != 0 ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">                preexec_ret_value=&quot;$preexec_function_ret_value&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">            fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">    # Restore the last argument of the last executed command, and set the return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">    # value of the DEBUG trap to be the return code of the last preexec function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">    # to return an error.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    # If `extdebug` is enabled a non-zero return value from any preexec function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">    # will cause the user&#39;s command not to execute.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">    # Run `shopt -s extdebug` to enable</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">    __bp_set_ret_value &quot;$preexec_ret_value&quot; &quot;$__bp_last_argument_prev_command&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">__bp_install() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">    # Exit if we already have this installed.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">    if [[ &quot;${PROMPT_COMMAND:-}&quot; == *&quot;__bp_precmd_invoke_cmd&quot;* ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">        return 1;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    trap &#39;__bp_preexec_invoke_exec &quot;$_&quot;&#39; DEBUG</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">    # Preserve any prior DEBUG trap as a preexec function</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">    local prior_trap=$(sed &quot;s/[^&#39;]*&#39;\(.*\)&#39;[^&#39;]*/\1/&quot; &lt;&lt;&lt;&quot;${__bp_trap_string:-}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">    unset __bp_trap_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">    if [[ -n &quot;$prior_trap&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">        eval &#39;__bp_original_debug_trap() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">          &#39;&quot;$prior_trap&quot;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">        }&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">        preexec_functions+=(__bp_original_debug_trap)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">    # Adjust our HISTCONTROL Variable if needed.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">    __bp_adjust_histcontrol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">    # Issue #25. Setting debug trap for subshells causes sessions to exit for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">    # backgrounded subshell commands (e.g. (pwd)&amp; ). Believe this is a bug in Bash.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">    # Disabling this by default. It can be enabled by setting this variable.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">    if [[ -n &quot;${__bp_enable_subshells:-}&quot; ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">        # Set so debug trap will work be invoked in subshells.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">        set -o functrace &gt; /dev/null 2&gt;&amp;1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">        shopt -s extdebug &gt; /dev/null 2&gt;&amp;1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">    fi;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    local existing_prompt_command</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">    # Remove setting our trap install string and sanitize the existing prompt command string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">    existing_prompt_command=&quot;${PROMPT_COMMAND//$__bp_install_string[;$&#39;\n&#39;]}&quot; # Edge case of appending to PROMPT_COMMAND</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">    existing_prompt_command=&quot;${existing_prompt_command//$__bp_install_string}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    __bp_sanitize_string existing_prompt_command &quot;$existing_prompt_command&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">    # Install our hooks in PROMPT_COMMAND to allow our trap to know when we&#39;ve</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">    # actually entered something.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    PROMPT_COMMAND=$&#39;__bp_precmd_invoke_cmd\n&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    if [[ -n &quot;$existing_prompt_command&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">        PROMPT_COMMAND+=${existing_prompt_command}$&#39;\n&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    fi;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">    PROMPT_COMMAND+=&#39;__bp_interactive_mode&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">    # Add two functions to our arrays for convenience</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">    # of definition.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">    precmd_functions+=(precmd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">    preexec_functions+=(preexec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">    # Invoke our two functions manually that were added to $PROMPT_COMMAND</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    __bp_precmd_invoke_cmd</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">    __bp_interactive_mode</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby"># Sets an installation string as part of our PROMPT_COMMAND to install</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby"># after our session has started. This allows bash-preexec to be included</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby"># at any point in our bash profile.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">__bp_install_after_session_init() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">    # bash-preexec needs to modify these variables in order to work correctly</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">    # if it can&#39;t, just stop the installation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="363">
          
          
          <code class="ruby">    __bp_require_not_readonly PROMPT_COMMAND HISTCONTROL HISTTIMEFORMAT || return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">    local sanitized_prompt_command</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">    __bp_sanitize_string sanitized_prompt_command &quot;$PROMPT_COMMAND&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">    if [[ -n &quot;$sanitized_prompt_command&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">        PROMPT_COMMAND=${sanitized_prompt_command}$&#39;\n&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">    fi;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">    PROMPT_COMMAND+=${__bp_install_string}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"># Run our install so long as we&#39;re not delaying it.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="374">
          
          
          <code class="ruby">if [[ -z &quot;${__bp_delay_install:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">    __bp_install_after_session_init</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">fi;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">__bp_install</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">bash --init-file &lt;(echo &quot;${SETUP}&quot;) -i</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a13aa571c8f50d36a64038c0d139b624fa456626">
  <div class="header">
    <h3>liq.sh</h3>
    <h4><span class="green">96.46 %</span> covered</h4>
    <div>
      <b>4542</b> relevant lines. 
      <span class="green"><b>4381</b> lines covered</span> and
      <span class="red"><b>161</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby">#!/usr/bin/env bash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># bash strict settings</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4">
          <span class="hits">8</span>
          
          <code class="ruby">set -o errexit # exit on errors</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="5">
          <span class="hits">8</span>
          
          <code class="ruby">set -o nounset # exit on use of uninitialized variable</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="6">
          <span class="hits">8</span>
          
          <code class="ruby">set -o pipefail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># http://linuxcommand.org/lc3_adv_tput.php</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="9">
          <span class="hits">16</span>
          
          <code class="ruby">red=`tput setaf 1`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="10">
          <span class="hits">16</span>
          
          <code class="ruby">green=`tput setaf 2`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="11">
          <span class="hits">16</span>
          
          <code class="ruby">yellow=`tput setaf 3`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="12">
          <span class="hits">16</span>
          
          <code class="ruby">blue=`tput setaf 4`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="13">
          <span class="hits">16</span>
          
          <code class="ruby">purple=`tput setaf 5`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="14">
          <span class="hits">16</span>
          
          <code class="ruby">cyan=`tput setaf 6`</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="15">
          <span class="hits">16</span>
          
          <code class="ruby">white=`tput setaf 7`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="17">
          <span class="hits">16</span>
          
          <code class="ruby">bold=`tput bold`</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="18">
          <span class="hits">8</span>
          
          <code class="ruby">red_b=&quot;${red}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="19">
          <span class="hits">8</span>
          
          <code class="ruby">green_b=&quot;${green}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="20">
          <span class="hits">8</span>
          
          <code class="ruby">yellow_b=&quot;${yellow}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">blue_b=&quot;${blue}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="22">
          <span class="hits">8</span>
          
          <code class="ruby">purple_b=&quot;${purple}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="23">
          <span class="hits">8</span>
          
          <code class="ruby">cyan_b=&quot;${cyan}${bold}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="24">
          <span class="hits">8</span>
          
          <code class="ruby">white_b=&quot;${white}${bold}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="26">
          <span class="hits">16</span>
          
          <code class="ruby">underline=`tput smul`</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="27">
          <span class="hits">8</span>
          
          <code class="ruby">red_u=&quot;${red}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="28">
          <span class="hits">8</span>
          
          <code class="ruby">green_u=&quot;${green}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="29">
          <span class="hits">8</span>
          
          <code class="ruby">yellow_u=&quot;${yellow}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="30">
          <span class="hits">8</span>
          
          <code class="ruby">blue_u=&quot;${blue}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="31">
          <span class="hits">8</span>
          
          <code class="ruby">purple_u=&quot;${purple}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="32">
          <span class="hits">8</span>
          
          <code class="ruby">cyan_u=&quot;${cyan}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="33">
          <span class="hits">8</span>
          
          <code class="ruby">white_u=&quot;${white}${underline}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="35">
          <span class="hits">8</span>
          
          <code class="ruby">red_bu=&quot;${red}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="36">
          <span class="hits">8</span>
          
          <code class="ruby">green_bu=&quot;${green}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="37">
          <span class="hits">8</span>
          
          <code class="ruby">yellow_bu=&quot;${yellow}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="38">
          <span class="hits">8</span>
          
          <code class="ruby">blue_bu=&quot;${blue}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="39">
          <span class="hits">8</span>
          
          <code class="ruby">purple_bu=&quot;${purple}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="40">
          <span class="hits">8</span>
          
          <code class="ruby">cyan_bu=&quot;${cyan}${bold}${underline}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="41">
          <span class="hits">8</span>
          
          <code class="ruby">white_bu=&quot;${white}${bold}${underline}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="43">
          <span class="hits">16</span>
          
          <code class="ruby">reset=`tput sgr0`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">list-add-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    # TODO: enforce no newlines in item</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    if [[ -n &quot;$ITEM&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      if [[ -z &quot;${!LIST_VAR:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">        eval $LIST_VAR=&#39;&quot;$ITEM&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">        # echo $LIST_VAR=&#39;&quot;${!LIST_VAR}&quot;$&#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;&quot;${ITEM}&quot;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">        eval $LIST_VAR=&#39;&quot;${!LIST_VAR}&quot;$&#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;&quot;${ITEM}&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">list-add-uniq() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    # TODO: enforce no newlines in item</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    if [[ -z $(list-get-index $LIST_VAR &quot;$ITEM&quot;) ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      list-add-item $LIST_VAR &quot;$ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"># Echos the number of items in the list.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"># Takes single argument, the list var name.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"># list-add-item A B C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"># list-count MY_LIST # echos &#39;3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">list-count() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">  if [[ -z &quot;${!1:-}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    echo -n &quot;0&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    echo -e &quot;${!1}&quot; | wc -l | tr -d &#39;[:space:]&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">list-from-csv() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">  local CSV=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">  if [[ -z &quot;$CSV&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    CSV=&quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    unset ${LIST_VAR}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">  if [[ -n &quot;$CSV&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    local ADDR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    while IFS=&#39;,&#39; read -ra ADDR; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      for i in &quot;${ADDR[@]}&quot;; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">        i=&quot;$(echo &quot;$i&quot; | awk &#39;{$1=$1};1&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">        list-add-item &quot;$LIST_VAR&quot; &quot;$i&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    done &lt;&lt;&lt; &quot;$CSV&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">list-get-index() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">  local TEST=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">  local INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">    if [[ &quot;${ITEM}&quot; == &quot;${TEST}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      echo $INDEX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">    INDEX=$(($INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">list-get-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">  local INDEX=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">  local CURR_INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">    if (( $CURR_INDEX == $INDEX )) ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">      echo -n &quot;${ITEM%\\n}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    CURR_INDEX=$(($CURR_INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"># Echoes the frist item in the named list matching the given prefix.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"># LIST=&quot;foo bar&quot;$&#39;\n&#39;&quot;foo baz&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"># list-get-item-by-prefix LIST &quot;foo &quot; # echoes &#39;foo bar&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">list-get-item-by-prefix() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">  local PREFIX=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">  local ITEM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">    if [[ &quot;${ITEM}&quot; == &quot;${PREFIX}&quot;* ]] ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      echo -n &quot;${ITEM%\\n}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"># Joins a list with a given string and echos the result. We use &#39;echo -e&#39; for the join string, so &#39;\n&#39;, &#39;\t&#39;, etc. will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"># work.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby"># Takes (1) the list variable name, (2) the join string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"># Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"># list-add-item MY_LIST A B C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"># list-join MY_LIST &#39;||&#39; # echos &#39;A||B||C&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">list-join() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">  local JOIN_STRING=&quot;${2}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">  local CURR_INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">  local COUNT</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">  COUNT=&quot;$(list-count $LIST_VAR)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    echo -n &quot;$ITEM&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">    CURR_INDEX=$(($CURR_INDEX + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    if (( $CURR_INDEX &lt; $COUNT )) ; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">      echo -ne &quot;$JOIN_STRING&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">list-replace-by-string() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">  local TEST_ITEM=&quot;${2}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">  local NEW_ITEM=&quot;${3}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">  local ITEM INDEX NEW_LIST</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">  INDEX=0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">  for ITEM in ${!LIST_VAR:-}; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    if [[ &quot;$(list-get-item $LIST_VAR $INDEX)&quot; == &quot;$TEST_ITEM&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">      list-add-item NEW_LIST &quot;$NEW_ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">      list-add-item NEW_LIST &quot;$ITEM&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">    INDEX=$(($INDEX + 1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="196">
          
          
          <code class="ruby">  eval $LIST_VAR=&#39;&quot;&#39;&quot;$NEW_LIST&quot;&#39;&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">list-quote() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">  while read -r ITEM; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">    echo -n &quot;&#39;$(echo &quot;$ITEM&quot; | sed -e &quot;s/&#39;/&#39;\&quot;&#39;\&quot;&#39;/&quot;)&#39; &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${!LIST_VAR:-}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">list-rm-item() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">  local LIST_VAR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">  while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    local ITEM NEW_ITEMS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">    ITEM=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">    ITEM=${ITEM//\/\\/}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">    ITEM=${ITEM//#/\\#}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    ITEM=${ITEM//./\\.}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">    ITEM=${ITEM//[/\\[}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    # echo &quot;ITEM: $ITEM&quot; &gt;&amp;2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">    NEW_ITEMS=&quot;$(echo &quot;${!LIST_VAR}&quot; | sed -e &#39;\#^&#39;&quot;${ITEM}&quot;&#39;$#d&#39;)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">    eval $LIST_VAR=&#39;&quot;&#39;&quot;$NEW_ITEMS&quot;&#39;&quot;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="222">
          <span class="hits">16</span>
          
          <code class="ruby">if [[ $(uname) == &#39;Darwin&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">  GNU_GETOPT=&quot;$(brew --prefix gnu-getopt)/bin/getopt&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">else</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="225">
          <span class="hits">16</span>
          
          <code class="ruby">  GNU_GETOPT=&quot;$(which getopt)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"># Usage:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">#   eval &quot;$(setSimpleOptions SHORT LONG= SPECIFY_SHORT:X LONG_SPEC:S= -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">#     || ( contextHelp; echoerrandexit &quot;Bad options.&quot;; )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"># Note the use of the intermediate TMP is important to preserve the exit value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"># setSimpleOptions. E.g., doing &#39;eval &quot;$(setSimpleOptions ...)&quot;&#39; will work fine,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"># but because the last statement is the eval of the results, and not the function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"># call itself, the return of setSimpleOptions gets lost.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby"># Instead, it&#39;s generally recommended to be strict, &#39;set -e&#39;, and use the TMP-form.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">setSimpleOptions() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="239">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR_SPEC LOCAL_DECLS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="240">
          <span class="hits">14</span>
          
          <code class="ruby">  local LONG_OPTS=&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="241">
          <span class="hits">14</span>
          
          <code class="ruby">  local SHORT_OPTS=&quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">  # Bash Bug? This looks like a straight up bug in bash, but the left-paren in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  # &#39;--)&#39; was matching the &#39;$(&#39; and causing a syntax error. So we use &#39;]&#39; and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">  # replace it later.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">  local CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    --]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      break;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="249">
          <span class="hits">28</span>
          
          <code class="ruby">)</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="250">
          <span class="hits">43</span>
          
          <code class="ruby">  while true; do</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="251">
          <span class="hits">43</span>
          
          <code class="ruby">    if (( $# == 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">      echoerrandexit &quot;setSimpleOptions: No argument to process; did you forget to include the &#39;--&#39; marker?&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="254">
          <span class="hits">86</span>
          
          <code class="ruby">    VAR_SPEC=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="255">
          <span class="hits">43</span>
          
          <code class="ruby">    local VAR_NAME LOWER_NAME SHORT_OPT LONG_OPT IS_PASSTHRU</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="256">
          <span class="hits">43</span>
          
          <code class="ruby">    IS_PASSTHRU=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="257">
          <span class="hits">43</span>
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == *&#39;^&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">      IS_PASSTHRU=true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      VAR_SPEC=${VAR_SPEC/%^/}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="261">
          <span class="hits">43</span>
          
          <code class="ruby">    local OPT_ARG=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="262">
          <span class="hits">43</span>
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == *&#39;=&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="263">
          <span class="hits">7</span>
          
          <code class="ruby">      OPT_ARG=&#39;:&#39;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="264">
          <span class="hits">7</span>
          
          <code class="ruby">      VAR_SPEC=${VAR_SPEC/%=/}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="267">
          <span class="hits">43</span>
          
          <code class="ruby">    if [[ &quot;$VAR_SPEC&quot; == &#39;--&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="268">
          <span class="hits">14</span>
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="269">
          <span class="hits">29</span>
          
          <code class="ruby">    elif [[ &quot;$VAR_SPEC&quot; == *&#39;:&#39;* ]]; then</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="270">
          <span class="hits">39</span>
          
          <code class="ruby">      VAR_NAME=$(echo &quot;$VAR_SPEC&quot; | cut -d: -f1)</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="271">
          <span class="hits">39</span>
          
          <code class="ruby">      SHORT_OPT=$(echo &quot;$VAR_SPEC&quot; | cut -d: -f2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">    else # each input is a variable name</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="273">
          <span class="hits">16</span>
          
          <code class="ruby">      VAR_NAME=&quot;$VAR_SPEC&quot;</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="274">
          <span class="hits">48</span>
          
          <code class="ruby">      SHORT_OPT=$(echo &quot;${VAR_NAME::1}&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="277">
          <span class="hits">87</span>
          
          <code class="ruby">    VAR_NAME=$(echo &quot;$VAR_NAME&quot; | tr -d &quot;=&quot;)</code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="278">
          <span class="hits">87</span>
          
          <code class="ruby">    LOWER_NAME=$(echo &quot;$VAR_NAME&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)</code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="279">
          <span class="hits">87</span>
          
          <code class="ruby">    LONG_OPT=&quot;$(echo &quot;${LOWER_NAME}&quot; | tr &#39;_&#39; &#39;-&#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="281">
          <span class="hits">29</span>
          
          <code class="ruby">    if [[ -n &quot;${SHORT_OPT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="282">
          <span class="hits">29</span>
          
          <code class="ruby">      SHORT_OPTS=&quot;${SHORT_OPTS:-}${SHORT_OPT}${OPT_ARG}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="285">
          <span class="hits">116</span>
          
          <code class="ruby">    LONG_OPTS=$( ( test ${#LONG_OPTS} -gt 0 &amp;&amp; echo -n &quot;${LONG_OPTS},&quot;) || true &amp;&amp; echo -n &quot;${LONG_OPT}${OPT_ARG}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="287">
          <span class="hits">29</span>
          
          <code class="ruby">    LOCAL_DECLS=&quot;${LOCAL_DECLS:-}local ${VAR_NAME}=&#39;&#39;;&quot;</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="288">
          <span class="hits">29</span>
          
          <code class="ruby">    local CASE_SELECT=&quot;-${SHORT_OPT}|--${LONG_OPT}]&quot;</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="289">
          <span class="hits">29</span>
          
          <code class="ruby">    if [[ &quot;$IS_PASSTHRU&quot; == true ]]; then # handle passthru</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">        ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="292">
          
          
          <code class="ruby">          ${CASE_SELECT}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">          list-add-item _PASSTHRU &quot;\$1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">      if [[ -n &quot;$OPT_ARG&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">        CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">          ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">            list-add-item _PASSTHRU &quot;\$2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">            shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">        ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">          shift;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">    else # non-passthru vars</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="310">
          <span class="hits">29</span>
          
          <code class="ruby">      local VAR_SETTER=&quot;${VAR_NAME}=true;&quot;</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="311">
          <span class="hits">29</span>
          
          <code class="ruby">      if [[ -n &quot;$OPT_ARG&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="312">
          <span class="hits">7</span>
          
          <code class="ruby">        LOCAL_DECLS=&quot;${LOCAL_DECLS}local ${VAR_NAME}_SET=&#39;&#39;;&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="313">
          <span class="hits">7</span>
          
          <code class="ruby">        VAR_SETTER=${VAR_NAME}&#39;=&quot;${2}&quot;; &#39;${VAR_NAME}&#39;_SET=true; shift;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="315">
          <span class="hits">29</span>
          
          <code class="ruby">      if [[ -z &quot;$SHORT_OPT&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">        CASE_SELECT=&quot;--${LONG_OPT}]&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">      ${CASE_HANDLER}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">        ${CASE_SELECT}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">          $VAR_SETTER</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">          _OPTS_COUNT=\$(( \$_OPTS_COUNT + 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">          shift;;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="325">
          <span class="hits">58</span>
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">  done # main while loop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">  CASE_HANDLER=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">    case &quot;\${1}&quot; in</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">      $CASE_HANDLER</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="333">
          <span class="hits">28</span>
          
          <code class="ruby">)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  # replace the &#39;]&#39;; see &#39;Bash Bug?&#39; above</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="335">
          <span class="hits">42</span>
          
          <code class="ruby">  CASE_HANDLER=$(echo &quot;$CASE_HANDLER&quot; | perl -pe &#39;s/\]$/)/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="337">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$LOCAL_DECLS&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="339">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="340">
          <span class="hits">14</span>
          
          <code class="ruby">local TMP # see https://unix.stackexchange.com/a/88338/84520</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="341">
          <span class="hits">14</span>
          
          <code class="ruby">local _PASSTHRU=&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="342">
          <span class="hits">14</span>
          
          <code class="ruby">TMP=\$(${GNU_GETOPT} -o &quot;${SHORT_OPTS}&quot; -l &quot;${LONG_OPTS}&quot; -- &quot;\$@&quot;) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="343">
          <span class="hits">14</span>
          
          <code class="ruby">  || exit \$?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="344">
          <span class="hits">14</span>
          
          <code class="ruby">eval set -- &quot;\$TMP&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="345">
          <span class="hits">14</span>
          
          <code class="ruby">local _OPTS_COUNT=0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="346">
          <span class="hits">14</span>
          
          <code class="ruby">while true; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="347">
          <span class="hits">14</span>
          
          <code class="ruby">  $CASE_HANDLER</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="348">
          <span class="hits">14</span>
          
          <code class="ruby">done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="349">
          <span class="hits">14</span>
          
          <code class="ruby">shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="350">
          <span class="hits">14</span>
          
          <code class="ruby">if [[ -n &quot;\$_PASSTHRU&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="351">
          <span class="hits">14</span>
          
          <code class="ruby">  eval set -- \$(list-quote _PASSTHRU) &quot;\$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="352">
          <span class="hits">14</span>
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="353">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="354">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="355">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="356">
          <span class="hits">14</span>
          
          <code class="ruby">echoerr() {</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="357">
          <span class="hits">3</span>
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="358">
          <span class="hits">6</span>
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="359">
          <span class="hits">6</span>
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="360">
          <span class="hits">3</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="361">
          <span class="hits">6</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="362">
          <span class="hits">12</span>
          
          <code class="ruby">    echo -e &quot;${red}$*${reset}&quot; | fold -sw 82 &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="363">
          <span class="hits">6</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="364">
          <span class="hits">3</span>
          
          <code class="ruby">    echo -e &quot;${red}$*${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="365">
          <span class="hits">3</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="366">
          <span class="hits">3</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="367">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="368">
          <span class="hits">3</span>
          
          <code class="ruby">echowarn() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="369">
          <span class="hits">14</span>
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="370">
          <span class="hits">14</span>
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="371">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="372">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="373">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="374">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -e &quot;${yellow}$*${reset}&quot; | fold -sw 82 &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="375">
          <span class="hits">3</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="376">
          <span class="hits">3</span>
          
          <code class="ruby">    echo -e &quot;${yellow}$*${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="377">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="378">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="379">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="380">
          <span class="hits">14</span>
          
          <code class="ruby">echoerrandexit() {</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="381">
          <span class="hits">3</span>
          
          <code class="ruby">  local TMP</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="382">
          <span class="hits">6</span>
          
          <code class="ruby">  TMP=$(setSimpleOptions NO_FOLD:F -- &quot;$@&quot;) || $(echo &quot;Bad options: $*&quot;; exit -10)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="383">
          <span class="hits">6</span>
          
          <code class="ruby">  eval &quot;$TMP&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="384">
          <span class="hits">3</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="385">
          <span class="hits">6</span>
          
          <code class="ruby">  local MSG=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="386">
          <span class="hits">9</span>
          
          <code class="ruby">  local EXIT_CODE=&quot;${2:-10}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="387">
          <span class="hits">6</span>
          
          <code class="ruby">  # TODO: consider providing &#39;passopts&#39; method which coordites with &#39;setSimpleOptions&#39; to recreate option string</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="388">
          <span class="hits">6</span>
          
          <code class="ruby">  if [[ -n &quot;$NO_FOLD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="389">
          <span class="hits">3</span>
          
          <code class="ruby">    echoerr --no-fold &quot;$MSG&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="390">
          <span class="hits">3</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="391">
          <span class="hits">3</span>
          
          <code class="ruby">    echoerr &quot;$MSG&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="392">
          <span class="hits">3</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="393">
          <span class="hits">3</span>
          
          <code class="ruby">  exit $EXIT_CODE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="394">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="395">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="396">
          <span class="hits">14</span>
          
          <code class="ruby">field-to-label() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="397">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELD=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="398">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;${FIELD:0:1}$(echo &quot;${FIELD:1}&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39; | tr &#39;_&#39; &#39; &#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="399">
          <span class="hits">3</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="400">
          <span class="hits">3</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="401">
          <span class="hits">14</span>
          
          <code class="ruby">echo-label-and-values() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="402">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions STDERR:e -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="403">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="404">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELD=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="405">
          <span class="hits">14</span>
          
          <code class="ruby">  local VALUES=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="406">
          <span class="hits">14</span>
          
          <code class="ruby">  (( $# == 2 )) || VALUES=&quot;${!FIELD:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="407">
          <span class="hits">14</span>
          
          <code class="ruby">  local OUT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="408">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="409">
          <span class="hits">14</span>
          
          <code class="ruby">  OUT=&quot;$(echo -n &quot;$(field-to-label &quot;$FIELD&quot;): &quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="410">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $(echo &quot;${VALUES}&quot; | wc -l) &gt; 1 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="411">
          <span class="hits">14</span>
          
          <code class="ruby">    OUT=&quot;${OUT}$(echo -e &quot;\n${VALUES}&quot; | sed &#39;2,$ s/^/   /&#39;)&quot; # indent</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="412">
          <span class="hits">14</span>
          
          <code class="ruby">  else # just one line</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="413">
          <span class="hits">14</span>
          
          <code class="ruby">    OUT=&quot;${OUT}$(echo &quot;${VALUES}&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="414">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="415">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="416">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$STDERR&quot; ]]; then # echo to stdout</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="417">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -e &quot;$OUT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="418">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="419">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -e &quot;$OUT&quot; &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="420">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="421">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="422">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="423">
          <span class="hits">14</span>
          
          <code class="ruby"># Prompts the user for input and saves it to a var.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="424">
          <span class="hits">14</span>
          
          <code class="ruby"># Arg 1: The prompt.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="425">
          <span class="hits">14</span>
          
          <code class="ruby"># Arg 2: The name of the var to save the answer to. (BUG: Don&#39;t use &#39;VAR&#39;. &#39;ANSWER&#39; is always safe.)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="426">
          <span class="hits">14</span>
          
          <code class="ruby"># Arg 3 (opt): Default value to use if the user just hits enter.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="427">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="428">
          <span class="hits">14</span>
          
          <code class="ruby"># The defult value will be added to the prompt.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="429">
          <span class="hits">14</span>
          
          <code class="ruby"># If &#39;--multi-line&#39; is specified, the user may enter multiple lines, and end input with a line containing a single &#39;.&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="430">
          <span class="hits">14</span>
          
          <code class="ruby"># Instructions to this effect will emitted. Also, in this mode, spaces in the answer will be preserved, while in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="431">
          <span class="hits">14</span>
          
          <code class="ruby"># &#39;single line&#39; mode, leading and trailing spaces will be removed.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="432">
          <span class="hits">14</span>
          
          <code class="ruby">get-answer() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="433">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions MULTI_LINE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="434">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROMPT=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="435">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR=&quot;$2&quot; # TODO: if name is &#39;VAR&#39;, then this breaks...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="436">
          <span class="hits">14</span>
          
          <code class="ruby">  local DEFAULT=&quot;${3:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="437">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="438">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;${DEFAULT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="439">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$MULTI_LINE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="440">
          <span class="hits">14</span>
          
          <code class="ruby">      PROMPT=&quot;${PROMPT} (${DEFAULT}) &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="441">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="442">
          <span class="hits">14</span>
          
          <code class="ruby">      PROMPT=&quot;${PROMPT}&quot;$&#39;\n&#39;&#39;(Hit &quot;&lt;PERIOD&gt;&lt;ENTER&gt;&quot; for default:&#39;$&#39;\n&#39;&quot;$DEFAULT&quot;$&#39;\n&#39;&#39;)&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="443">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="444">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="445">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="446">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$MULTI_LINE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="447">
          <span class="hits">14</span>
          
          <code class="ruby">    read -r -p &quot;$PROMPT&quot; $VAR</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="448">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z ${!VAR:-} ]] &amp;&amp; [[ -n &quot;$DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="449">
          <span class="hits">14</span>
          
          <code class="ruby">      # MacOS dosen&#39;t support &#39;declare -g&#39; :(</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="450">
          <span class="hits">14</span>
          
          <code class="ruby">      eval $VAR=&#39;&quot;$DEFAULT&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="451">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="452">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="453">
          <span class="hits">14</span>
          
          <code class="ruby">    local LINE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="454">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$PROMPT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="455">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;(End multi-line input with single &#39;.&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="456">
          <span class="hits">14</span>
          
          <code class="ruby">    unset $VAR LINE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="457">
          <span class="hits">14</span>
          
          <code class="ruby">    while true; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="458">
          <span class="hits">14</span>
          
          <code class="ruby">      IFS= read -r LINE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="459">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;$LINE&quot; == &#39;.&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="460">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -z &quot;${!VAR:-}&quot; ]] &amp;&amp; [[ -n &quot;$DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="461">
          <span class="hits">14</span>
          
          <code class="ruby">          eval $VAR=&#39;&quot;$DEFAULT&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="462">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="463">
          <span class="hits">14</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="464">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="465">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item $VAR &quot;$LINE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="466">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="467">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="468">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="469">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="470">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="471">
          <span class="hits">14</span>
          
          <code class="ruby"># Functions as &#39;get-answer&#39;, but will continually propmt the user if no answer is given.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="472">
          <span class="hits">14</span>
          
          <code class="ruby"># &#39;--force&#39; causes the default to be set to the previous answer and the query to be run again. This is mainly useful</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="473">
          <span class="hits">14</span>
          
          <code class="ruby"># internally and direct calls should generally note have cause to use this option. (TODO: let&#39;s rewrite this to &#39;unset&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="474">
          <span class="hits">14</span>
          
          <code class="ruby"># the vars (?) and avoid the need for force?)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="475">
          <span class="hits">14</span>
          
          <code class="ruby">require-answer() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="476">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FORCE MULTI_LINE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="477">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROMPT=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="478">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR=&quot;$2&quot; # TODO: if name is &#39;VAR&#39;, then this breaks...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="479">
          <span class="hits">14</span>
          
          <code class="ruby">  local DEFAULT=&quot;${3:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="480">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="481">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$FORCE&quot; ]] &amp;&amp; [[ -z &quot;$DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="482">
          <span class="hits">14</span>
          
          <code class="ruby">    DEFAULT=&quot;${!VAR}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="483">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="484">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="485">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: support &#39;pass-through&#39; options in &#39;setSimpleOptions&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="486">
          <span class="hits">14</span>
          
          <code class="ruby">  local OPTS=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="487">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$MULTI_LINE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="488">
          <span class="hits">14</span>
          
          <code class="ruby">    OPTS=&quot;${OPTS}--multi-line &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="489">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="490">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ -z ${!VAR:-} ]] || [[ -n &quot;$FORCE&quot; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="491">
          <span class="hits">14</span>
          
          <code class="ruby">    get-answer ${OPTS} &quot;$PROMPT&quot; &quot;$VAR&quot; &quot;$DEFAULT&quot; # can&#39;t use &quot;$@&quot; because default may be overriden</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="492">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z ${!VAR:-} ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="493">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerr &quot;A response is required.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="494">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="495">
          <span class="hits">14</span>
          
          <code class="ruby">      FORCE=&#39;&#39; # if forced into loop, then we un-force when we get an answer</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="496">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="497">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="498">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="499">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="500">
          <span class="hits">14</span>
          
          <code class="ruby"># Produces a &#39;yes/no&#39; prompt, accepting &#39;y&#39;, &#39;yes&#39;, &#39;n&#39;, or &#39;no&#39; (case insensitive). Unlike other prompts, this function</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="501">
          <span class="hits">14</span>
          
          <code class="ruby"># returns true or false, making it convenient for boolean tests.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="502">
          <span class="hits">14</span>
          
          <code class="ruby">yes-no() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="503">
          <span class="hits">14</span>
          
          <code class="ruby">  default-yes() { return 0; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="504">
          <span class="hits">14</span>
          
          <code class="ruby">  default-no() { return 1; } # bash false-y</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="505">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="506">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROMPT=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="507">
          <span class="hits">14</span>
          
          <code class="ruby">  local DEFAULT=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="508">
          <span class="hits">14</span>
          
          <code class="ruby">  local HANDLE_YES=&quot;${3:-default-yes}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="509">
          <span class="hits">14</span>
          
          <code class="ruby">  local HANDLE_NO=&quot;${4:-default-no}&quot; # default to noop</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="510">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="511">
          <span class="hits">14</span>
          
          <code class="ruby">  local ANSWER=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="512">
          <span class="hits">14</span>
          
          <code class="ruby">  read -p &quot;$PROMPT&quot; ANSWER</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="513">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$ANSWER&quot; ]] &amp;&amp; [[ -n &quot;$DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="514">
          <span class="hits">14</span>
          
          <code class="ruby">    case &quot;$DEFAULT&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="515">
          <span class="hits">14</span>
          
          <code class="ruby">      Y*|y*)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="516">
          <span class="hits">14</span>
          
          <code class="ruby">        $HANDLE_YES; return $?;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="517">
          <span class="hits">14</span>
          
          <code class="ruby">      N*|n*)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="518">
          <span class="hits">14</span>
          
          <code class="ruby">        $HANDLE_NO; return $?;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="519">
          <span class="hits">14</span>
          
          <code class="ruby">      *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="520">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;You must choose an answer.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="521">
          <span class="hits">14</span>
          
          <code class="ruby">        yes-no &quot;$PROMPT&quot; &quot;$DEFAULT&quot; $HANDLE_YES $HANDLE_NO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="522">
          <span class="hits">14</span>
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="523">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="524">
          <span class="hits">14</span>
          
          <code class="ruby">    case &quot;$(echo &quot;$ANSWER&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="525">
          <span class="hits">14</span>
          
          <code class="ruby">      y|yes)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="526">
          <span class="hits">14</span>
          
          <code class="ruby">        $HANDLE_YES; return $?;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="527">
          <span class="hits">14</span>
          
          <code class="ruby">      n|no)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="528">
          <span class="hits">14</span>
          
          <code class="ruby">        $HANDLE_NO; return $?;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="529">
          <span class="hits">14</span>
          
          <code class="ruby">      *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="530">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;Did not understand response, please answer &#39;y(es)&#39; or &#39;n(o)&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="531">
          <span class="hits">14</span>
          
          <code class="ruby">        yes-no &quot;$PROMPT&quot; &quot;$DEFAULT&quot; $HANDLE_YES $HANDLE_NO;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="532">
          <span class="hits">14</span>
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="533">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="534">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="535">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="536">
          <span class="hits">14</span>
          
          <code class="ruby">gather-answers() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="537">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions VERIFY PROMPTER= SELECTOR= DEFAULTER= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="538">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELDS=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="539">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="540">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELD VERIFIED</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="541">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ &quot;${VERIFIED}&quot; != true ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="542">
          <span class="hits">14</span>
          
          <code class="ruby">    # collect answers</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="543">
          <span class="hits">14</span>
          
          <code class="ruby">    for FIELD in $FIELDS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="544">
          <span class="hits">14</span>
          
          <code class="ruby">      local LABEL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="545">
          <span class="hits">14</span>
          
          <code class="ruby">      LABEL=&quot;$(field-to-label &quot;$FIELD&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="546">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="547">
          <span class="hits">14</span>
          
          <code class="ruby">      local PROMPT DEFAULT SELECT_OPTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="548">
          <span class="hits">14</span>
          
          <code class="ruby">      PROMPT=&quot;$({ [[ -n &quot;$PROMPTER&quot; ]] &amp;&amp; $PROMPTER &quot;$FIELD&quot; &quot;$LABEL&quot;; } || echo &quot;${LABEL}: &quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="549">
          <span class="hits">14</span>
          
          <code class="ruby">      DEFAULT=&quot;$({ [[ -n &quot;$DEFAULTER&quot; ]] &amp;&amp; $DEFAULTER &quot;$FIELD&quot;; } || echo &#39;&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="550">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -n &quot;$SELECTOR&quot; ]] &amp;&amp; SELECT_OPS=&quot;$($SELECTOR &quot;$FIELD&quot;)&quot; &amp;&amp; [[ -n &quot;$SELECT_OPS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="551">
          <span class="hits">14</span>
          
          <code class="ruby">        local FIELD_SET=&quot;${FIELD}_SET&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="552">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -z ${!FIELD:-} ]] &amp;&amp; [[ &quot;${!FIELD_SET}&quot; != &#39;true&#39; ]] || [[ &quot;$VERIFIED&quot; == false ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="553">
          <span class="hits">14</span>
          
          <code class="ruby">          unset $FIELD</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="554">
          <span class="hits">14</span>
          
          <code class="ruby">          PS3=&quot;${PROMPT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="555">
          <span class="hits">14</span>
          
          <code class="ruby">          selectDoneCancel &quot;$FIELD&quot; SELECT_OPS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="556">
          <span class="hits">14</span>
          
          <code class="ruby">          unset PS3</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="557">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="558">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="559">
          <span class="hits">14</span>
          
          <code class="ruby">        local OPTS=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="560">
          <span class="hits">14</span>
          
          <code class="ruby">        # if VERIFIED is set, but false, then we need to force require-answer to set the var</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="561">
          <span class="hits">14</span>
          
          <code class="ruby">        [[ &quot;$VERIFIED&quot; == false ]] &amp;&amp; OPTS=&#39;--force &#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="562">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ &quot;${FIELD}&quot; == *: ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="563">
          <span class="hits">14</span>
          
          <code class="ruby">          FIELD=${FIELD/%:/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="564">
          <span class="hits">14</span>
          
          <code class="ruby">          OPTS=&quot;${OPTS}--multi-line &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="565">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="566">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="567">
          <span class="hits">14</span>
          
          <code class="ruby">        require-answer ${OPTS} &quot;${PROMPT}&quot; $FIELD &quot;$DEFAULT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="568">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="569">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="570">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="571">
          <span class="hits">14</span>
          
          <code class="ruby">    # verify, as necessary</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="572">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;${VERIFY}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="573">
          <span class="hits">14</span>
          
          <code class="ruby">      VERIFIED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="574">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="575">
          <span class="hits">14</span>
          
          <code class="ruby">      verify() { VERIFIED=true; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="576">
          <span class="hits">14</span>
          
          <code class="ruby">      no-verify() { VERIFIED=false; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="577">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="578">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Verify the following:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="579">
          <span class="hits">14</span>
          
          <code class="ruby">      for FIELD in $FIELDS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="580">
          <span class="hits">14</span>
          
          <code class="ruby">        FIELD=${FIELD/:/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="581">
          <span class="hits">14</span>
          
          <code class="ruby">        echo-label-and-values &quot;${FIELD}&quot; &quot;${!FIELD:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="582">
          <span class="hits">14</span>
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="583">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="584">
          <span class="hits">14</span>
          
          <code class="ruby">      yes-no &quot;Are these values correct? (y/N) &quot; N verify no-verify</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="585">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="586">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="587">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="588">
          <span class="hits">14</span>
          
          <code class="ruby">function real_path {</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="589">
          <span class="hits">8</span>
          
          <code class="ruby">  local FILE=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="590">
          <span class="hits">8</span>
          
          <code class="ruby">  if [[ -z &quot;$FILE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="591">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;&#39;real_path&#39; requires target file specified.&quot; &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="592">
          <span class="hits">14</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="593">
          <span class="hits">8</span>
          
          <code class="ruby">  elif [[ ! -e &quot;$FILE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="594">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Target file &#39;$FILE&#39; does not exist.&quot; &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="595">
          <span class="hits">14</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="596">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="597">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="598">
          <span class="hits">14</span>
          
          <code class="ruby">  function trim_slash {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="599">
          <span class="hits">14</span>
          
          <code class="ruby">    # sed adds a newline ()</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="600">
          <span class="hits">24</span>
          
          <code class="ruby">    printf &quot;$1&quot; | sed &#39;s/\/$//&#39; | tr -d &#39;\n&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="601">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="602">
          <span class="hits">14</span>
          
          <code class="ruby">  # [[ -h /foo/link_dir ]] works, but [[ -h /foo/link_dir/ ]] does not!</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="603">
          <span class="hits">16</span>
          
          <code class="ruby">  FILE=`trim_slash &quot;$FILE&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="604">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="605">
          <span class="hits">8</span>
          
          <code class="ruby">  if [[ -h &quot;$FILE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="606">
          <span class="hits">14</span>
          
          <code class="ruby">    function resolve_link {</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="607">
          <span class="hits">8</span>
          
          <code class="ruby">      local POSSIBLE_REL_LINK=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="608">
          <span class="hits">8</span>
          
          <code class="ruby">      local APPEND=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="609">
          <span class="hits">8</span>
          
          <code class="ruby">      if [[ &quot;$POSSIBLE_REL_LINK&quot; == /* ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="610">
          <span class="hits">14</span>
          
          <code class="ruby">        # for some reason &#39;echo -n&#39; was echoing the &#39;-n&#39; when this was used</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="611">
          <span class="hits">14</span>
          
          <code class="ruby">        # included in the catalyst-scripts. Not sure why, and don&#39;t know how</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="612">
          <span class="hits">14</span>
          
          <code class="ruby">        # to test, but &#39;printf&#39; does what we need.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="613">
          <span class="hits">14</span>
          
          <code class="ruby">        printf &quot;$POSSIBLE_REL_LINK${APPEND}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="614">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="615">
          <span class="hits">14</span>
          
          <code class="ruby">        # Now we go into the dir containg the link and then navigate the possibly</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="616">
          <span class="hits">14</span>
          
          <code class="ruby">        # relative link to the real dir. The subshell preserves the caller&#39;s PWD.</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="617">
          <span class="hits">16</span>
          
          <code class="ruby">        (cd &quot;$(dirname &quot;$FILE&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="618">
          <span class="hits">8</span>
          
          <code class="ruby">        cd &quot;$POSSIBLE_REL_LINK&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="619">
          <span class="hits">8</span>
          
          <code class="ruby">        printf &quot;${PWD}${APPEND}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="620">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="621">
          <span class="hits">14</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="622">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="623">
          <span class="hits">8</span>
          
          <code class="ruby">    if [[ ! -d &quot;$FILE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="624">
          <span class="hits">14</span>
          
          <code class="ruby">      # we need to get the real path to the real file</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="625">
          <span class="hits">16</span>
          
          <code class="ruby">      local REAL_FILE_LINK_PATH=&quot;$(readlink &quot;$FILE&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="626">
          <span class="hits">24</span>
          
          <code class="ruby">      resolve_link &quot;$(dirname &quot;$REAL_FILE_LINK_PATH&quot;)&quot; &quot;/$(basename &quot;$REAL_FILE_LINK_PATH&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="627">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="628">
          <span class="hits">14</span>
          
          <code class="ruby">      # we need to get the real path of the linked directory</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="629">
          <span class="hits">14</span>
          
          <code class="ruby">      resolve_link &quot;$(readlink &quot;$FILE&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="630">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="631">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="632">
          <span class="hits">14</span>
          
          <code class="ruby">    printf &quot;$FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="633">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="634">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="635">
          <span class="hits">14</span>
          
          <code class="ruby"># You have two options when passing in the options to any of the select</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="636">
          <span class="hits">14</span>
          
          <code class="ruby"># functions. You can separate each item by space and use quotes, such as:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="637">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="638">
          <span class="hits">14</span>
          
          <code class="ruby"># selectOneCancel RESULT option1 &quot;option with space&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="639">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="640">
          <span class="hits">14</span>
          
          <code class="ruby"># Or you can embed newlines in the option string, such as:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="641">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="642">
          <span class="hits">14</span>
          
          <code class="ruby"># OPTIONS=&quot;option1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="643">
          <span class="hits">14</span>
          
          <code class="ruby"># option with space&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="644">
          <span class="hits">14</span>
          
          <code class="ruby"># selectOneCancel RESULT &quot;$OPTIONS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="645">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="646">
          <span class="hits">14</span>
          
          <code class="ruby"># The second method can be combined with &#39;list-add-item&#39; to safely build up</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="647">
          <span class="hits">14</span>
          
          <code class="ruby"># options (which may contain spaces) dynamically. The two methods cannot be</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="648">
          <span class="hits">14</span>
          
          <code class="ruby"># combined and the presece of a newline in any option will cause the input to</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="649">
          <span class="hits">14</span>
          
          <code class="ruby"># interepretted by the second method.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="650">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="651">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="652">
          <span class="hits">14</span>
          
          <code class="ruby">_commonSelectHelper() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="653">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: the &#39;_&#39; is to avoid collision, but is a bit hacky; in particular, some callers were using &#39;local OPTIONS&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="654">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO TODO: when declared local here, it should not change the caller... I tihnk the original analysis was flawed.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="655">
          <span class="hits">14</span>
          
          <code class="ruby">  local _SELECT_LIMIT=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="656">
          <span class="hits">14</span>
          
          <code class="ruby">  local _VAR_NAME=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="657">
          <span class="hits">14</span>
          
          <code class="ruby">  local _PRE_OPTS=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="658">
          <span class="hits">14</span>
          
          <code class="ruby">  local _POST_OPTS=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="659">
          <span class="hits">14</span>
          
          <code class="ruby">  local _OPTIONS_LIST_NAME=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="660">
          <span class="hits">14</span>
          
          <code class="ruby">  local _SELECTION</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="661">
          <span class="hits">14</span>
          
          <code class="ruby">  local _QUIT=&#39;false&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="662">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="663">
          <span class="hits">14</span>
          
          <code class="ruby">  local _OPTIONS=&quot;${!_OPTIONS_LIST_NAME:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="664">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: would be nice to have a &#39;prepend-&#39; or &#39;unshift-&#39; items.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="665">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$_PRE_OPTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="666">
          <span class="hits">14</span>
          
          <code class="ruby">    _OPTIONS=&quot;$_PRE_OPTS&quot;$&#39;\n&#39;&quot;$_OPTIONS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="667">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="668">
          <span class="hits">14</span>
          
          <code class="ruby">  list-add-item _OPTIONS $_POST_OPTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="669">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="670">
          <span class="hits">14</span>
          
          <code class="ruby">  updateVar() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="671">
          <span class="hits">14</span>
          
          <code class="ruby">    _SELECTION=&quot;$(echo &quot;$_SELECTION&quot; | sed -Ee &#39;s/^\*//&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="672">
          <span class="hits">14</span>
          
          <code class="ruby">    list-add-item $_VAR_NAME &quot;$_SELECTION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="673">
          <span class="hits">14</span>
          
          <code class="ruby">    _SELECTED_COUNT=$(( $_SELECTED_COUNT + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="674">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="675">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="676">
          <span class="hits">14</span>
          
          <code class="ruby">  local _SELECTED_COUNT=0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="677">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="678">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ $_QUIT == &#39;false&#39; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="679">
          <span class="hits">14</span>
          
          <code class="ruby">    local OLDIFS=&quot;$IFS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="680">
          <span class="hits">14</span>
          
          <code class="ruby">    IFS=$&#39;\n&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="681">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="682">
          <span class="hits">14</span>
          
          <code class="ruby">    select _SELECTION in $_OPTIONS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="683">
          <span class="hits">14</span>
          
          <code class="ruby">      case &quot;$_SELECTION&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="684">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;cancel&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="685">
          <span class="hits">14</span>
          
          <code class="ruby">          return;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="686">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;done&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="687">
          <span class="hits">14</span>
          
          <code class="ruby">          _QUIT=&#39;true&#39;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="688">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;other&gt;&#39;|&#39;&lt;new&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="689">
          <span class="hits">14</span>
          
          <code class="ruby">          _SELECTION=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="690">
          <span class="hits">14</span>
          
          <code class="ruby">          require-answer &quot;$PS3&quot; _SELECTION &quot;$_DEFAULT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="691">
          <span class="hits">14</span>
          
          <code class="ruby">          updateVar;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="692">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;any&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="693">
          <span class="hits">14</span>
          
          <code class="ruby">          eval $_VAR_NAME=&#39;any&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="694">
          <span class="hits">14</span>
          
          <code class="ruby">          _QUIT=&#39;true&#39;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="695">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;all&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="696">
          <span class="hits">14</span>
          
          <code class="ruby">          eval $_VAR_NAME=&#39;&quot;$_ENUM_OPTIONS&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="697">
          <span class="hits">14</span>
          
          <code class="ruby">          _QUIT=&#39;true&#39;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="698">
          <span class="hits">14</span>
          
          <code class="ruby">        &#39;&lt;default&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="699">
          <span class="hits">14</span>
          
          <code class="ruby">          eval &quot;${_VAR_NAME}=\&quot;${SELECT_DEFAULT}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="700">
          <span class="hits">14</span>
          
          <code class="ruby">          _QUIT=&#39;true&#39;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="701">
          <span class="hits">14</span>
          
          <code class="ruby">        *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="702">
          <span class="hits">14</span>
          
          <code class="ruby">          updateVar;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="703">
          <span class="hits">14</span>
          
          <code class="ruby">      esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="704">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="705">
          <span class="hits">14</span>
          
          <code class="ruby">      # after first selection, &#39;default&#39; is nullified</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="706">
          <span class="hits">14</span>
          
          <code class="ruby">      SELECT_DEFAULT=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="707">
          <span class="hits">14</span>
          
          <code class="ruby">      _OPTIONS=$(echo &quot;$_OPTIONS&quot; | sed -Ee &#39;s/(^|\n)&lt;default&gt;(\n|$)//&#39; | tr -d &#39;*&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="708">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="709">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -n &quot;$_SELECT_LIMIT&quot; ]] &amp;&amp; (( $_SELECT_LIMIT &gt;= $_SELECTED_COUNT )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="710">
          <span class="hits">14</span>
          
          <code class="ruby">        _QUIT=&#39;true&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="711">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="712">
          <span class="hits">14</span>
          
          <code class="ruby">      # Our user feedback should go to stderr just like the user prompts from select</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="713">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;$_QUIT&quot; != &#39;true&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="714">
          <span class="hits">14</span>
          
          <code class="ruby">        echo-label-and-values --stderr &quot;Current selection&quot; &quot;${!_VAR_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="715">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="716">
          <span class="hits">14</span>
          
          <code class="ruby">        echo-label-and-values --stderr &quot;Final selection&quot; &quot;${!_VAR_NAME:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="717">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="718">
          <span class="hits">14</span>
          
          <code class="ruby">      # remove the just selected option</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="719">
          <span class="hits">14</span>
          
          <code class="ruby">      _OPTIONS=${_OPTIONS/$_SELECTION/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="720">
          <span class="hits">14</span>
          
          <code class="ruby">      _OPTIONS=${_OPTIONS//$&#39;\n&#39;$&#39;\n&#39;/$&#39;\n&#39;}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="721">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="722">
          <span class="hits">14</span>
          
          <code class="ruby">      # if we only have the default options left, then we&#39;re done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="723">
          <span class="hits">14</span>
          
          <code class="ruby">      local EMPTY_TEST # sed inherently matches lines, not strings</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="724">
          <span class="hits">14</span>
          
          <code class="ruby">      EMPTY_TEST=`echo &quot;$_OPTIONS&quot; | sed -Ee &#39;s/^(&lt;done&gt;)?\n?(&lt;cancel&gt;)?\n?(&lt;all&gt;)?\n?(&lt;any&gt;)?\n?(&lt;default&gt;)?\n?(&lt;other&gt;)?\n?(&lt;new&gt;)?$//&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="725">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="726">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;$EMPTY_TEST&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="727">
          <span class="hits">14</span>
          
          <code class="ruby">        _QUIT=&#39;true&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="728">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="729">
          <span class="hits">14</span>
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="730">
          <span class="hits">14</span>
          
          <code class="ruby">    done # end select</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="731">
          <span class="hits">14</span>
          
          <code class="ruby">    IFS=&quot;$OLDIFS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="732">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="733">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="734">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="735">
          <span class="hits">14</span>
          
          <code class="ruby">selectOneCancel() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="736">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper 1 &quot;$1&quot; &#39;&lt;cancel&gt;&#39; &#39;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="737">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="738">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="739">
          <span class="hits">14</span>
          
          <code class="ruby">selectOneCancelDefault() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="740">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$SELECT_DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="741">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;Requested &#39;default&#39; select, but no default provided. Falling back to non-default selection.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="742">
          <span class="hits">14</span>
          
          <code class="ruby">    selectOneCancel &quot;$1&quot; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="743">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="744">
          <span class="hits">14</span>
          
          <code class="ruby">    _commonSelectHelper 1 &quot;$1&quot; &#39;&lt;cancel&gt;&#39; &#39;&lt;default&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="745">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="746">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="747">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="748">
          <span class="hits">14</span>
          
          <code class="ruby">selectOneCancelOther() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="749">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper 1 &quot;$1&quot; &#39;&lt;cancel&gt;&#39; &#39;&lt;other&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="750">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="751">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="752">
          <span class="hits">14</span>
          
          <code class="ruby">selectOneCancelNew() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="753">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper 1 &quot;$1&quot; &#39;&lt;cancel&gt;&#39; &#39;&lt;new&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="754">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="755">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="756">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancel() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="757">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="758">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="759">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="760">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelOther() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="761">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;other&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="762">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="763">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="764">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelNew() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="765">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;new&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="766">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="767">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="768">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelAllOther() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="769">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;all&gt;&#39;$&#39;\n&#39;&#39;&lt;other&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="770">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="771">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="772">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelAllNew() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="773">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;all&gt;&#39;$&#39;\n&#39;&#39;&lt;new&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="774">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="775">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="776">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelAnyOther() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="777">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;any&gt;&#39;$&#39;\n&#39;&#39;&lt;other&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="778">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="779">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="780">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelAnyNew() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="781">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;any&gt;&#39;$&#39;\n&#39;&#39;&lt;new&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="782">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="783">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="784">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelOtherDefault() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="785">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$SELECT_DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="786">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;Requested &#39;default&#39; select, but no default provided. Falling back to non-default selection.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="787">
          <span class="hits">14</span>
          
          <code class="ruby">    selectDoneCancelOther &quot;$1&quot; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="788">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="789">
          <span class="hits">14</span>
          
          <code class="ruby">    _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;other&gt;&#39;$&#39;\n&#39;&#39;&lt;default&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="790">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="791">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="792">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="793">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelNewDefault() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="794">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$SELECT_DEFAULT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="795">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;Requested &#39;default&#39; select, but no default provided. Falling back to non-default selection.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="796">
          <span class="hits">14</span>
          
          <code class="ruby">    selectDoneCancelOther &quot;$1&quot; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="797">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="798">
          <span class="hits">14</span>
          
          <code class="ruby">    _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;new&gt;&#39;$&#39;\n&#39;&#39;&lt;default&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="799">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="800">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="801">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="802">
          <span class="hits">14</span>
          
          <code class="ruby">selectDoneCancelAll() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="803">
          <span class="hits">14</span>
          
          <code class="ruby">  _commonSelectHelper &#39;&#39; &quot;$1&quot; &#39;&lt;done&gt;&#39;$&#39;\n&#39;&#39;&lt;cancel&gt;&#39; &#39;&lt;all&gt;&#39; &quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="804">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="805">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: move to bash-toolkit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="806">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="807">
          <span class="hits">14</span>
          
          <code class="ruby"># Prints line with any standard format. First arg is the format name, everything else, along with any options, are</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="808">
          <span class="hits">14</span>
          
          <code class="ruby"># passed through to echo.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="809">
          <span class="hits">14</span>
          
          <code class="ruby">echofmt() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="810">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_NEWLINE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="811">
          <span class="hits">14</span>
          
          <code class="ruby">  local COLOR=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="812">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${!COLOR}&quot; ]]</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="813">
          <span class="hits">14</span>
          
          <code class="ruby">  OPTS=&quot;-e&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="814">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$NO_NEWLINE&quot; ]]; then OPTS=&quot;$OPTS -n&quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="815">
          <span class="hits">14</span>
          
          <code class="ruby">  echo ${OPTS} &quot;${!COLOR}$*${reset}&quot; | fold -sw 82</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="816">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="817">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="818">
          <span class="hits">14</span>
          
          <code class="ruby"># Prints the line in green. Any options are passed through to echo.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="819">
          <span class="hits">14</span>
          
          <code class="ruby">echogreen() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="820">
          <span class="hits">14</span>
          
          <code class="ruby">  echofmt green &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="821">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="822">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="823">
          <span class="hits">14</span>
          
          <code class="ruby"># Basic indent of a line.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="824">
          <span class="hits">14</span>
          
          <code class="ruby">indent() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="825">
          <span class="hits">2</span>
          
          <code class="ruby">  cat | sed -e &#39;s/^/  /&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="826">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="827">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="828">
          <span class="hits">14</span>
          
          <code class="ruby"># Folds the summary with a hanging indent.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="829">
          <span class="hits">14</span>
          
          <code class="ruby">_help-func-summary() {</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="830">
          <span class="hits">8</span>
          
          <code class="ruby">  local FUNC_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="831">
          <span class="hits">8</span>
          
          <code class="ruby">  local OPTIONS=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="832">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="833">
          <span class="hits">8</span>
          
          <code class="ruby">  local STD_FOLD=82</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="834">
          <span class="hits">8</span>
          
          <code class="ruby">  local WIDTH</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="835">
          <span class="hits">8</span>
          
          <code class="ruby">  WIDTH=$(( $STD_FOLD - 2 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="836">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="837">
          <span class="hits">14</span>
          
          <code class="ruby">  (</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="838">
          <span class="hits">14</span>
          
          <code class="ruby">    # echo -n &quot;${underline}${yellow}${FUNC_NAME}${reset} &quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="839">
          <span class="hits">8</span>
          
          <code class="ruby">    echo -n &quot;${FUNC_NAME} &quot;</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="840">
          <span class="hits">15</span>
          
          <code class="ruby">    [[ -z &quot;$OPTIONS&quot; ]] || echo -n &quot;${OPTIONS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="841">
          <span class="hits">8</span>
          
          <code class="ruby">    echo -n &quot;: &quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="842">
          <span class="hits">8</span>
          
          <code class="ruby">    cat</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="843">
          <span class="hits">16</span>
          
          <code class="ruby">  ) | fold -sw $WIDTH | sed -E \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="844">
          <span class="hits">14</span>
          
          <code class="ruby">    -e &quot;1 s/^([[:alpha:]-]+) /\\1 ${green}/&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="845">
          <span class="hits">14</span>
          
          <code class="ruby">    -e &quot;1,/:/ s/:/${reset}:/&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="846">
          <span class="hits">14</span>
          
          <code class="ruby">    -e &quot;1 s/^([[:alpha:]-]+)/${yellow}${underline}\\1${reset}/&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="847">
          <span class="hits">14</span>
          
          <code class="ruby">    -e &#39;2,$s/^/  /&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="848">
          <span class="hits">14</span>
          
          <code class="ruby">    # We fold, then color because fold sees the control characters as just plain characters, so it throws the fold off.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="849">
          <span class="hits">14</span>
          
          <code class="ruby">    # The non-printing characters are only really understood as such by the terminal and individual programs that</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="850">
          <span class="hits">14</span>
          
          <code class="ruby">    # support it (which fold should, but, as this is written, doesn&#39;t).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="851">
          <span class="hits">14</span>
          
          <code class="ruby">    # 1 &amp; 2) make options green</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="852">
          <span class="hits">14</span>
          
          <code class="ruby">    # 3) yellow underline function name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="853">
          <span class="hits">14</span>
          
          <code class="ruby">    # 4) add hanging indent</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="854">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="855">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="856">
          <span class="hits">14</span>
          
          <code class="ruby"># Prints and indents the help for each action</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="857">
          <span class="hits">14</span>
          
          <code class="ruby">_help-actions-list() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="858">
          <span class="hits">2</span>
          
          <code class="ruby">  local GROUP=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="859">
          <span class="hits">1</span>
          
          <code class="ruby">  local ACTION</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="860">
          <span class="hits">8</span>
          
          <code class="ruby">  for ACTION in &quot;$@&quot;; do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="861">
          <span class="hits">8</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="862">
          <span class="hits">8</span>
          
          <code class="ruby">    help-$GROUP-$ACTION -i</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="863">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="864">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="865">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="866">
          <span class="hits">14</span>
          
          <code class="ruby">_help-sub-group-list() {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="867">
          <span class="hits">1</span>
          
          <code class="ruby">  local PREFIX=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="868">
          <span class="hits">1</span>
          
          <code class="ruby">  local GROUPS_VAR=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="869">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="870">
          <span class="hits">1</span>
          
          <code class="ruby">  if [[ -n &quot;${!GROUPS_VAR}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="871">
          <span class="hits">14</span>
          
          <code class="ruby">    local SG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="872">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$( {  echo -e &quot;\n${bold}Sub-groups${reset}:&quot;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="873">
          <span class="hits">14</span>
          
          <code class="ruby">                for SG in ${!GROUPS_VAR}; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="874">
          <span class="hits">14</span>
          
          <code class="ruby">                  echo &quot;* $( SUMMARY_ONLY=true; help-${PREFIX}-${SG} )&quot;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="875">
          <span class="hits">14</span>
          
          <code class="ruby">                done; } | indent)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="876">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="877">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="878">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="879">
          <span class="hits">14</span>
          
          <code class="ruby">helpActionPrefix() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="880">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${INDENT:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="881">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -n &quot;liq $1 &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="882">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="883">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="884">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="885">
          <span class="hits">14</span>
          
          <code class="ruby">colorerr() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="886">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: in the case of long output, it would be nice to notice whether we saw</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="887">
          <span class="hits">14</span>
          
          <code class="ruby">  # error or not and tell the user to scroll back and check the logs. e.g., if</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="888">
          <span class="hits">14</span>
          
          <code class="ruby">  # we see an error and then 20+ lines of stuff, then emit advice.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="889">
          <span class="hits">14</span>
          
          <code class="ruby">  (eval &quot;$@ 2&gt; &gt;(echo -n \&quot;${red}\&quot;; cat -; tput sgr0)&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="890">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="891">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="892">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: is this better? We switched to it for awhile, but there were problems.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="893">
          <span class="hits">14</span>
          
          <code class="ruby"># The reasons for both the initial switch and the switchback are now obscured</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="894">
          <span class="hits">14</span>
          
          <code class="ruby"># but may have been due to failure of the original code to exit with the</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="895">
          <span class="hits">14</span>
          
          <code class="ruby"># underling error status from the eval, which has since been fixed. The</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="896">
          <span class="hits">14</span>
          
          <code class="ruby"># switchback was, in part, because of problems with syncronous calls. Of course,</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="897">
          <span class="hits">14</span>
          
          <code class="ruby"># it didn&#39;t wait as we would like, but it was also causing functional problems</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="898">
          <span class="hits">14</span>
          
          <code class="ruby"># with... somethnig.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="899">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: We are currently not using colorerrbg anywhere.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="900">
          <span class="hits">14</span>
          
          <code class="ruby">colorerrbg() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="901">
          <span class="hits">14</span>
          
          <code class="ruby">  (eval &quot;$@&quot; 2&gt;&amp;1&gt;&amp;3|sed &#39;s/^\(.*\)$/&#39;$&#39;\e&#39;&#39;[31m\1&#39;$&#39;\e&#39;&#39;[m/&#39;&gt;&amp;2)3&gt;&amp;1 &amp;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="902">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="903">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="904">
          <span class="hits">14</span>
          
          <code class="ruby"># Verifies access to github.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="905">
          <span class="hits">14</span>
          
          <code class="ruby">check-git-access() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="906">
          <span class="hits">14</span>
          
          <code class="ruby">  # if we don&#39;t supress the output, then we get noise even when successful</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="907">
          <span class="hits">14</span>
          
          <code class="ruby">  ssh -qT git@github.com 2&gt; /dev/null || if [ $? -ne 1 ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="908">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Could not connect to github; try to add add your GitHub key like:\nssh-add /example/path/to/key&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="909">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="910">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="911">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="912">
          <span class="hits">14</span>
          
          <code class="ruby">change-working-project() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="913">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$PROJECT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="914">
          <span class="hits">14</span>
          
          <code class="ruby">    if ! [[ -d &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="915">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;No such project &#39;${PROJECT}&#39; found locally.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="916">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="917">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="918">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="919">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="920">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="921">
          <span class="hits">14</span>
          
          <code class="ruby">findFile() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="922">
          <span class="hits">14</span>
          
          <code class="ruby">  local SEARCH_DIR=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="923">
          <span class="hits">14</span>
          
          <code class="ruby">  local FILE_NAME=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="924">
          <span class="hits">14</span>
          
          <code class="ruby">  local RES_VAR=&quot;${3}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="925">
          <span class="hits">14</span>
          
          <code class="ruby">  local FOUND_FILE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="926">
          <span class="hits">14</span>
          
          <code class="ruby">  local START_DIR=&quot;$SEARCH_DIR&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="927">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="928">
          <span class="hits">14</span>
          
          <code class="ruby">  while SEARCH_DIR=&quot;$(cd &quot;$SEARCH_DIR&quot;; echo $PWD)&quot; &amp;&amp; [[ &quot;${SEARCH_DIR}&quot; != &quot;/&quot; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="929">
          <span class="hits">14</span>
          
          <code class="ruby">    FOUND_FILE=`find -L &quot;$SEARCH_DIR&quot; -maxdepth 1 -mindepth 1 -name &quot;${FILE_NAME}&quot; -type f | grep &quot;${FILE_NAME}&quot; || true`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="930">
          <span class="hits">14</span>
          
          <code class="ruby">    if [ -z &quot;$FOUND_FILE&quot; ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="931">
          <span class="hits">14</span>
          
          <code class="ruby">      SEARCH_DIR=&quot;$SEARCH_DIR/..&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="932">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="933">
          <span class="hits">14</span>
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="934">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="935">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="936">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="937">
          <span class="hits">14</span>
          
          <code class="ruby">  if [ -z &quot;$FOUND_FILE&quot; ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="938">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &quot;Could not find &#39;${FILE_NAME}&#39; in &#39;$START_DIR&#39; or any parent directory.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="939">
          <span class="hits">14</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="940">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="941">
          <span class="hits">14</span>
          
          <code class="ruby">    eval $RES_VAR=&quot;$FOUND_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="942">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="943">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="944">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="945">
          <span class="hits">14</span>
          
          <code class="ruby">findBase() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="946">
          <span class="hits">14</span>
          
          <code class="ruby">  findFile &quot;${PWD}&quot; package.json PACKAGE_FILE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="947">
          <span class="hits">14</span>
          
          <code class="ruby">  BASE_DIR=&quot;$( cd &quot;$( dirname &quot;${PACKAGE_FILE}&quot; )&quot; &amp;&amp; pwd )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="948">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="949">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="950">
          <span class="hits">14</span>
          
          <code class="ruby">sourceFile() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="951">
          <span class="hits">14</span>
          
          <code class="ruby">  local SEARCH_DIR=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="952">
          <span class="hits">14</span>
          
          <code class="ruby">  local FILE_NAME=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="953">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJFILE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="954">
          <span class="hits">14</span>
          
          <code class="ruby">  findFile &quot;$SEARCH_DIR&quot; &quot;$FILE_NAME&quot; PROJFILE &amp;&amp; {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="955">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;$PROJFILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="956">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: this works (at time of note) because all the files we currently source are in the root, but it&#39;s a bit odd and should be reworked.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="957">
          <span class="hits">14</span>
          
          <code class="ruby">    BASE_DIR=&quot;$( cd &quot;$( dirname &quot;${PROJFILE}&quot; )&quot; &amp;&amp; pwd )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="958">
          <span class="hits">14</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="959">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="960">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="961">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="962">
          <span class="hits">14</span>
          
          <code class="ruby">sourceCatalystfile() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="963">
          <span class="hits">14</span>
          
          <code class="ruby">  sourceFile &quot;${PWD}&quot; &#39;.catalyst&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="964">
          <span class="hits">14</span>
          
          <code class="ruby">  return $? # TODO: is this how this works in bash?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="965">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="966">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="967">
          <span class="hits">14</span>
          
          <code class="ruby">requireCatalystfile() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="968">
          <span class="hits">14</span>
          
          <code class="ruby">  sourceCatalystfile \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="969">
          <span class="hits">14</span>
          
          <code class="ruby">    || echoerrandexit &quot;Run &#39;liq projects init&#39; from project root.&quot; 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="970">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="971">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="972">
          <span class="hits">14</span>
          
          <code class="ruby">requireNpmPackage() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="973">
          <span class="hits">14</span>
          
          <code class="ruby">  findFile &quot;${BASE_DIR}&quot; &#39;package.json&#39; PACKAGE_FILE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="974">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="975">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="976">
          <span class="hits">14</span>
          
          <code class="ruby">sourceWorkspaceConfig() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="977">
          <span class="hits">14</span>
          
          <code class="ruby">  sourceFile &quot;${PWD}&quot; &quot;${_WORKSPACE_CONFIG}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="978">
          <span class="hits">14</span>
          
          <code class="ruby">  return $? # TODO: is this how this works in bash?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="979">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="980">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="981">
          <span class="hits">14</span>
          
          <code class="ruby">requirePackage() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="982">
          <span class="hits">14</span>
          
          <code class="ruby">  requireNpmPackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="983">
          <span class="hits">14</span>
          
          <code class="ruby">  PACKAGE=&quot;$(cat $PACKAGE_FILE)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="984">
          <span class="hits">14</span>
          
          <code class="ruby">  PACKAGE_NAME=&quot;$(echo &quot;$PACKAGE&quot; | jq --raw-output &quot;.name&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="985">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="986">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="987">
          <span class="hits">14</span>
          
          <code class="ruby">requireEnvironment() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="988">
          <span class="hits">14</span>
          
          <code class="ruby">  requireCatalystfile</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="989">
          <span class="hits">14</span>
          
          <code class="ruby">  requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="990">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_ENV_FILE=&quot;${LIQ_ENV_DB}/${PACKAGE_NAME}/curr_env&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="991">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -L &quot;$CURR_ENV_FILE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="992">
          <span class="hits">14</span>
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="993">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No environment currently selected.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="994">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="995">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_ENV=`readlink &quot;${CURR_ENV_FILE}&quot; | xargs basename`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="996">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="997">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="998">
          <span class="hits">14</span>
          
          <code class="ruby">addLineIfNotPresentInFile() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="999">
          <span class="hits">14</span>
          
          <code class="ruby">  local FILE=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1000">
          <span class="hits">14</span>
          
          <code class="ruby">  local LINE=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1001">
          <span class="hits">14</span>
          
          <code class="ruby">  touch &quot;$FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1002">
          <span class="hits">14</span>
          
          <code class="ruby">  grep &quot;$LINE&quot; &quot;$FILE&quot; &gt; /dev/null || echo &quot;$LINE&quot; &gt;&gt; &quot;$FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1003">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1004">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1005">
          <span class="hits">14</span>
          
          <code class="ruby">requireArgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1006">
          <span class="hits">14</span>
          
          <code class="ruby">  local COUNT=$#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1007">
          <span class="hits">14</span>
          
          <code class="ruby">  local I=1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1008">
          <span class="hits">14</span>
          
          <code class="ruby">  while (( $I &lt;= $COUNT )); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1009">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z ${!I:-} ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1010">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z $ACTION ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1011">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;Global action &#39;$COMPONENT&#39; requires $COUNT additional arguments.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1012">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1013">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;&#39;$COMPONENT $ACTION&#39; requires $COUNT additional arguments.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1014">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1015">
          <span class="hits">14</span>
          
          <code class="ruby">      # TODO: as &#39;requireArgs&#39; this should straight up exit.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1016">
          <span class="hits">14</span>
          
          <code class="ruby">      return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1017">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1018">
          <span class="hits">14</span>
          
          <code class="ruby">    I=$(( I + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1019">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1020">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1021">
          <span class="hits">14</span>
          
          <code class="ruby">  return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1022">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1023">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1024">
          <span class="hits">14</span>
          
          <code class="ruby">contextHelp() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1025">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: this is a bit of a workaround until all the ACTION helps are broken</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1026">
          <span class="hits">14</span>
          
          <code class="ruby">  # out into ther own function.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1027">
          <span class="hits">14</span>
          
          <code class="ruby">  if type -t help-${GROUP}-${ACTION} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1028">
          <span class="hits">14</span>
          
          <code class="ruby">    help-${GROUP}-${ACTION}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1029">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1030">
          <span class="hits">14</span>
          
          <code class="ruby">    help-${GROUP}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1031">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1032">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1033">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1034">
          <span class="hits">14</span>
          
          <code class="ruby">exactUserArgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1035">
          <span class="hits">14</span>
          
          <code class="ruby">  local REQUIRED_ARGS=()</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1036">
          <span class="hits">14</span>
          
          <code class="ruby">  while true; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1037">
          <span class="hits">14</span>
          
          <code class="ruby">    case &quot;$1&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1038">
          <span class="hits">14</span>
          
          <code class="ruby">      --)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1039">
          <span class="hits">14</span>
          
          <code class="ruby">        break;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1040">
          <span class="hits">14</span>
          
          <code class="ruby">      *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1041">
          <span class="hits">14</span>
          
          <code class="ruby">        REQUIRED_ARGS+=(&quot;$1&quot;);;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1042">
          <span class="hits">14</span>
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1043">
          <span class="hits">14</span>
          
          <code class="ruby">    shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1044">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1045">
          <span class="hits">14</span>
          
          <code class="ruby">  shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1046">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1047">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# &lt; ${#REQUIRED_ARGS[@]} )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1048">
          <span class="hits">14</span>
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1049">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Insufficient number of arguments.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1050">
          <span class="hits">14</span>
          
          <code class="ruby">  elif (( $# &gt; ${#REQUIRED_ARGS[@]} )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1051">
          <span class="hits">14</span>
          
          <code class="ruby">    contextHelp</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1052">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Found extra arguments.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1053">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1054">
          <span class="hits">14</span>
          
          <code class="ruby">    local I=0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1055">
          <span class="hits">14</span>
          
          <code class="ruby">    while (( $# &gt; 0 )); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1056">
          <span class="hits">14</span>
          
          <code class="ruby">      eval &quot;${REQUIRED_ARGS[$I]}=&#39;$1&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1057">
          <span class="hits">14</span>
          
          <code class="ruby">      shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1058">
          <span class="hits">14</span>
          
          <code class="ruby">      I=$(( $I + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1059">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1060">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1061">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1062">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1063">
          <span class="hits">14</span>
          
          <code class="ruby">requireGlobals() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1064">
          <span class="hits">14</span>
          
          <code class="ruby">  local COUNT=$#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1065">
          <span class="hits">14</span>
          
          <code class="ruby">  local I=1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1066">
          <span class="hits">14</span>
          
          <code class="ruby">  while (( $I &lt;= $COUNT )); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1067">
          <span class="hits">14</span>
          
          <code class="ruby">    local GLOBAL_NAME=${!I}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1068">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z ${!GLOBAL_NAME:-} ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1069">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerr &quot;&#39;${GLOBAL_NAME}&#39; not set. Try:\nliq ${COMPONENT} configure&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1070">
          <span class="hits">14</span>
          
          <code class="ruby">      exit 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1071">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1072">
          <span class="hits">14</span>
          
          <code class="ruby">    I=$(( I + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1073">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1074">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1075">
          <span class="hits">14</span>
          
          <code class="ruby">  return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1076">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1077">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1078">
          <span class="hits">14</span>
          
          <code class="ruby">loadCurrEnv() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1079">
          <span class="hits">14</span>
          
          <code class="ruby">  resetEnv() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1080">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_ENV=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1081">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_ENV_TYPE=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1082">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_ENV_PURPOSE=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1083">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1084">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1085">
          <span class="hits">14</span>
          
          <code class="ruby">  local PACKAGE_NAME=`cat $BASE_DIR/package.json | jq --raw-output &quot;.name&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1086">
          <span class="hits">14</span>
          
          <code class="ruby">  local CURR_ENV_FILE=&quot;${LIQ_ENV_DB}/${PACKAGE_NAME}/curr_env&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1087">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1088">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -f &quot;${CURR_ENV_FILE}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1089">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;$CURR_ENV_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1090">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1091">
          <span class="hits">14</span>
          
          <code class="ruby">    resetEnv</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1092">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1093">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1094">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1095">
          <span class="hits">14</span>
          
          <code class="ruby">getPackageDef() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1096">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR_NAME=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1097">
          <span class="hits">14</span>
          
          <code class="ruby">  local FQN_PACKAGE_NAME=&quot;${2:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1098">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1099">
          <span class="hits">14</span>
          
          <code class="ruby">  # The project we&#39;re looking at might be our own or might be a dependency.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1100">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$FQN_PACKAGE_NAME&quot; ]] || [[ &quot;$FQN_PACKAGE_NAME&quot; == &quot;$PACKAGE_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1101">
          <span class="hits">14</span>
          
          <code class="ruby">    eval &quot;$VAR_NAME=\&quot;\$PACKAGE\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1102">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1103">
          <span class="hits">14</span>
          
          <code class="ruby">    eval &quot;$VAR_NAME=\$(npm explore \&quot;$FQN_PACKAGE_NAME\&quot; -- cat package.json)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1104">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1105">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1106">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1107">
          <span class="hits">14</span>
          
          <code class="ruby">getProvidedServiceValues() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1108">
          <span class="hits">14</span>
          
          <code class="ruby">  local SERV_KEY=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1109">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELD_LABEL=&quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1110">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1111">
          <span class="hits">14</span>
          
          <code class="ruby">  local SERV_PACKAGE SERV_NAME SERV</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1112">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$SERV_KEY&quot; ]];then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1113">
          <span class="hits">14</span>
          
          <code class="ruby">    # local SERV_IFACE=`echo &quot;$SERV_KEY&quot; | cut -d: -f1`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1114">
          <span class="hits">14</span>
          
          <code class="ruby">    local SERV_PACKAGE_NAME=`echo &quot;$SERV_KEY&quot; | cut -d: -f2`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1115">
          <span class="hits">14</span>
          
          <code class="ruby">    SERV_NAME=`echo &quot;$SERV_KEY&quot; | cut -d: -f3`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1116">
          <span class="hits">14</span>
          
          <code class="ruby">    getPackageDef SERV_PACKAGE &quot;$SERV_PACKAGE_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1117">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1118">
          <span class="hits">14</span>
          
          <code class="ruby">    SERV_PACKAGE=&quot;$PACKAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1119">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1120">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1121">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$SERV_PACKAGE&quot; | jq --raw-output &quot;.catalyst.provides | .[] | select(.name == \&quot;$SERV_NAME\&quot;) | .\&quot;${FIELD_LABEL}\&quot; | @sh&quot; | tr -d &quot;&#39;&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1122">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( ( [[ -n $SERV_PACKAGE_NAME ]] &amp;&amp; echoerrandexit &quot;$SERV_PACKAGE_NAME package.json does not define .catalyst.provides[${SERV_NAME}].&quot; ) || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1123">
          <span class="hits">14</span>
          
          <code class="ruby">         echoerrandexit &quot;Local package.json does not define .catalyst.provides[${SERV_NAME}].&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1124">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1125">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1126">
          <span class="hits">14</span>
          
          <code class="ruby">getRequiredParameters() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1127">
          <span class="hits">14</span>
          
          <code class="ruby">  getProvidedServiceValues &quot;${1:-}&quot; &quot;params-req&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1128">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1129">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1130">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: this is not like the others; it should take an optional package name, and the others should work with package names, not service specs. I.e., decompose externally.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1131">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: Or maybe not. Have a set of &quot;objective&quot; service key manipulators to build from and extract parts?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1132">
          <span class="hits">14</span>
          
          <code class="ruby">getConfigConstants() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1133">
          <span class="hits">14</span>
          
          <code class="ruby">  local SERV_IFACE=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1134">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; | jq --raw-output &quot;.catalyst.requires | .[] | select(.iface==\&quot;$SERV_IFACE\&quot;) | .\&quot;config-const\&quot; | keys | @sh&quot; | tr -d &quot;&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1135">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1136">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1137">
          <span class="hits">14</span>
          
          <code class="ruby">getCtrlScripts() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1138">
          <span class="hits">14</span>
          
          <code class="ruby">  getProvidedServiceValues &quot;${1:-}&quot; &quot;ctrl-scripts&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1139">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1140">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1141">
          <span class="hits">14</span>
          
          <code class="ruby">pressAnyKeyToContinue() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1142">
          <span class="hits">14</span>
          
          <code class="ruby">  read -n 1 -s -r -p &quot;Press any key to continue...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1143">
          <span class="hits">14</span>
          
          <code class="ruby">  echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1144">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1145">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1146">
          <span class="hits">14</span>
          
          <code class="ruby">getCatPackagePaths() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1147">
          <span class="hits">14</span>
          
          <code class="ruby">  local NPM_ROOT=`npm root`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1148">
          <span class="hits">14</span>
          
          <code class="ruby">  local CAT_PACKAGE_PATHS=`find -L &quot;$NPM_ROOT&quot;/\@* -maxdepth 2 -name &quot;.catalyst&quot; -not -path &quot;*.prelink/*&quot; -exec dirname {} \;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1149">
          <span class="hits">14</span>
          
          <code class="ruby">  CAT_PACKAGE_PATHS=&quot;${CAT_PACKAGE_PATHS} &quot;`find -L &quot;$NPM_ROOT&quot; -maxdepth 2 -name &quot;.catalyst&quot; -not -path &quot;*.prelink/*&quot; -exec dirname {} \;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1150">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1151">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$CAT_PACKAGE_PATHS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1152">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1153">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1154">
          <span class="hits">14</span>
          
          <code class="ruby"># Takes a project name and checks that the local repo is clean. By specifyng &#39;--check-branch&#39; (which will take a comma</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1155">
          <span class="hits">14</span>
          
          <code class="ruby"># separated list of branch names) or &#39;--check-all-branches&#39;, the function will also check that the current head of each</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1156">
          <span class="hits">14</span>
          
          <code class="ruby"># branch is present in the remote repo. The branch checks do not include a &#39;fetch&#39;, so local information may be out of</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1157">
          <span class="hits">14</span>
          
          <code class="ruby"># date.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1158">
          <span class="hits">14</span>
          
          <code class="ruby">requireCleanRepo() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1159">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions CHECK_BRANCH= CHECK_ALL_BRANCHES -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1160">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1161">
          <span class="hits">14</span>
          
          <code class="ruby">  local _IP=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1162">
          <span class="hits">14</span>
          
          <code class="ruby">  _IP=&quot;${_IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1163">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: the &#39;_WORK_BRANCH&#39; here seem to be more of a check than a command to check that branch.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1164">
          <span class="hits">14</span>
          
          <code class="ruby">  _IP=${_IP/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1165">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1166">
          <span class="hits">14</span>
          
          <code class="ruby">  local BRANCHES_TO_CHECK</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1167">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$CHECK_ALL_BRANCHES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1168">
          <span class="hits">14</span>
          
          <code class="ruby">    BRANCHES_TO_CHECK=&quot;$(git branch --list --format=&#39;%(refname:lstrip=-1)&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1169">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$CHECK_BRANCH&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1170">
          <span class="hits">14</span>
          
          <code class="ruby">    list-from-csv BRANCHES_TO_CHECK &quot;$CHECK_BRANCH&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1171">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1172">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1173">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${_IP}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1174">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1175">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Checking ${_IP}...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1176">
          <span class="hits">14</span>
          
          <code class="ruby">  # credit: https://stackoverflow.com/a/8830922/929494</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1177">
          <span class="hits">14</span>
          
          <code class="ruby">  # look for uncommitted changes</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1178">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! git diff --quiet || ! git diff --cached --quiet; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1179">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Found uncommitted changes.\n$(git status --porcelain)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1180">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1181">
          <span class="hits">14</span>
          
          <code class="ruby">  # check for untracked files</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1182">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $({ git status --porcelain 2&gt;/dev/null| grep &#39;^??&#39; || true; } | wc -l) != 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1183">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Found untracked files.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1184">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1185">
          <span class="hits">14</span>
          
          <code class="ruby">  # At this point, the local repo is clean. Now we look at any branches of interest to make sure they&#39;ve been pushed.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1186">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$BRANCHES_TO_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1187">
          <span class="hits">14</span>
          
          <code class="ruby">    local BRANCH_TO_CHECK</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1188">
          <span class="hits">14</span>
          
          <code class="ruby">    for BRANCH_TO_CHECK in $BRANCHES_TO_CHECK; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1189">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;$BRANCH_TO_CHECK&quot; == master ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1190">
          <span class="hits">14</span>
          
          <code class="ruby">         &amp;&amp; ! git merge-base --is-ancestor master upstream/master; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1191">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerrandexit &quot;Local master has not been pushed to upstream master.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1192">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1193">
          <span class="hits">14</span>
          
          <code class="ruby">      # if the repo was created without forking, then there&#39;s no separate workspace</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1194">
          <span class="hits">14</span>
          
          <code class="ruby">      if git remote | grep -e &#39;^workspace$&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1195">
          <span class="hits">14</span>
          
          <code class="ruby">          &amp;&amp; ! git merge-base --is-ancestor &quot;$BRANCH_TO_CHECK&quot; &quot;workspace/${BRANCH_TO_CHECK}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1196">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerrandexit &quot;Local branch &#39;$BRANCH_TO_CHECK&#39; has not been pushed to workspace.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1197">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1198">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1199">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1200">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1201">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1202">
          <span class="hits">14</span>
          
          <code class="ruby"># For each &#39;involved project&#39; in the indicated unit of work (default to current unit of work), checks that the repo is</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1203">
          <span class="hits">14</span>
          
          <code class="ruby"># clean.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1204">
          <span class="hits">14</span>
          
          <code class="ruby">requireCleanRepos() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1205">
          <span class="hits">14</span>
          
          <code class="ruby">  local _WORK_NAME=&quot;${1:-curr_work}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1206">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1207">
          <span class="hits">14</span>
          
          <code class="ruby">  ( # isolate the source</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1208">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/${_WORK_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1209">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1210">
          <span class="hits">14</span>
          
          <code class="ruby">    local IP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1211">
          <span class="hits">14</span>
          
          <code class="ruby">    for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1212">
          <span class="hits">14</span>
          
          <code class="ruby">      requireCleanRepo &quot;$IP&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1213">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1214">
          <span class="hits">14</span>
          
          <code class="ruby">  )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1215">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1216">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1217">
          <span class="hits">14</span>
          
          <code class="ruby">defineParameters() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1218">
          <span class="hits">14</span>
          
          <code class="ruby">  local SERVICE_DEF_VAR=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1219">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1220">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Enter required parameters. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1221">
          <span class="hits">14</span>
          
          <code class="ruby">  local PARAM_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1222">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1223">
          <span class="hits">14</span>
          
          <code class="ruby">    read -p &quot;Required parameter: &quot; PARAM_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1224">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1225">
          <span class="hits">14</span>
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1226">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1227">
          <span class="hits">14</span>
          
          <code class="ruby">      eval $SERVICE_DEF_VAR&#39;=$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;params-req\&quot;: (.\&quot;params-req\&quot; + [\&quot;&#39;$PARAM_NAME&#39;\&quot;]) }&quot;)&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1228">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1229">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1230">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1231">
          <span class="hits">14</span>
          
          <code class="ruby">  PARAM_NAME=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1232">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Enter optional parameters. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1233">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1234">
          <span class="hits">14</span>
          
          <code class="ruby">    read -p &quot;Optional parameter: &quot; PARAM_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1235">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1236">
          <span class="hits">14</span>
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1237">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1238">
          <span class="hits">14</span>
          
          <code class="ruby">      eval $SERVICE_DEF_VAR=&#39;$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;params-opt\&quot;: (.\&quot;params-opt\&quot; + [\&quot;&#39;$PARAM_NAME&#39;\&quot;]) }&quot;)&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1239">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1240">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1241">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1242">
          <span class="hits">14</span>
          
          <code class="ruby">  PARAM_NAME=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1243">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Enter configuration constants. Enter blank line when done.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1244">
          <span class="hits">14</span>
          
          <code class="ruby">  while [[ $PARAM_NAME != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1245">
          <span class="hits">14</span>
          
          <code class="ruby">    read -p &quot;Configuration constant: &quot; PARAM_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1246">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$PARAM_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1247">
          <span class="hits">14</span>
          
          <code class="ruby">      PARAM_NAME=&#39;...quit...&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1248">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1249">
          <span class="hits">14</span>
          
          <code class="ruby">      local PARAM_VAL=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1250">
          <span class="hits">14</span>
          
          <code class="ruby">      require-answer &quot;Value: &quot; PARAM_VAL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1251">
          <span class="hits">14</span>
          
          <code class="ruby">      eval $SERVICE_DEF_VAR=&#39;$(echo &quot;$&#39;$SERVICE_DEF_VAR&#39;&quot; | jq &quot;. + { \&quot;config-const\&quot;: (.\&quot;config-const\&quot; + { \&quot;&#39;$PARAM_NAME&#39;\&quot; : \&quot;&#39;$PARAM_VAL&#39;\&quot; }) }&quot;)&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1252">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1253">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1254">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1255">
          <span class="hits">14</span>
          
          <code class="ruby"># Global constants.</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1256">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_NPM_KEY=&quot;liq&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1257">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_DB_BASENAME=&quot;.${LIQ_NPM_KEY}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1258">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_DB=&quot;${HOME}/${LIQ_DB_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1259">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_SETTINGS=&quot;${LIQ_DB}/settings.sh&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1260">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_ENV_DB=&quot;${LIQ_DB}/environments&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1261">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_ORG_DB=&quot;${LIQ_DB}/orgs&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1262">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_WORK_DB=&quot;${LIQ_DB}/work&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1263">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_EXTS_DB=&quot;${LIQ_DB}/exts&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1264">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_ENV_LOGS=&quot;${LIQ_DB}/logs&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1265">
          <span class="hits">8</span>
          
          <code class="ruby">LIQ_PLAYGROUND=&quot;${LIQ_DB}/playground&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1266">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="1267">
          <span class="hits">24</span>
          
          <code class="ruby">LIQ_DIST_DIR=&quot;$(dirname &quot;$(real_path &quot;${0}&quot;)&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1268">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1269">
          <span class="hits">8</span>
          
          <code class="ruby">_PROJECT_CONFIG=&#39;.catalyst-project&#39; #TODO: current file &#39;.catalyst&#39; and the code doesn&#39;t make reference to this constant; convert that to &#39;catalyst-project&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1270">
          <span class="hits">8</span>
          
          <code class="ruby">_PROJECT_PUB_CONFIG=&#39;.catalyst-pub&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1271">
          <span class="hits">8</span>
          
          <code class="ruby">_ORG_ID_URL=&#39;https://console.cloud.google.com/iam-admin/settings&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1272">
          <span class="hits">8</span>
          
          <code class="ruby">_BILLING_ACCT_URL=&#39;https://console.cloud.google.com/billing?folder=&amp;organizationId=&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1273">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1274">
          <span class="hits">14</span>
          
          <code class="ruby"># Global context variables.</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1275">
          <span class="hits">8</span>
          
          <code class="ruby">CURR_ENV_FILE=&#39;&#39; # set by &#39;requireEnvironment&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1276">
          <span class="hits">8</span>
          
          <code class="ruby">CURR_ENV=&#39;&#39; # set by &#39;requireEnvironment&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1277">
          <span class="hits">8</span>
          
          <code class="ruby">CURR_ORG=&#39;&#39; # set by post-options-liq-orgs</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1278">
          <span class="hits">8</span>
          
          <code class="ruby">CURR_ORG_PATH=&#39;&#39; # set by post-options-liq-orgs</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1279">
          <span class="hits">14</span>
          
          <code class="ruby"># &#39;requireEnvironment&#39; calls &#39;requirePackage&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1280">
          <span class="hits">8</span>
          
          <code class="ruby">PACKAGE=&#39;&#39; # set by &#39;requirePackage&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1281">
          <span class="hits">8</span>
          
          <code class="ruby">PACKAGE_NAME=&#39;&#39; # set by &#39;requirePackage&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1282">
          <span class="hits">8</span>
          
          <code class="ruby">PACKAGE_FILE=&#39;&#39; # set by &#39;requirePackage&#39;, &#39;requireNpmPackage&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1283">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1284">
          <span class="hits">8</span>
          
          <code class="ruby">BASE_DIR=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1285">
          <span class="hits">8</span>
          
          <code class="ruby">WORKSPACE_DIR=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1286">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1287">
          <span class="hits">8</span>
          
          <code class="ruby">COMPONENT=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1288">
          <span class="hits">8</span>
          
          <code class="ruby">ACTION=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1289">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1290">
          <span class="hits">8</span>
          
          <code class="ruby">INVOLVED_PROJECTS=&#39;&#39; # defined in the $LIQ_WORK_DB files</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1291">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1292">
          <span class="hits">14</span>
          
          <code class="ruby"># Configurable globals.</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1293">
          <span class="hits">8</span>
          
          <code class="ruby">ORIGIN_URL=&#39;&#39; # can be set externally to avoid interactive questions on &#39;project init&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1294">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1295">
          <span class="hits">8</span>
          
          <code class="ruby">STD_ENV_PURPOSES=dev$&#39;\n&#39;test$&#39;\n&#39;pre-production$&#39;\n&#39;production</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1296">
          <span class="hits">8</span>
          
          <code class="ruby">STD_IFACE_CLASSES=http$&#39;\n&#39;html$&#39;\n&#39;rest$&#39;\n&#39;sql</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1297">
          <span class="hits">8</span>
          
          <code class="ruby">STD_PLATFORM_TYPES=local$&#39;\n&#39;gcp$&#39;\n&#39;aws</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1298">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1299">
          <span class="hits">14</span>
          
          <code class="ruby"># Standard locations, relative to org repo.</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1300">
          <span class="hits">8</span>
          
          <code class="ruby">RECORDS_PATH=&quot;records&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1301">
          <span class="hits">8</span>
          
          <code class="ruby">AUDITS_PATH=&quot;${RECORDS_PATH}/audits&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1302">
          <span class="hits">8</span>
          
          <code class="ruby">AUDITS_ACTIVE_PATH=&quot;${AUDITS_PATH}/active&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1303">
          <span class="hits">8</span>
          
          <code class="ruby">AUDITS_COMPLETE_PATH=&quot;${AUDITS_PATH}/complete&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1304">
          <span class="hits">8</span>
          
          <code class="ruby">KEYS_PATH=&quot;${RECORDS_PATH}/keys&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1305">
          <span class="hits">8</span>
          
          <code class="ruby">KEYS_ACTIVE_PATH=&quot;${KEYS_PATH}/active&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1306">
          <span class="hits">8</span>
          
          <code class="ruby">KEYS_EXPIRED_PATH=&quot;${KEYS_PATH}/expired&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1307">
          <span class="hits">8</span>
          
          <code class="ruby">CATALYST_COMMAND_GROUPS=&quot;help meta meta-exts orgs projects work work-links&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1308">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1309">
          <span class="hits">14</span>
          
          <code class="ruby"># display help on help</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1310">
          <span class="hits">14</span>
          
          <code class="ruby">help-help() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1311">
          <span class="hits">14</span>
          
          <code class="ruby">  PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1312">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1313">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}help${reset} [&lt;group&gt; [&lt;sub-group|action&gt;...]]: Displays summary of groups or information on the specified topic.&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1314">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}help${reset} [--all|-a] [--summary-only|-s] [&lt;group&gt; [&lt;action&gt;]]:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1315">
          <span class="hits">14</span>
          
          <code class="ruby">  Displays liq help. With no arguments, defaults to a summary listing of the available groups. The &#39;--all&#39; option will print the full help for each group, even with no args. If a group or action is specified, then only help for that group and or group+action is displayed. In this case, &#39;--all&#39; is the default and &#39;--summary-only&#39; will cause a one-line summary to be displayed.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1316">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1317">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1318">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1319">
          <span class="hits">14</span>
          
          <code class="ruby"># Display help information. Takes zero or more arguments specifying the topic. A topic must be a liq command group,</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1320">
          <span class="hits">14</span>
          
          <code class="ruby"># sub-group, or command. Most of the work is done by deferring help functions for the specified topic.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1321">
          <span class="hits">14</span>
          
          <code class="ruby">help() {</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="1322">
          <span class="hits">4</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions ALL SUMMARY_ONLY -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1323">
          <span class="hits">1</span>
          
          <code class="ruby">    || { echoerr &quot;Bad options.&quot;; help-help; exit 1; }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1324">
          <span class="hits">1</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="1325">
          <span class="hits">3</span>
          
          <code class="ruby">  if (( $# == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="1326">
          <span class="hits">2</span>
          
          <code class="ruby">    # If displaying all, only display summary.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1327">
          <span class="hits">1</span>
          
          <code class="ruby">    if [[ -z &quot;$ALL&quot; ]]; then SUMMARY_ONLY=true; fi</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1328">
          <span class="hits">1</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1329">
          <span class="hits">1</span>
          
          <code class="ruby">    cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1330">
          <span class="hits">14</span>
          
          <code class="ruby">Usage:</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1331">
          <span class="hits">1</span>
          
          <code class="ruby">  liq &lt;resource/group&gt; &lt;action&gt; [...options...] [...selectors...]</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1332">
          <span class="hits">14</span>
          
          <code class="ruby">  liq ${cyan_u}help${reset} [&lt;group or resource&gt; [&lt;action&gt;]</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1333">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1334">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1335">
          <span class="hits">14</span>
          
          <code class="ruby">    # This bits is what generates the list of locally installed groups, and printing their info.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1336">
          <span class="hits">14</span>
          
          <code class="ruby">    local GROUP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1337">
          <span class="hits">14</span>
          
          <code class="ruby">    for GROUP in $CATALYST_COMMAND_GROUPS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1338">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1339">
          <span class="hits">14</span>
          
          <code class="ruby">      help-${GROUP}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1340">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1341">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="1342">
          <span class="hits">3</span>
          
          <code class="ruby">    if ! type -t help-${1} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1343">
          <span class="hits">1</span>
          
          <code class="ruby">      exitUnknownHelpTopic &quot;$1&quot; &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1344">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="1345">
          <span class="hits">2</span>
          
          <code class="ruby">    local HELP_SPEC=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1346">
          <span class="hits">1</span>
          
          <code class="ruby">    while (( $# &gt; 0)); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1347">
          <span class="hits">14</span>
          
          <code class="ruby">      if ! type -t help-${HELP_SPEC}-${1} | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1348">
          <span class="hits">14</span>
          
          <code class="ruby">        exitUnknownHelpTopic &quot;$1&quot; &quot;$HELP_SPEC&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1349">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1350">
          <span class="hits">14</span>
          
          <code class="ruby">      HELP_SPEC=&quot;${HELP_SPEC}-${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1351">
          <span class="hits">14</span>
          
          <code class="ruby">      shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1352">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1353">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1354">
          <span class="hits">1</span>
          
          <code class="ruby">    help-${HELP_SPEC} &quot;liq &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1355">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1356">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1357">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1358">
          <span class="hits">14</span>
          
          <code class="ruby">handleSummary() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="1359">
          <span class="hits">2</span>
          
          <code class="ruby">  local SUMMARY=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1360">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1361">
          <span class="hits">1</span>
          
          <code class="ruby">  if [[ -n &quot;${SUMMARY_ONLY:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1362">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$SUMMARY&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1363">
          <span class="hits">14</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1364">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1365">
          <span class="hits">1</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1366">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1367">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1368">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1369">
          <span class="hits">14</span>
          
          <code class="ruby"># display a helpful error message for invalid topics.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1370">
          <span class="hits">14</span>
          
          <code class="ruby">exitUnknownHelpTopic() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1371">
          <span class="hits">14</span>
          
          <code class="ruby">  local BAD_SPEC=&quot;${1:-}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1372">
          <span class="hits">14</span>
          
          <code class="ruby">  help $*</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1373">
          <span class="hits">14</span>
          
          <code class="ruby">  echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1374">
          <span class="hits">14</span>
          
          <code class="ruby">  echoerrandexit &quot;No such command or group: $BAD_SPEC&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1375">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1376">
          <span class="hits">14</span>
          
          <code class="ruby"># Echoes common options for all liq commands.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1377">
          <span class="hits">14</span>
          
          <code class="ruby">pre-options-liq() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1378">
          <span class="hits">14</span>
          
          <code class="ruby">  echo -n &quot;QUIET VERBOSE: DEBUG:&quot; # TODO: we don&#39;t actually support these yet; but wanted to preserve the idea.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1379">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1380">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1381">
          <span class="hits">14</span>
          
          <code class="ruby"># Processes common options for liq commands. Currently, all options are &quot;just&quot; flags that other functions will check, so</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1382">
          <span class="hits">14</span>
          
          <code class="ruby"># there&#39;s nothing for us to do here.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1383">
          <span class="hits">14</span>
          
          <code class="ruby">post-options-liq() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1384">
          <span class="hits">14</span>
          
          <code class="ruby">  :</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1385">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1386">
          <span class="hits">8</span>
          
          <code class="ruby">set -o errtrace # inherits trap on ERR in function and subshell</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1387">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1388">
          <span class="hits">8</span>
          
          <code class="ruby">trap &#39;traperror $? $LINENO $BASH_LINENO &quot;$BASH_COMMAND&quot; $(printf &quot;::%s&quot; ${FUNCNAME[@]:-})&#39; ERR</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1389">
          <span class="hits">14</span>
          
          <code class="ruby"># trap &#39;trapexit $? $LINENO&#39; EXIT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1390">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1391">
          <span class="hits">14</span>
          
          <code class="ruby">function trapexit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1392">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$(date) $(hostname) $0: EXIT on line $2 (exit status $1)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1393">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1394">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1395">
          <span class="hits">14</span>
          
          <code class="ruby">function traperror () {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1396">
          <span class="hits">14</span>
          
          <code class="ruby">    local err=$1 # error status</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1397">
          <span class="hits">14</span>
          
          <code class="ruby">    local line=$2 # LINENO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1398">
          <span class="hits">14</span>
          
          <code class="ruby">    local linecallfunc=$3</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1399">
          <span class="hits">14</span>
          
          <code class="ruby">    local command=&quot;$4&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1400">
          <span class="hits">14</span>
          
          <code class="ruby">    local funcstack=&quot;$5&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1401">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1402">
          <span class="hits">14</span>
          
          <code class="ruby">    # for a log use</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1403">
          <span class="hits">14</span>
          
          <code class="ruby">    # $(date) $(hostname) $0: ERROR &#39;$command&#39; failed at line $line - exited with status: $err&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1404">
          <span class="hits">14</span>
          
          <code class="ruby">    # for dev</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1405">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${red}ERROR &#39;$command&#39; failed at line $line - exited with status: $err${reset}&quot; &gt;&amp;2</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1406">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1407">
          <span class="hits">14</span>
          
          <code class="ruby">    if [ &quot;$funcstack&quot; != &quot;::&quot; ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1408">
          <span class="hits">14</span>
          
          <code class="ruby">      # if generating logs directly, the following is useful:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1409">
          <span class="hits">14</span>
          
          <code class="ruby">      # echo -n &quot;$(date) $(hostname) $0: DEBUG Error in ${funcstack} &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1410">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;$0: DEBUG Error in ${funcstack} &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1411">
          <span class="hits">14</span>
          
          <code class="ruby">      if [ &quot;$linecallfunc&quot; != &quot;&quot; ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1412">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;called at line $linecallfunc&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1413">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1414">
          <span class="hits">14</span>
          
          <code class="ruby">        echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1415">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1416">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1417">
          <span class="hits">14</span>
          
          <code class="ruby">    # echo &quot;&#39;$command&#39; failed at line $line - exited with status: $err&quot; | mail -s &quot;ERROR: $0 on $(hostname) at $(date)&quot; xxx@xxx.com</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1418">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1419">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1420">
          <span class="hits">14</span>
          
          <code class="ruby">function log() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1421">
          <span class="hits">14</span>
          
          <code class="ruby">    local msg=$1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1422">
          <span class="hits">14</span>
          
          <code class="ruby">    now=$(date)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1423">
          <span class="hits">14</span>
          
          <code class="ruby">    i=${#FUNCNAME[@]}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1424">
          <span class="hits">14</span>
          
          <code class="ruby">    lineno=${BASH_LINENO[$i-2]}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1425">
          <span class="hits">14</span>
          
          <code class="ruby">    file=${BASH_SOURCE[$i-1]}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1426">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${now} $(hostname) $0:${lineno} ${msg}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1427">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1428">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: share this with &#39;/install.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1429">
          <span class="hits">8</span>
          
          <code class="ruby">COMPLETION_PATH=&quot;/usr/local/etc/bash_completion.d&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1430">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1431">
          <span class="hits">14</span>
          
          <code class="ruby">requirements-meta() {</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1432">
          <span class="hits">7</span>
          
          <code class="ruby">  :</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1433">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1434">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1435">
          <span class="hits">14</span>
          
          <code class="ruby">meta-init() {</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="1436">
          <span class="hits">42</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_PLAYGROUND:P PLAYGROUND= SILENT -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1437">
          <span class="hits">7</span>
          
          <code class="ruby">    || { contextHelp; echoerrandexit &quot;Bad options.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1438">
          <span class="hits">7</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="1439">
          <span class="hits">25</span>
          
          <code class="ruby">  [[ -n &quot;${PLAYGROUND}&quot; ]] || PLAYGROUND=&quot;${HOME}/playground&quot;</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="1440">
          <span class="hits">22</span>
          
          <code class="ruby">  [[ &quot;${PLAYGROUND}&quot; == /* ]] || echoerrandexit &quot;Playground path must be absolute.&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1441">
          <span class="hits">7</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="1442">
          <span class="hits">18</span>
          
          <code class="ruby">  if [[ -n &quot;${SILENT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="1443">
          <span class="hits">12</span>
          
          <code class="ruby">    meta-lib-setup-liq-db &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1444">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="1445">
          <span class="hits">13</span>
          
          <code class="ruby">    meta-lib-setup-liq-db</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1446">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="1447">
          <span class="hits">2</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1448">
          <span class="hits">7</span>
          
          <code class="ruby">  if [[ -z &quot;${NO_PLAYGROUND}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1449">
          <span class="hits">5</span>
          
          <code class="ruby">    ln -s &quot;${LIQ_DB}/playground&quot; &quot;${PLAYGROUND}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1450">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="1451">
          <span class="hits">9</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="1452">
          <span class="hits">3</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="1453">
          <span class="hits">3</span>
          
          <code class="ruby">meta-bash-config() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1454">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;[ -d &#39;$COMPLETION_PATH&#39; ] &amp;&amp; . &#39;${COMPLETION_PATH}/liq&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1455">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1456">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1457">
          <span class="hits">14</span>
          
          <code class="ruby">meta-next() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1458">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions TECH_DETAIL ERROR -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1459">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1460">
          <span class="hits">7</span>
          
          <code class="ruby">  local COLOR=&quot;green&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="1461">
          <span class="hits">7</span>
          
          <code class="ruby">  [[ -z &quot;$ERROR&quot; ]] || COLOR=&quot;red&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1462">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1463">
          <span class="hits">14</span>
          
          <code class="ruby">  if [ ! -d &quot;${LIQ_DB}&quot; ]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1464">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -z &quot;$TECH_DETAIL&quot; ]] || TECH_DETAIL=&quot; (expected ~/${LIQ_DB_BASENAME})&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1465">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt $COLOR &quot;It looks like liq CLI hasn&#39;t been setup yet$TECH_DETAIL. Try:\nliq meta init&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1466">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1467">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1468">
          <span class="hits">14</span>
          
          <code class="ruby">    local PROJ DONE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1469">
          <span class="hits">14</span>
          
          <code class="ruby">    export DONE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1470">
          <span class="hits">14</span>
          
          <code class="ruby">    for PROJ in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1471">
          <span class="hits">14</span>
          
          <code class="ruby">      PROJ=${PROJ/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1472">
          <span class="hits">14</span>
          
          <code class="ruby">      cd &quot;$LIQ_PLAYGROUND/${PROJ}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1473">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -n &quot;$(git status --porcelain)&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1474">
          <span class="hits">14</span>
          
          <code class="ruby">        echofmt $COLOR &quot;It looks like you were worknig on &#39;${WORK_DESC}&#39; and have uncommitted changes in &#39;${PROJ}&#39;. Try:\n\nliq work save -m &#39;commit message&#39; --project $PROJ\n\nOr, to use &#39;liq work stage&#39; with &#39;liq work save&#39; to save sets of files with different messages.\n\nOr, to get an overview of all work status, try:\n\nliq work status.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1475">
          <span class="hits">14</span>
          
          <code class="ruby">        DONE=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1476">
          <span class="hits">14</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1477">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1478">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1479">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$DONE&quot; != &quot;true&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1480">
          <span class="hits">14</span>
          
          <code class="ruby">      echofmt $COLOR &quot;It looks like you were worknig on &#39;${WORK_DESC}&#39; and everything is committed. If ready to submit changes, try:\nliq work submit&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1481">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1482">
          <span class="hits">14</span>
          
          <code class="ruby">  elif requirePackage; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1483">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt $COLOR &quot;Looks like you&#39;re currently in project &#39;$PACKAGE_NAME&#39;. You could start working on an issue. Try:\nliq work start ...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1484">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1485">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt $COLOR &quot;Choose a project and &#39;cd&#39; there.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1486">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1487">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1488">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -z &quot;$ERROR&quot; ]] || exit 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1489">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1490">
          <span class="hits">8</span>
          
          <code class="ruby">META_GROUPS=&quot;exts&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1491">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1492">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1493">
          <span class="hits">14</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1494">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1495">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}meta${reset} &lt;action&gt;: Handles liq self-config and meta operations.&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1496">
          <span class="hits">14</span>
          
          <code class="ruby">   || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1497">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}meta${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1498">
          <span class="hits">14</span>
          
          <code class="ruby">  Manages local liq configurations and non-liq user resources.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1499">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list meta bash-config init next | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1500">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-sub-group-list meta META_GROUPS)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1501">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1502">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1503">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1504">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-bash-config() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1505">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary bash-config</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1506">
          <span class="hits">14</span>
          
          <code class="ruby">Prints bash configuration. Try:\neval &quot;\$(liq meta bash-config)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1507">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1508">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1509">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1510">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-init() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1511">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary init &quot;[--silent|-s] [--playground|-p &lt;absolute path&gt;] [--no-playground|-P]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1512">
          <span class="hits">14</span>
          
          <code class="ruby">Initialize the liq database in ~/.liq. By default, will expose the &quot;playground&quot; as ~/playground. The playground can be relocated with the &#39;--playground&#39; parameter. Alternatively, you can supress exposing the playground with the &#39;--no-playground&#39; option. In that case, ~/.liq/playground will still be created and used by liq, it just won&#39;t be &quot;exposed&quot; as a non-hidden link. If --no-playground is set, then --playground is ignored.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1513">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1514">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1515">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1516">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-next() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1517">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary next &quot;[--tech-detail|-t] [--error|-e]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1518">
          <span class="hits">14</span>
          
          <code class="ruby">Analyzes current state of play and suggests what to do next. &#39;--tech-detail&#39; may provide additional technical information for the curious or liq developers.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1519">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1520">
          <span class="hits">14</span>
          
          <code class="ruby">Regular users can ignore the &#39;--error&#39; option. It&#39;s an internal option allowing the &#39;next&#39; action to be leveraged to for error information and hints when appropriate.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1521">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1522">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1523">
          <span class="hits">14</span>
          
          <code class="ruby">meta-lib-setup-liq-db() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1524">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: check LIQ_PLAYGROUND is set</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1525">
          <span class="hits">14</span>
          
          <code class="ruby">  create-dir() {</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="1526">
          <span class="hits">31</span>
          
          <code class="ruby">    local DIR=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="1527">
          <span class="hits">31</span>
          
          <code class="ruby">    echo -n &quot;Creating local liq DB (&#39;${DIR}&#39;)... &quot;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="1528">
          <span class="hits">31</span>
          
          <code class="ruby">    mkdir -p &quot;$DIR&quot; \</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1529">
          <span class="hits">1</span>
          
          <code class="ruby">      || echoerrandexit &quot;Failed!\nError creating liq DB directory &#39;${DIR}&#39;.\nSee above for further details.&quot;</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="1530">
          <span class="hits">30</span>
          
          <code class="ruby">    echo &quot;${green}success${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1531">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="1532">
          <span class="hits">6</span>
          
          <code class="ruby">  create-dir &quot;$LIQ_DB&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1533">
          <span class="hits">5</span>
          
          <code class="ruby">  create-dir &quot;$LIQ_ENV_DB&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1534">
          <span class="hits">5</span>
          
          <code class="ruby">  create-dir &quot;$LIQ_WORK_DB&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1535">
          <span class="hits">5</span>
          
          <code class="ruby">  create-dir &quot;$LIQ_EXTS_DB&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1536">
          <span class="hits">5</span>
          
          <code class="ruby">  create-dir &quot;$LIQ_ENV_LOGS&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1537">
          <span class="hits">5</span>
          
          <code class="ruby">  create-dir &quot;${LIQ_PLAYGROUND}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1538">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1539">
          <span class="hits">5</span>
          
          <code class="ruby">  echo -n &quot;Initializing local liq DB settings... &quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1540">
          <span class="hits">5</span>
          
          <code class="ruby">  cat &lt;&lt;EOF &gt; &quot;${LIQ_DB}/settings.sh&quot; || echoerrandexit &quot;Failed!\nError creating local liq settings.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1541">
          <span class="hits">14</span>
          
          <code class="ruby">:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1542">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="1543">
          <span class="hits">5</span>
          
          <code class="ruby">  echo &quot;${green}success${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1544">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1545">
          <span class="hits">14</span>
          
          <code class="ruby">meta-exts() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1546">
          <span class="hits">14</span>
          
          <code class="ruby">  local ACTION=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1547">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1548">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $(type -t &quot;meta-exts-${ACTION}&quot; || echo &#39;&#39;) == &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1549">
          <span class="hits">14</span>
          
          <code class="ruby">    meta-exts-${ACTION} &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1550">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1551">
          <span class="hits">14</span>
          
          <code class="ruby">    exitUnknownHelpTopic &quot;$ACTION&quot; meta exts</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1552">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1553">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1554">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1555">
          <span class="hits">14</span>
          
          <code class="ruby">meta-exts-install() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1556">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions LOCAL REGISTRY -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1557">
          <span class="hits">14</span>
          
          <code class="ruby">    || { contextHelp; echoerrandexit &quot;Bad options.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1558">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1559">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$LOCAL&quot; ]] &amp;&amp; [[ -n &quot;$REGISTRY&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1560">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;The &#39;--local&#39; and &#39;--registry&#39; options are mutually exclusive.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1561">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1562">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1563">
          <span class="hits">14</span>
          
          <code class="ruby">  local PKGS=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1564">
          <span class="hits">14</span>
          
          <code class="ruby">  PKGS=&quot;${PKGS//@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1565">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_EXTS_DB}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1566">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1567">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -f &#39;exts.sh&#39; ]] || touch &#39;./exts.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1568">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1569">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;${LOCAL}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1570">
          <span class="hits">14</span>
          
          <code class="ruby">    npm i &quot;${LIQ_PLAYGROUND}/${PKGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1571">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1572">
          <span class="hits">14</span>
          
          <code class="ruby">    npm i &quot;@${PKGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1573">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1574">
          <span class="hits">14</span>
          
          <code class="ruby">  local PKG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1575">
          <span class="hits">14</span>
          
          <code class="ruby">  for PKG in ${PKGS//@/}; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1576">
          <span class="hits">14</span>
          
          <code class="ruby">    local PKG_DIR</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1577">
          <span class="hits">14</span>
          
          <code class="ruby">    PKG_DIR=&quot;$(npm explore @${PKG} -- pwd)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1578">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;source &#39;${PKG_DIR}/dist/ext.sh&#39;&quot; &gt;&gt; &#39;./exts.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1579">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;source &#39;${PKG_DIR}/dist/comp.sh&#39;&quot; &gt;&gt; &#39;./comps.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1580">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1581">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1582">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1583">
          <span class="hits">14</span>
          
          <code class="ruby">meta-exts-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1584">
          <span class="hits">14</span>
          
          <code class="ruby">  ! [[ -f &quot;${LIQ_EXTS_DB}/exts.sh&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1585">
          <span class="hits">14</span>
          
          <code class="ruby">    || cat &quot;${LIQ_EXTS_DB}/exts.sh&quot; | awk -F/ &#39;NF { print $(NF-3)&quot;/&quot;$(NF-2) }&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1586">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1587">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1588">
          <span class="hits">14</span>
          
          <code class="ruby">meta-exts-uninstall() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1589">
          <span class="hits">14</span>
          
          <code class="ruby">  local PKGS=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1590">
          <span class="hits">14</span>
          
          <code class="ruby">  PKGS=&quot;${PKGS//@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1591">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_EXTS_DB}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1592">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1593">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -f &#39;exts.sh&#39; ]] || touch &#39;./exts.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1594">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1595">
          <span class="hits">14</span>
          
          <code class="ruby">  # npm uninstall &quot;@${PKGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1596">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1597">
          <span class="hits">14</span>
          
          <code class="ruby">  local NEW_EXTS NEW_COMPS PKG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1598">
          <span class="hits">14</span>
          
          <code class="ruby">  NEW_EXTS=&quot;$(cat &#39;./exts.sh&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1599">
          <span class="hits">14</span>
          
          <code class="ruby">  NEW_COMPS=&quot;$(cat &#39;./comps.sh&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1600">
          <span class="hits">14</span>
          
          <code class="ruby">  for PKG in ${PKGS//@/}; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1601">
          <span class="hits">14</span>
          
          <code class="ruby">    NEW_EXTS=&quot;$(echo -n &quot;$NEW_EXTS&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1602">
          <span class="hits">14</span>
          
          <code class="ruby">      | { grep -Ev &quot;${PKG}/dist/ext.sh&#39;\$&quot; || echowarn &quot;No such extension found: &#39;${PKG}&#39;&quot;; })&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1603">
          <span class="hits">14</span>
          
          <code class="ruby">    NEW_COMPS=&quot;$(echo -n &quot;$NEW_COMPS&quot; | { grep -Ev &quot;${PKG}/dist/comp.sh&#39;\$&quot; || true; })&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1604">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1605">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1606">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$NEW_EXTS&quot; &gt; &#39;./exts.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1607">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$NEW_COMPS&quot; &gt; &#39;./comps.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1608">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1609">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: instead, create simple spec; generate &#39;completion&#39; options and &#39;docs&#39; from spec.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1610">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1611">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-exts() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1612">
          <span class="hits">14</span>
          
          <code class="ruby">  local SUMMARY=&quot;Manage liq extensions.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1613">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1614">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${cyan_u}meta exts${reset} &lt;action&gt;: ${SUMMARY}&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1615">
          <span class="hits">14</span>
          
          <code class="ruby">${cyan_u}meta exts${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1616">
          <span class="hits">14</span>
          
          <code class="ruby">  ${SUMMARY}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1617">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list meta-exts install list uninstall | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1618">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1619">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1620">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1621">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-exts-install() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1622">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary install &quot;[--local|-l] [--registry|-r] &lt;pkg name[@version]...&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1623">
          <span class="hits">14</span>
          
          <code class="ruby">Installs the named extension package. The &#39;--local&#39; option will use (aka, link to) the local package rather than installing via npm. The &#39;--registry&#39; option (which is the default) will install the package from the NPM registry.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1624">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1625">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1626">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1627">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-exts-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1628">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary list</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1629">
          <span class="hits">14</span>
          
          <code class="ruby">Lists locally installed extensions.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1630">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1631">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1632">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1633">
          <span class="hits">14</span>
          
          <code class="ruby">help-meta-exts-uninstall() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1634">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary uninstall &quot;&lt;pkg name...&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1635">
          <span class="hits">14</span>
          
          <code class="ruby">Removes the installed package. If the package is locally installed, the local package installation is untouched and it is simply no longer used by liq.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1636">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1637">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1638">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1639">
          <span class="hits">14</span>
          
          <code class="ruby">requirements-orgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1640">
          <span class="hits">14</span>
          
          <code class="ruby">  :</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1641">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1642">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1643">
          <span class="hits">14</span>
          
          <code class="ruby"># see `liq help orgs close`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1644">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-close() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1645">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FORCE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1646">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1647">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# &lt; 1 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1648">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Must specify &#39;org package&#39; explicitly to close.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1649">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1650">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1651">
          <span class="hits">14</span>
          
          <code class="ruby">  local ORG_PROJ TO_DELETE OPTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1652">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$FORCE&quot; ]]; then OPTS=&#39;--force&#39;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1653">
          <span class="hits">14</span>
          
          <code class="ruby">  for ORG_PROJ in &quot;$@&quot;; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1654">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsSetPkgNameComponents &quot;$ORG_PROJ&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1655">
          <span class="hits">14</span>
          
          <code class="ruby">    local IS_BASE_ORG=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1656">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot; -ef &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}/${PKG_BASENAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1657">
          <span class="hits">14</span>
          
          <code class="ruby">      IS_BASE_ORG=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1658">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1659">
          <span class="hits">14</span>
          
          <code class="ruby">    projects-close $OPTS &quot;${PKG_ORG_NAME}/${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1660">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$IS_BASE_ORG&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1661">
          <span class="hits">14</span>
          
          <code class="ruby">      rm &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1662">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1663">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1664">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1665">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1666">
          <span class="hits">14</span>
          
          <code class="ruby"># see `liq help orgs create`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1667">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-create() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1668">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELDS=&quot;COMMON_NAME GITHUB_NAME LEGAL_NAME ADDRESS:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1669">
          <span class="hits">14</span>
          
          <code class="ruby">  local OPT_FIELDS=&quot;NAICS NPM_REGISTRY DEFAULT_LICENSE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1670">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIELDS_SENSITIVE=&quot;EIN&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1671">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions COMMON_NAME= GITHUB_NAME= LEGAL_NAME= ADDRESS= NAICS= NPM_REGISTRY:r= DEFAULT_LICENSE= EIN= NO_SENSITIVE:X NO_STAFF:S PRIVATE_POLICY -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1672">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1673">
          <span class="hits">14</span>
          
          <code class="ruby">  local ORG_PKG=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1674">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1675">
          <span class="hits">14</span>
          
          <code class="ruby">  # because some fields are optional, but may be set, we can&#39;t just rely on &#39;gather-answers&#39; to skip interactive bit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1676">
          <span class="hits">14</span>
          
          <code class="ruby">  local FULLY_DEFINED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1677">
          <span class="hits">14</span>
          
          <code class="ruby">  for FIELD in $FIELDS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1678">
          <span class="hits">14</span>
          
          <code class="ruby">    FIELD=${FIELD/:/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1679">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -n &quot;${!FIELD}&quot; ]] || FULLY_DEFINED=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1680">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1681">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1682">
          <span class="hits">14</span>
          
          <code class="ruby">  defaulter() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1683">
          <span class="hits">14</span>
          
          <code class="ruby">    local FIELD=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1684">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1685">
          <span class="hits">14</span>
          
          <code class="ruby">    case &quot;$FIELD&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1686">
          <span class="hits">14</span>
          
          <code class="ruby">      &quot;NPM_REGISTRY&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1687">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;https://registry.npmjs.org/&quot;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1688">
          <span class="hits">14</span>
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1689">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1690">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1691">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$FULLY_DEFINED&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1692">
          <span class="hits">14</span>
          
          <code class="ruby">    NPM_REGISTRY=$(defaulter NPM_REGISTRY)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1693">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1694">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: we need to mark fields as optional for gather-answers or provide func equivalent</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1695">
          <span class="hits">14</span>
          
          <code class="ruby">    local GATHER_FIELDS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1696">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$NO_SENSITIVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1697">
          <span class="hits">14</span>
          
          <code class="ruby">      GATHER_FIELDS=&quot;$FIELDS $OPT_FIELDS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1698">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1699">
          <span class="hits">14</span>
          
          <code class="ruby">      GATHER_FIELDS=&quot;$FIELDS $OPT_FIELDS $FIELDS_SENSITIVE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1700">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1701">
          <span class="hits">14</span>
          
          <code class="ruby">    gather-answers --defaulter=defaulter --verify &quot;$GATHER_FIELDS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1702">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1703">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1704">
          <span class="hits">14</span>
          
          <code class="ruby">  projectsSetPkgNameComponents &quot;${ORG_PKG}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1705">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1706">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1707">
          <span class="hits">14</span>
          
          <code class="ruby">  mkdir -p &quot;${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1708">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1709">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1710">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -L &quot;${PKG_BASENAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1711">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Duplicate or name conflict; found existing locol org package ($ORG_PKG).&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1712">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1713">
          <span class="hits">14</span>
          
          <code class="ruby">  mkdir &quot;${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1714">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1715">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1716">
          <span class="hits">14</span>
          
          <code class="ruby">  commit-settings() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1717">
          <span class="hits">14</span>
          
          <code class="ruby">    local REPO_TYPE=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1718">
          <span class="hits">14</span>
          
          <code class="ruby">    local FIELD</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1719">
          <span class="hits">14</span>
          
          <code class="ruby">    local SETTINGS=&#39;data/orgs/settings.sh&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1720">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1721">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt &quot;Initializing ${REPO_TYPE} repository...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1722">
          <span class="hits">14</span>
          
          <code class="ruby">    git init --quiet .</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1723">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1724">
          <span class="hits">14</span>
          
          <code class="ruby">    mkdir $(dirname &quot;${SETTINGS}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1725">
          <span class="hits">14</span>
          
          <code class="ruby">    for FIELD in &quot;$@&quot;; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1726">
          <span class="hits">14</span>
          
          <code class="ruby">      FIELD=${FIELD/:/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1727">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;ORG_${FIELD}=&#39;$(echo &quot;${!FIELD}&quot; | sed &quot;s/&#39;/&#39;\&quot;&#39;\&quot;&#39;/g&quot;)&#39;&quot; &gt;&gt; &quot;${SETTINGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1728">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1729">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1730">
          <span class="hits">14</span>
          
          <code class="ruby">    git add &quot;${SETTINGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1731">
          <span class="hits">14</span>
          
          <code class="ruby">    git commit -m &quot;initial org settings&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1732">
          <span class="hits">14</span>
          
          <code class="ruby">    git push --set-upstream upstream master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1733">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1734">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1735">
          <span class="hits">14</span>
          
          <code class="ruby">  local SENSITIVE_REPO POLICY_REPO STAFF_REPO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1736">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: give option to use package or repo; these have different implications</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1737">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_SENSITIVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1738">
          <span class="hits">14</span>
          
          <code class="ruby">    SENSITIVE_REPO=&quot;${PKG_ORG_NAME}/${PKG_BASENAME}-sensitive&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1739">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1740">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_STAFF&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1741">
          <span class="hits">14</span>
          
          <code class="ruby">    STAFF_REPO=&quot;${PKG_ORG_NAME}/${PKG_BASENAME}-staff&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1742">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1743">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$PRIVATE_POLICY&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1744">
          <span class="hits">14</span>
          
          <code class="ruby">    POLICY_REPO=&quot;${PKG_ORG_NAME}/${PKG_BASENAME}-policy&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1745">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1746">
          <span class="hits">14</span>
          
          <code class="ruby">    POLICY_REPO=&quot;${PKG_ORG_NAME}/${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1747">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1748">
          <span class="hits">14</span>
          
          <code class="ruby">  hub create --remote-name upstream -d &quot;Public settings for ${LEGAL_NAME}.&quot; &quot;${GITHUB_NAME}/${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1749">
          <span class="hits">14</span>
          
          <code class="ruby">  commit-settings &quot;base&quot; $FIELDS $OPT_FIELDS SENSITIVE_REPO POLICY_REPO STAFF_REPO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1750">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1751">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_SENSITIVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1752">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1753">
          <span class="hits">14</span>
          
          <code class="ruby">    mkdir &quot;${PKG_BASENAME}-sensitive&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1754">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${PKG_BASENAME}-sensitive&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1755">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1756">
          <span class="hits">14</span>
          
          <code class="ruby">    hub create --remote-name upstream --private -d &quot;Sensitive settings for ${LEGAL_NAME}.&quot; &quot;${GITHUB_NAME}/${PKG_BASENAME}-sensitive&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1757">
          <span class="hits">14</span>
          
          <code class="ruby">    commit-settings &quot;sensitive&quot; &quot;$FIELDS_SENSITIVE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1758">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1759">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1760">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_STAFF&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1761">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1762">
          <span class="hits">14</span>
          
          <code class="ruby">    mkdir &quot;${PKG_BASENAME}-staff&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1763">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${PKG_BASENAME}-staff&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1764">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1765">
          <span class="hits">14</span>
          
          <code class="ruby">    hub create --remote-name upstream --private -d &quot;Staff settings for ${LEGAL_NAME}.&quot; &quot;${GITHUB_NAME}/${PKG_BASENAME}-staff&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1766">
          <span class="hits">14</span>
          
          <code class="ruby">    commit-settings &quot;staff&quot; &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1767">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1768">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1769">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$PRIVATE_POLICY&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1770">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1771">
          <span class="hits">14</span>
          
          <code class="ruby">    mkdir &quot;${PKG_BASENAME}-policy&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1772">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${PKG_BASENAME}-policy&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1773">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1774">
          <span class="hits">14</span>
          
          <code class="ruby">    hub create --remote-name upstream --private -d &quot;Policy settings for ${LEGAL_NAME}.&quot; &quot;${GITHUB_NAME}/${PKG_BASENAME}-policy&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1775">
          <span class="hits">14</span>
          
          <code class="ruby">    commit-settings &quot;policy&quot; &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1776">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1777">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1778">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1779">
          <span class="hits">14</span>
          
          <code class="ruby"># see `liq help orgs import`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1780">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-import() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1781">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions IMPORT_REFS:r -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1782">
          <span class="hits">14</span>
          
          <code class="ruby">  local PKG_NAME BASENAME ORG_NPM_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1783">
          <span class="hits">14</span>
          
          <code class="ruby">  projects-import --set-name PKG_NAME &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1784">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: we can refine our logic here by indicating whether project is already imported or not.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1785">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1786">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: check that the package is a &#39;base&#39; org, and if not, skip and echowarn &quot;This is not necessarily a problem.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1787">
          <span class="hits">14</span>
          
          <code class="ruby">  mkdir -p &quot;${LIQ_ORG_DB}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1788">
          <span class="hits">14</span>
          
          <code class="ruby">  projectsSetPkgNameComponents &quot;$PKG_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1789">
          <span class="hits">14</span>
          
          <code class="ruby">  # If &#39;--import-refs&#39;, then not surprising to find extant company.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1790">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -L &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot; ]] &amp;&amp; [[ -z $IMPORT_REFS ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1791">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;Found possible remnant file:\n${LIQ_ORG_DB}/${PKG_ORG_NAME}\n\nWill attempt to delete and continue. Refer to &#39;ls&#39; output results below for more info.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1792">
          <span class="hits">14</span>
          
          <code class="ruby">    ls -l &quot;${LIQ_ORG_DB}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1793">
          <span class="hits">14</span>
          
          <code class="ruby">    rm &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1794">
          <span class="hits">14</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1795">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1796">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -L &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1797">
          <span class="hits">14</span>
          
          <code class="ruby">    || ln -s &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}/${PKG_BASENAME}&quot; &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1798">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1799">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$IMPORT_REFS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1800">
          <span class="hits">14</span>
          
          <code class="ruby">    local REF_REPO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1801">
          <span class="hits">14</span>
          
          <code class="ruby">    orgs-lib-source-settings &quot;$(dirname &quot;$PKG_NAME&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1802">
          <span class="hits">14</span>
          
          <code class="ruby">    for REF_REPO in ORG_POLICY_REPO ORG_SENSITIVE_REPO ORG_STAFF_REPO; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1803">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -n ${!REF_REPO:-} ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1804">
          <span class="hits">14</span>
          
          <code class="ruby">        projects-import ${!REF_REPO}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1805">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1806">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1807">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1808">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1809">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1810">
          <span class="hits">14</span>
          
          <code class="ruby"># see `liq help orgs list`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1811">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1812">
          <span class="hits">14</span>
          
          <code class="ruby">  find &quot;${LIQ_ORG_DB}&quot; -maxdepth 1 -mindepth 1 -type d -exec basename &#39;{}&#39; \; | sort</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1813">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1814">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1815">
          <span class="hits">14</span>
          
          <code class="ruby"># see `liq help orgs show`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1816">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-show() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1817">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions DIR PROJECT SETTINGS -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1818">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1819">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${BASE_DIR}/..&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1820">
          <span class="hits">14</span>
          
          <code class="ruby">  local NPM_ORG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1821">
          <span class="hits">14</span>
          
          <code class="ruby">  NPM_ORG=&quot;$(basename &quot;$PWD&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1822">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1823">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! [[ -e &quot;${LIQ_ORG_DB}/${NPM_ORG}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1824">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No base package found for &#39;${NPM_ORG}&#39;. Try:\nliq orgs import &lt;base pkg|URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1825">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1826">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1827">
          <span class="hits">14</span>
          
          <code class="ruby">  # Recall the org DB links the npm org name to the repo.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1828">
          <span class="hits">14</span>
          
          <code class="ruby">  { { [[ -n &quot;$DIR&quot; ]] &amp;&amp; readlink &quot;${LIQ_ORG_DB}/${NPM_ORG}&quot;; } \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1829">
          <span class="hits">14</span>
          
          <code class="ruby">  || { [[ -n &quot;$PROJECT&quot; ]] &amp;&amp; cat &quot;${LIQ_ORG_DB}/${NPM_ORG}/package.json&quot; | jq -r &#39;.name&#39;; } \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1830">
          <span class="hits">14</span>
          
          <code class="ruby">  || { [[ -n &quot;$SETTINGS&quot; ]] &amp;&amp; cat &quot;${LIQ_ORG_DB}/${NPM_ORG}/data/orgs/settings.sh&quot;; } } || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1831">
          <span class="hits">14</span>
          
          <code class="ruby">  { # the no specific format option</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1832">
          <span class="hits">14</span>
          
          <code class="ruby">    cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1833">
          <span class="hits">14</span>
          
          <code class="ruby">Project: $(cat &quot;${LIQ_ORG_DB}/${NPM_ORG}/package.json&quot; | jq -r &#39;.name&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1834">
          <span class="hits">14</span>
          
          <code class="ruby">Local dir:  $(readlink &quot;${LIQ_ORG_DB}/${NPM_ORG}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1835">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1836">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1837">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="1838">
          <span class="hits">8</span>
          
          <code class="ruby">ORGS_GROUPS=&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1839">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1840">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1841">
          <span class="hits">14</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1842">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1843">
          <span class="hits">14</span>
          
          <code class="ruby">  local SUMMARY=&quot;Manages organizations and affiliations.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1844">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1845">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}orgs${reset} &lt;action&gt;: ${SUMMARY}&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1846">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}orgs${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1847">
          <span class="hits">14</span>
          
          <code class="ruby">$(echo &quot;${SUMMARY} An org(anization) is the legal owner of work and all work is done in the context of an org. An org may represent a employer, an open source project, a department, or yourself. Certain policies and settings are defined at the org level which would then apply to all work done in that org.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1848">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1849">
          <span class="hits">14</span>
          
          <code class="ruby">* There is a 1-1 correspondance between the liq org, a GitHub organization (or individual), andif publishing publiclyan npm package scope.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1850">
          <span class="hits">14</span>
          
          <code class="ruby">* The GitHub organization (or individual) must exist prior to creating an org.&quot; | fold -sw 80 | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1851">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list orgs create close import list show | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1852">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-sub-group-list orgs ORGS_GROUPS)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1853">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1854">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1855">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1856">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs-create() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1857">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary create &quot;[--no-sensitive] [--no-staff] [-private-policy] &lt;base org-package&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1858">
          <span class="hits">14</span>
          
          <code class="ruby">Interactively gathers any org info not specified via CLI options and creates the indicated repos under the indicated GitHub org or user.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1859">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1860">
          <span class="hits">14</span>
          
          <code class="ruby">The following options may be used to specify fields from the CLI. If all required options are specified (even if blank), then the command will run non-interactively and optional fields will be set to default values unless specified:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1861">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1862">
          <span class="hits">14</span>
          
          <code class="ruby">* --common-name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1863">
          <span class="hits">14</span>
          
          <code class="ruby">* --legal-name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1864">
          <span class="hits">14</span>
          
          <code class="ruby">* --address (use $&#39;\n&#39; for linebreaks)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1865">
          <span class="hits">14</span>
          
          <code class="ruby">* --github-name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1866">
          <span class="hits">14</span>
          
          <code class="ruby">* (optional )--ein</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1867">
          <span class="hits">14</span>
          
          <code class="ruby">* (optional) --naics</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1868">
          <span class="hits">14</span>
          
          <code class="ruby">* (optional) --npm-registry$(</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1869">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1870">
          <span class="hits">14</span>
          
          <code class="ruby">)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1871">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1872">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1873">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1874">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs-close() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1875">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary close &quot;[--force] &lt;name&gt;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1876">
          <span class="hits">14</span>
          
          <code class="ruby">After checking that all changes are committed and pushed, closes the named org-project by deleting it from the local playground. &#39;--force&#39; will skip the &#39;up-to-date checks.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1877">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1878">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1879">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1880">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs-import() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1881">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary import &quot;[--import-refs:r] &lt;package or URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1882">
          <span class="hits">14</span>
          
          <code class="ruby">Imports the &#39;base&#39; org package into your playground. The &#39;--import-refs&#39; option will attempt to import any referenced repos. The access rights on referenced repos might be different than the base repo and could fail, in which case the script will attempt to move on to the next, if any.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1883">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1884">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1885">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1886">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1887">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary list</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1888">
          <span class="hits">14</span>
          
          <code class="ruby">Lists the currently affiliated orgs.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1889">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1890">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1891">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1892">
          <span class="hits">14</span>
          
          <code class="ruby">help-orgs-show() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1893">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary show &quot;[--sensitive] [&lt;org nick&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1894">
          <span class="hits">14</span>
          
          <code class="ruby">Displays info on the currently active or named org.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1895">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1896">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1897">
          <span class="hits">14</span>
          
          <code class="ruby"># Ensures that policy repo can be resolved or errors out with a useful message. Can even try to import the necessary</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1898">
          <span class="hits">14</span>
          
          <code class="ruby"># project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1899">
          <span class="hits">14</span>
          
          <code class="ruby">lib-orgs-ensure-policy-repo() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1900">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${ORG_POLICY_REPO}&quot; ]] || echoerrandexit &quot;Try setting company parameter &#39;ORG_POLICY_REPO&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1901">
          <span class="hits">14</span>
          
          <code class="ruby">  ORG_POLICY_REPO=&quot;${ORG_POLICY_REPO/@/}&quot; # TODO: standardize sans &#39;@&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1902">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! [[ -d &quot;${LIQ_PLAYGROUND}/${ORG_POLICY_REPO}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1903">
          <span class="hits">14</span>
          
          <code class="ruby">    if yes-no &quot;Did not find local &#39;${ORG_POLICY_REPO}&#39;. Would you like to attempt import? &quot; Y; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1904">
          <span class="hits">14</span>
          
          <code class="ruby">      projects-import --source &quot;${ORG_POLICY_REPO}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1905">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerrandexit &quot;Project import failed. See above.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1906">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1907">
          <span class="hits">14</span>
          
          <code class="ruby">      echowarnandexit &quot;Try manual import:\nliq projects import --source &#39;${ORG_POLICY_REPO}&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1908">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1909">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1910">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1911">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1912">
          <span class="hits">14</span>
          
          <code class="ruby"># Calls lib-orgs-ensure-policy-repo and then echoes an absolute path if successful.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1913">
          <span class="hits">14</span>
          
          <code class="ruby">lib-orgs-policy-repo-path() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1914">
          <span class="hits">14</span>
          
          <code class="ruby">  lib-orgs-ensure-policy-repo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1915">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1916">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;${LIQ_PLAYGROUND}/${ORG_POLICY_REPO/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1917">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1918">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1919">
          <span class="hits">14</span>
          
          <code class="ruby"># Takes a CLI friendly org ID (as found in LIQ_ORGS_DB) and resolves that to the path to the primary org repo.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1920">
          <span class="hits">14</span>
          
          <code class="ruby">lib-orgs-resolve-path() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1921">
          <span class="hits">14</span>
          
          <code class="ruby">  # expects ORG_ID to be set (by post-options-liq-orgs)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1922">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1923">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -L &quot;${LIQ_ORG_DB}/${ORG_ID}&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1924">
          <span class="hits">14</span>
          
          <code class="ruby">    || echoerrandexit &quot;Could not resolve inferred org ID &#39;${ORG_ID}&#39;. Perhaps the base org repo is not locally installed? If the base package follows convetion, you can try:\nliq orgs import ${ORG_ID}/${ORG_ID}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1925">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1926">
          <span class="hits">14</span>
          
          <code class="ruby">  real_path &quot;${LIQ_ORG_DB}/${ORG_ID}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1927">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1928">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1929">
          <span class="hits">14</span>
          
          <code class="ruby"># Retrieves the policy dir for the named NPM org or will infer from context. Org base and, when private, policy projects</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1930">
          <span class="hits">14</span>
          
          <code class="ruby"># must be locally available.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1931">
          <span class="hits">14</span>
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1932">
          <span class="hits">14</span>
          
          <code class="ruby"># @deprecated: prefer lib-orgs-policy-repo-path</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1933">
          <span class="hits">14</span>
          
          <code class="ruby">orgsPolicyRepo() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1934">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${ORG_POLICY_REPO}&quot; ]] || orgs-lib-source-settings</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1935">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1936">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;${LIQ_PLAYGROUND}/${ORG_POLICY_REPO/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1937">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1938">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1939">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: rename &#39;lib-ogs-source-settings&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1940">
          <span class="hits">14</span>
          
          <code class="ruby"># Sources the named base org settings or will infer org context. If the base org cannot be found, the execution will</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1941">
          <span class="hits">14</span>
          
          <code class="ruby"># halt and the user will be advised to timport it.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1942">
          <span class="hits">14</span>
          
          <code class="ruby">orgs-lib-source-settings() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1943">
          <span class="hits">14</span>
          
          <code class="ruby">  # expects ORG_ID to be set (by post-options-liq-orgs)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1944">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1945">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$ORG_ID&quot; ]]; then # this should have been done by post-options-liq-orgs; if we get here, something is wrong</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1946">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Execution environment is inconsistent; cannot find required data. This may be an error in the tool, so unfortunately we have no user advice for this error.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1947">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1948">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_ID=${ORG_ID/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1949">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1950">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1951">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -e &quot;$LIQ_ORG_DB/${ORG_ID}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1952">
          <span class="hits">14</span>
          
          <code class="ruby">    local SETTINGS=&quot;${LIQ_ORG_DB}/${ORG_ID}/data/orgs/settings.sh&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1953">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -f &quot;${SETTINGS}&quot; ]] || echoerrandexit &quot;Could not locate settings file for &#39;${ORG_ID}&#39; (${SETTINGS}).&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1954">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${SETTINGS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1955">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1956">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_CHART_TEMPLATE=&quot;${ORG_CHART_TEMPLATE/\~/$LIQ_PLAYGROUND}&quot; # TODO: huh? explain this...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1957">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1958">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Did not find expected local org for package &#39;${ORG_ID}&#39;. Try:\nliq orgs import &lt;pkg || URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1959">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1960">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1961">
          <span class="hits">14</span>
          
          <code class="ruby">pre-options-liq-orgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1962">
          <span class="hits">14</span>
          
          <code class="ruby">  echo -n &quot;$(pre-options-liq) ORG:=&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1963">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1964">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1965">
          <span class="hits">14</span>
          
          <code class="ruby"># Sets CURR_ORG and CURR_ORG_PATH</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1966">
          <span class="hits">14</span>
          
          <code class="ruby">post-options-liq-orgs() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1967">
          <span class="hits">14</span>
          
          <code class="ruby">  post-options-liq</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1968">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1969">
          <span class="hits">14</span>
          
          <code class="ruby">  # &#39;ORG&#39; is the parameter set by the user (or not)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1970">
          <span class="hits">14</span>
          
          <code class="ruby">  # &#39;ORG_ID&#39; is the resolved ORG_ID</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1971">
          <span class="hits">14</span>
          
          <code class="ruby">  # &#39;CURR_ORG&#39; is the base org package name; e.g., liquid-labs/liquid-labs TODO: rename to &#39;CURR_ORG&#39;?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1972">
          <span class="hits">14</span>
          
          <code class="ruby">  # &#39;CURR_ORG_PATH&#39; is the absolute path to the CURR_ORG project</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1973">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1974">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: Check if the project &#39;class&#39; is correct; https://github.com/Liquid-Labs/liq-cli/issues/238</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1975">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${ORG:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1976">
          <span class="hits">14</span>
          
          <code class="ruby">    findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1977">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_ID=&quot;$(cd &quot;${BASE_DIR}/..&quot;; basename &quot;$PWD&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1978">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1979">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_ID=&quot;${ORG}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1980">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1981">
          <span class="hits">14</span>
          
          <code class="ruby">  # the following will exit if the ORG_ID cannot be resolved to a local checkout</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1982">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_ORG_PATH=&quot;$(lib-orgs-resolve-path &quot;${ORG_ID}&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1983">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_ORG=&quot;$( cat &quot;${CURR_ORG_PATH}/package.json&quot; | jq -r &#39;.name&#39; )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1984">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_ORG=&quot;${CURR_ORG/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1985">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1986">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1987">
          <span class="hits">14</span>
          
          <code class="ruby">requirements-projects() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1988">
          <span class="hits">14</span>
          
          <code class="ruby">  :</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1989">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1990">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1991">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects build</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1992">
          <span class="hits">14</span>
          
          <code class="ruby">projects-build() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1993">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1994">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;$BASE_DIR&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1995">
          <span class="hits">14</span>
          
          <code class="ruby">  projectsRunPackageScript build</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1996">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1997">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1998">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects close</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="1999">
          <span class="hits">14</span>
          
          <code class="ruby">projects-close() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2000">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FORCE -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2001">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2002">
          <span class="hits">14</span>
          
          <code class="ruby">  # check that we can access GitHub</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2003">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2004">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2005">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECT_NAME=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2006">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2007">
          <span class="hits">14</span>
          
          <code class="ruby">  # first figure out what to close</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2008">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$PROJECT_NAME&quot; ]]; then # try removing the project we&#39;re in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2009">
          <span class="hits">14</span>
          
          <code class="ruby">    findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2010">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;$BASE_DIR&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2011">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT_NAME=$(cat &quot;${BASE_DIR}/package.json&quot; | jq --raw-output &#39;.name | @sh&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2012">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2013">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJECT_NAME=&quot;${PROJECT_NAME/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2014">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2015">
          <span class="hits">14</span>
          
          <code class="ruby">  deleteLocal() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2016">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2017">
          <span class="hits">14</span>
          
          <code class="ruby">      &amp;&amp; rm -rf &quot;$PROJECT_NAME&quot; &amp;&amp; echo &quot;Removed local work directory for project &#39;@${PROJECT_NAME}&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2018">
          <span class="hits">14</span>
          
          <code class="ruby">    # now check to see if we have an empty &quot;org&quot; dir</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2019">
          <span class="hits">14</span>
          
          <code class="ruby">    local ORG_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2020">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_NAME=$(dirname &quot;${PROJECT_NAME}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2021">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$ORG_NAME&quot; != &quot;.&quot; ]] &amp;&amp; (( 0 == $(ls &quot;$ORG_NAME&quot; | wc -l) )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2022">
          <span class="hits">14</span>
          
          <code class="ruby">      rmdir &quot;$ORG_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2023">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2024">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2025">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2026">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;$LIQ_PLAYGROUND&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2027">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -d &quot;$PROJECT_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2028">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$FORCE&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2029">
          <span class="hits">14</span>
          
          <code class="ruby">      deleteLocal</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2030">
          <span class="hits">14</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2031">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2032">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2033">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;$PROJECT_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2034">
          <span class="hits">14</span>
          
          <code class="ruby">    # Are remotes setup as expected?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2035">
          <span class="hits">14</span>
          
          <code class="ruby">    if ! git remote | grep -q &#39;^upstream$&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2036">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Did not find expected &#39;upstream&#39; remote. Try:\n\ncd &#39;$LIQ_PLAYGROUND&#39;\n\nThen manually verify everything has been saved and pushed to the canonical remote. Then you can force local deletion with:\n\nliq projects close --force &#39;${PROJECT_NAME}&#39; #use-with-extreme-caution&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2037">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2038">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepo --check-all-branches &quot;$PROJECT_NAME&quot; # exits if not clean + branches saved to remotes</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2039">
          <span class="hits">14</span>
          
          <code class="ruby">    deleteLocal # didn&#39;t exit? OK to delete</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2040">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2041">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Did not find project &#39;$PROJECT_NAME&#39;&quot; 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2042">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2043">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: need to check whether the project is linked to other projects</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2044">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2045">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2046">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects create</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2047">
          <span class="hits">14</span>
          
          <code class="ruby">projects-create() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2048">
          <span class="hits">14</span>
          
          <code class="ruby">  local PKG_ORG_NAME PKG_BASENAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2049">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: Support &#39;NPM_PASSTHRUOGH:P&#39; which will use the NPM default values for version and license.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2050">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NEW= SOURCE= FOLLOW NO_FORK:F VERSION= LICENSE= DESCRIPTION= PUBLIC: ORG_BASE= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2051">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2052">
          <span class="hits">14</span>
          
          <code class="ruby">  __PROJ_NAME=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2053">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${ORG_BASE}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2054">
          <span class="hits">14</span>
          
          <code class="ruby">    local ORG_BIT=$(dirname &quot;${__PROJ_NAME/@/}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2055">
          <span class="hits">14</span>
          
          <code class="ruby">    local ORG_LINK=&quot;${LIQ_DB}/orgs/${ORG_BIT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2056">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -L &quot;$ORG_LINK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2057">
          <span class="hits">14</span>
          
          <code class="ruby">      ORG_BASE=&quot;$(cat &quot;${ORG_LINK}/package.json&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2058">
          <span class="hits">14</span>
          
          <code class="ruby">        | jq -r &#39;.repository.url&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2059">
          <span class="hits">14</span>
          
          <code class="ruby">        | sed -E -e &#39;s|^[^/]*//[^/]+/||&#39; -e &#39;s/\.git$//&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2060">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2061">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Could not determine org base through local checkouts; specify &#39;--org-base &lt;github org/repo&gt;&#39; for the project.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2062">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2063">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2064">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2065">
          <span class="hits">14</span>
          
          <code class="ruby">  # first, check that we can access GitHub</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2066">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2067">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: check that the upstream and workspace projects don&#39;t already exist</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2068">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2069">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$NEW&quot; ]] &amp;&amp; [[ -n &quot;$SOURCE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2070">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;The &#39;--new&#39; and &#39;--source&#39; options are not compatible. Please refer to:\nliq help projects create&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2071">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -z &quot;$NEW&quot; ]] &amp;&amp; [[ -z &quot;$SOURCE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2072">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;You must specify one of the &#39;--new&#39; or &#39;--source&#39; options when creating a project.Please refer to:\nliq help projects create&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2073">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2074">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2075">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${__PROJ_NAME:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2076">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$SOURCE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2077">
          <span class="hits">14</span>
          
          <code class="ruby">      __PROJ_NAME=$(basename &quot;$SOURCE&quot; | sed -e &#39;s/\.[a-zA-Z0-9]*$//&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2078">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Default project name to: ${__PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2079">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2080">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Must specify project name for &#39;--new&#39; projects.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2081">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2082">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2083">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2084">
          <span class="hits">14</span>
          
          <code class="ruby">  projectsSetPkgNameComponents &quot;${__PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2085">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$PKG_ORG_NAME&quot; == &#39;.&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2086">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Must specify org scope in name when creating a project. E.g. &#39;my-org/my-project&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2087">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2088">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2089">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -e &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2090">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${LIQ_ORG_DB}/${PKG_ORG_NAME}/data/orgs/settings.sh&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2091">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2092">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Did not find base org repo for &#39;$PKG_ORG_NAME&#39;. Try:\nliq orgs import &lt;base org pkg or URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2093">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2094">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2095">
          <span class="hits">14</span>
          
          <code class="ruby">  local REPO_FRAG REPO_URL BUGS_URL README_URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2096">
          <span class="hits">14</span>
          
          <code class="ruby">  REPO_FRAG=&quot;github.com/${ORG_GITHUB_NAME}/${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2097">
          <span class="hits">14</span>
          
          <code class="ruby">  REPO_URL=&quot;git+ssh://git@${REPO_FRAG}.git&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2098">
          <span class="hits">14</span>
          
          <code class="ruby">  BUGS_URL=&quot;https://${REPO_FRAG}/issues&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2099">
          <span class="hits">14</span>
          
          <code class="ruby">  HOMEPAGE=&quot;https://${REPO_FRAG}#readme&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2100">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2101">
          <span class="hits">14</span>
          
          <code class="ruby">  update_pkg() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2102">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.name = \&quot;@${ORG_NPM_SCOPE}/${PKG_BASENAME}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2103">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -n &quot;$VERSION&quot; ]] || VERSION=&#39;1.0.0-alpha.0&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2104">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.version = \&quot;${VERSION}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2105">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -n &quot;$LICENSE&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2106">
          <span class="hits">14</span>
          
          <code class="ruby">      || { [[ -n &quot;${ORG_DEFAULT_LICENSE:-}&quot; ]] &amp;&amp; LICENSE=&quot;$ORG_DEFAULT_LICENSE&quot;; } \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2107">
          <span class="hits">14</span>
          
          <code class="ruby">      || LICENSE=&#39;UNLICENSED&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2108">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.license = \&quot;${LICENSE}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2109">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.repository = { type: \&quot;git\&quot;, url: \&quot;${REPO_URL}\&quot;}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2110">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.bugs = { url: \&quot;${BUGS_URL}\&quot;}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2111">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg_line &quot;.homepage = \&quot;${HOMEPAGE}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2112">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$DESCRIPTION&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2113">
          <span class="hits">14</span>
          
          <code class="ruby">      update_pkg_line &quot;.description = \&quot;${DESCRIPTION}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2114">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2115">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2116">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2117">
          <span class="hits">14</span>
          
          <code class="ruby">  update_pkg_line() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2118">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$(cat package.json | jq &quot;${1}&quot;)&quot; &gt; package.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2119">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2120">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2121">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$NEW&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2122">
          <span class="hits">14</span>
          
          <code class="ruby">    local STAGING PROJ_STAGE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2123">
          <span class="hits">14</span>
          
          <code class="ruby">    projectResetStaging &quot;$__PROJ_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2124">
          <span class="hits">14</span>
          
          <code class="ruby">    mkdir -p &quot;${PROJ_STAGE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2125">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${PROJ_STAGE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2126">
          <span class="hits">14</span>
          
          <code class="ruby">    git init --quiet .</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2127">
          <span class="hits">14</span>
          
          <code class="ruby">    npm init -y &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2128">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2129">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$NEW&quot; == &quot;raw&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2130">
          <span class="hits">14</span>
          
          <code class="ruby">      update_pkg</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2131">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2132">
          <span class="hits">14</span>
          
          <code class="ruby">      # TODO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2133">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerr &quot;Only the &#39;raw&#39; type is currently supported in this alpha version.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2134">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2135">
          <span class="hits">14</span>
          
          <code class="ruby">    git add package.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2136">
          <span class="hits">14</span>
          
          <code class="ruby">    git commit -m &quot;packaage initialization&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2137">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2138">
          <span class="hits">14</span>
          
          <code class="ruby">    projectClone &quot;$SOURCE&quot; &#39;source&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2139">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;$PROJ_STAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2140">
          <span class="hits">14</span>
          
          <code class="ruby">    git remote set-url --push source no_push</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2141">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2142">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Setting up package.json...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2143">
          <span class="hits">14</span>
          
          <code class="ruby">    # setup all the vars</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2144">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -n &quot;$VERSION&quot; ]] || VERSION=&#39;1.0.0&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2145">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2146">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -f &quot;package.json&quot; ]] || echo &#39;{}&#39; &gt; package.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2147">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2148">
          <span class="hits">14</span>
          
          <code class="ruby">    update_pkg</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2149">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2150">
          <span class="hits">14</span>
          
          <code class="ruby">    git add package.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2151">
          <span class="hits">14</span>
          
          <code class="ruby">    git commit -m &quot;setup and/or updated package.json&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2152">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2153">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2154">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Adding basic liq data to package.json...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2155">
          <span class="hits">14</span>
          
          <code class="ruby">  cat package.json | jq &#39;. + { &quot;&#39;&quot;${LIQ_NPM_KEY}&quot;&#39;&quot;: { &quot;orgBase&quot;: &quot;git@github.com:&#39;&quot;${ORG_BASE}&quot;&#39;.git&quot; } }&#39; &gt; package.new.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2156">
          <span class="hits">14</span>
          
          <code class="ruby">  mv package.new.json package.json</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2157">
          <span class="hits">14</span>
          
          <code class="ruby">  git commit -am &quot;Added basic liq data to package.json&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2158">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2159">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Creating upstream repo...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2160">
          <span class="hits">14</span>
          
          <code class="ruby">  local CREATE_OPTS=&quot;--remote-name upstream&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2161">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$PUBLIC&quot; ]]; then CREATE_OPTS=&quot;${CREATE_OPTS} --private&quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2162">
          <span class="hits">14</span>
          
          <code class="ruby">  hub create --remote-name upstream ${CREATE_OPTS} -d &quot;$DESCRIPTION&quot; &quot;${ORG_GITHUB_NAME}/${__PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2163">
          <span class="hits">14</span>
          
          <code class="ruby">  local RETRY=4</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2164">
          <span class="hits">14</span>
          
          <code class="ruby">  git push --all upstream || { echowarn &quot;Upstream repo not yet available.&quot;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2165">
          <span class="hits">14</span>
          
          <code class="ruby">    while (( $RETRY &gt; 0 )); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2166">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Waiting for upstream repo to stabilize...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2167">
          <span class="hits">14</span>
          
          <code class="ruby">      local COUNTDOWN=3</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2168">
          <span class="hits">14</span>
          
          <code class="ruby">      while (( $COUNTDOWN &gt; 0 )); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2169">
          <span class="hits">14</span>
          
          <code class="ruby">        echo -n &quot;${COUNTDOWN}...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2170">
          <span class="hits">14</span>
          
          <code class="ruby">        COUNTDOWN=$(( $COUNTDOWN - 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2171">
          <span class="hits">14</span>
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2172">
          <span class="hits">14</span>
          
          <code class="ruby">      if (( $RETRY == 1 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2173">
          <span class="hits">14</span>
          
          <code class="ruby">        git push --all upstream || echoerr &quot;Could not push to upstream. Manually update.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2174">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2175">
          <span class="hits">14</span>
          
          <code class="ruby">        { git push --all upstream &amp;&amp; RETRY=0; } || RETRY=$(( $RETRY - 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2176">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2177">
          <span class="hits">14</span>
          
          <code class="ruby">    done;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2178">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2179">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2180">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_FORK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2181">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Creating fork...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2182">
          <span class="hits">14</span>
          
          <code class="ruby">    hub fork --remote-name workspace</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2183">
          <span class="hits">14</span>
          
          <code class="ruby">    git branch -u upstream/master master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2184">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2185">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NEW&quot; ]] &amp;&amp; [[ -z &quot;$FOLLOW&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2186">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Un-following source repo...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2187">
          <span class="hits">14</span>
          
          <code class="ruby">    git remote remove source</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2188">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2189">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2190">
          <span class="hits">14</span>
          
          <code class="ruby">  cd - &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2191">
          <span class="hits">14</span>
          
          <code class="ruby">  projectMoveStaged &quot;${PKG_ORG_NAME}/${PKG_BASENAME}&quot; &quot;$PROJ_STAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2192">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${PKG_ORG_NAME}/${PKG_BASENAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2193">
          <span class="hits">14</span>
          
          <code class="ruby">  projects-setup --unpublished</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2194">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2195">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2196">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects deploy</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2197">
          <span class="hits">14</span>
          
          <code class="ruby">projects-deploy() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2198">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${GOPATH:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2199">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &quot;&#39;GOPATH&#39; is not defined. Run &#39;liq go configure&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2200">
          <span class="hits">14</span>
          
          <code class="ruby">    exit 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2201">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2202">
          <span class="hits">14</span>
          
          <code class="ruby">  colorerr &quot;GOPATH=$GOPATH bash -c &#39;cd $GOPATH/src/$REL_GOAPP_PATH; gcloud app deploy&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2203">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2204">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2205">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects edit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2206">
          <span class="hits">14</span>
          
          <code class="ruby">projects-edit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2207">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2208">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2209">
          <span class="hits">14</span>
          
          <code class="ruby">  local EDITOR_CMD=&quot;${LIQ_EDITOR_CMD:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2210">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${EDITOR_CMD}&quot; ]] || EDITOR_CMD=&quot;atom .&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2211">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${BASE_DIR}&quot; &amp;&amp; ${EDITOR_CMD}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2212">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2213">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2214">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects import; The &#39;--set-name&#39; and &#39;--set-url&#39; options are for internal use and each take a var name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2215">
          <span class="hits">14</span>
          
          <code class="ruby"># which will be &#39;eval&#39;-ed to contain the project name and URL.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2216">
          <span class="hits">14</span>
          
          <code class="ruby">projects-import() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2217">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_SPEC __PROJ_NAME _PROJ_URL PROJ_STAGE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2218">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_FORK:F NO_INSTALL SET_NAME= SET_URL= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2219">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2220">
          <span class="hits">14</span>
          
          <code class="ruby">  set-stuff() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2221">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: protect this eval</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2222">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$SET_NAME&quot; ]]; then eval &quot;$SET_NAME=&#39;$_PROJ_NAME&#39;&quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2223">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$SET_URL&quot; ]]; then eval &quot;$SET_URL=&#39;$_PROJ_URL&#39;&quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2224">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2225">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2226">
          <span class="hits">14</span>
          
          <code class="ruby">  fork_check() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2227">
          <span class="hits">14</span>
          
          <code class="ruby">    local GIT_URL=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2228">
          <span class="hits">14</span>
          
          <code class="ruby">    local PRIVATE GIT_OWNER GIT REPO</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2229">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;URL: $GIT_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2230">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2231">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$NO_FORK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2232">
          <span class="hits">14</span>
          
          <code class="ruby">      GIT_URL=&quot;$(echo &quot;$GIT_URL&quot; | sed -e &#39;s/[^:]*://&#39; -e &#39;s/\.git$//&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2233">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;URL2: $GIT_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2234">
          <span class="hits">14</span>
          
          <code class="ruby">      GIT_OWNER=&quot;$(basename &quot;$(dirname &quot;$GIT_URL&quot;)&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2235">
          <span class="hits">14</span>
          
          <code class="ruby">      GIT_REPO=&quot;$(basename &quot;$GIT_URL&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2236">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2237">
          <span class="hits">14</span>
          
          <code class="ruby">      echo hub api -X GET &quot;/repos/${GIT_OWNER}/${GIT_REPO}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2238">
          <span class="hits">14</span>
          
          <code class="ruby">      PRIVATE=&quot;$(hub api -X GET &quot;/repos/${GIT_OWNER}/${GIT_REPO}&quot; | jq &#39;.private&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2239">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;${PRIVATE}&quot; == &#39;true&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2240">
          <span class="hits">14</span>
          
          <code class="ruby">        NO_FORK=&#39;true&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2241">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2242">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2243">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2244">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2245">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$1&quot; == *:* ]]; then # it&#39;s a URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2246">
          <span class="hits">14</span>
          
          <code class="ruby">    _PROJ_URL=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2247">
          <span class="hits">14</span>
          
          <code class="ruby">    fork_check &quot;${_PROJ_URL}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2248">
          <span class="hits">14</span>
          
          <code class="ruby">    # We have to grab the project from the repo in order to figure out it&#39;s (npm-based) name...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2249">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$NO_FORK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2250">
          <span class="hits">14</span>
          
          <code class="ruby">      projectClone &quot;$_PROJ_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2251">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2252">
          <span class="hits">14</span>
          
          <code class="ruby">      projectForkClone &quot;$_PROJ_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2253">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2254">
          <span class="hits">14</span>
          
          <code class="ruby">    _PROJ_NAME=$(cat &quot;$PROJ_STAGE/package.json&quot; | jq --raw-output &#39;.name&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2255">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$_PROJ_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2256">
          <span class="hits">14</span>
          
          <code class="ruby">      set-stuff</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2257">
          <span class="hits">14</span>
          
          <code class="ruby">      if projectCheckIfInPlayground &quot;$_PROJ_NAME&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2258">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;Project &#39;$_PROJ_NAME&#39; is already in the playground. No changes made.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2259">
          <span class="hits">14</span>
          
          <code class="ruby">        return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2260">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2261">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2262">
          <span class="hits">14</span>
          
          <code class="ruby">      rm -rf &quot;$PROJ_STAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2263">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit -F &quot;The specified source is not a valid Liquid Dev package (no &#39;package.json&#39;). Try:\nliq projects create --type=bare --origin=&#39;$_PROJ_URL&#39; &lt;project name&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2264">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2265">
          <span class="hits">14</span>
          
          <code class="ruby">  else # it&#39;s an NPM package</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2266">
          <span class="hits">14</span>
          
          <code class="ruby">    _PROJ_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2267">
          <span class="hits">14</span>
          
          <code class="ruby">    set-stuff</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2268">
          <span class="hits">14</span>
          
          <code class="ruby">    if projectCheckIfInPlayground &quot;$_PROJ_NAME&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2269">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Project &#39;$_PROJ_NAME&#39; is already in the playground. No changes made.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2270">
          <span class="hits">14</span>
          
          <code class="ruby">      _PROJ_URL=&quot;$(projectsGetUpstreamUrl &quot;$_PROJ_NAME&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2271">
          <span class="hits">14</span>
          
          <code class="ruby">      set-stuff</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2272">
          <span class="hits">14</span>
          
          <code class="ruby">      return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2273">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2274">
          <span class="hits">14</span>
          
          <code class="ruby">    # Note: NPM will accept git URLs, but this saves us a step, let&#39;s us check if in playground earlier, and simplifes branching</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2275">
          <span class="hits">14</span>
          
          <code class="ruby">    _PROJ_URL=$(npm view &quot;$_PROJ_NAME&quot; repository.url) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2276">
          <span class="hits">14</span>
          
          <code class="ruby">      || echoerrandexit &quot;Did not find expected NPM package &#39;${_PROJ_NAME}&#39;. Did you forget the &#39;--url&#39; option?&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2277">
          <span class="hits">14</span>
          
          <code class="ruby">    set-stuff</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2278">
          <span class="hits">14</span>
          
          <code class="ruby">    _PROJ_URL=${_PROJ_URL##git+}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2279">
          <span class="hits">14</span>
          
          <code class="ruby">    fork_check &quot;$_PROJ_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2280">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$NO_FORK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2281">
          <span class="hits">14</span>
          
          <code class="ruby">      projectClone &quot;$_PROJ_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2282">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2283">
          <span class="hits">14</span>
          
          <code class="ruby">      projectForkClone &quot;$_PROJ_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2284">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2285">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2286">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2287">
          <span class="hits">14</span>
          
          <code class="ruby">  projectMoveStaged &quot;$_PROJ_NAME&quot; &quot;$PROJ_STAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2288">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2289">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;&#39;$_PROJ_NAME&#39; imported into playground.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2290">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_INSTALL&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2291">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${_PROJ_NAME/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2292">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Installing project...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2293">
          <span class="hits">14</span>
          
          <code class="ruby">    npm install || echoerrandexit &quot;Installation failed.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2294">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Install complete.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2295">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2296">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2297">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2298">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects publish</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2299">
          <span class="hits">14</span>
          
          <code class="ruby">projects-publish() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2300">
          <span class="hits">14</span>
          
          <code class="ruby">  echoerrandexit &quot;The &#39;publish&#39; action is not yet implemented.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2301">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2302">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2303">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects qa</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2304">
          <span class="hits">14</span>
          
          <code class="ruby">projects-qa() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2305">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions UPDATE^ OPTIONS=^ AUDIT LINT LIQ_CHECK VERSION_CHECK -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2306">
          <span class="hits">14</span>
          
          <code class="ruby">    || { contextHelp; echoerrandexit &quot;Bad options.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2307">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2308">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2309">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;$BASE_DIR&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2310">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2311">
          <span class="hits">14</span>
          
          <code class="ruby">  local RESTRICTED=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2312">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$AUDIT&quot; ]] || [[ -n &quot;$LINT&quot; ]] || [[ -n &quot;$LIQ_CHECK&quot; ]] || [[ -n &quot;$VERSION_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2313">
          <span class="hits">14</span>
          
          <code class="ruby">    RESTRICTED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2314">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2315">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2316">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIX_LIST</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2317">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$RESTRICTED&quot; ]] || [[ -n &quot;$AUDIT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2318">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsNpmAudit &quot;$@&quot; || list-add-item FIX_LIST &#39;--audit&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2319">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2320">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$RESTRICTED&quot; ]] || [[ -n &quot;$LINT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2321">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsLint &quot;$@&quot; || list-add-item FIX_LIST &#39;--lint&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2322">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2323">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$RESTRICTED&quot; ]] || [[ -n &quot;$LIQ_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2324">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsLiqCheck &quot;$@&quot; || true # Check provides it&#39;s own instrucitons.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2325">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2326">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$RESTRICTED&quot; ]] || [[ -n &quot;$VERSION_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2327">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheck &quot;$@&quot; || list-add-item FIX_LIST &#39;--version-check&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2328">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2329">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$FIX_LIST&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2330">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;To attempt automated fixes, try:\nliq projects qa --update $(list-join FIX_LIST &#39; &#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2331">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2332">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2333">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2334">
          <span class="hits">14</span>
          
          <code class="ruby">projects-setup() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2335">
          <span class="hits">14</span>
          
          <code class="ruby">  local OPTIONS=&quot;PROJECT= SKIP_LABELS:L NO_DELETE_LABELS:D NO_UPDATE_LABELS:U SKIP_MILESTONES:M UNPUBLISHED:P&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2336">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions $OPTIONS -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2337">
          <span class="hits">14</span>
          
          <code class="ruby">    || { contextHelp; echoerrandexit &quot;Bad options.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2338">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2339">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$PROJECT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2340">
          <span class="hits">14</span>
          
          <code class="ruby">    requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2341">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;${PACKAGE_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2342">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2343">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJECT=&quot;${PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2344">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2345">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2346">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$PACKAGE_NAME&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2347">
          <span class="hits">14</span>
          
          <code class="ruby">    requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2348">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2349">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2350">
          <span class="hits">14</span>
          
          <code class="ruby">  local GIT_BASE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2351">
          <span class="hits">14</span>
          
          <code class="ruby">  GIT_BASE=&quot;$(echo &quot;${PACKAGE}&quot; | jq -r &#39;.repository.url&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2352">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;${GIT_BASE}&quot; == *&#39;github.com&#39;*&#39;git&#39; ]]; then # it&#39;s a git URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2353">
          <span class="hits">14</span>
          
          <code class="ruby">    GIT_BASE=&quot;$(echo &quot;${GIT_BASE}&quot; | awk -F/ &#39;{ print $4&quot;/&quot;$5 }&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2354">
          <span class="hits">14</span>
          
          <code class="ruby">    GIT_BASE=&quot;${GIT_BASE:0:$(( ${#GIT_BASE} - 4 ))}&quot; # remove &#39;.git&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2355">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2356">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;&#39;repository.url&#39; from &#39;package.json&#39; in unknown format; only github currently supported.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2357">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2358">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2359">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;$SKIP_LABELS&quot; ]] || projects-lib-setup-labels-sync</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2360">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2361">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;$SKIP_MILESTONES&quot; ]] || {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2362">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Setting up milestones...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2363">
          <span class="hits">14</span>
          
          <code class="ruby">    # Expects PACKAGE_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2364">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_MILESTONES EXPECTED_MILESTONES TYPICAL_MILESTONES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2365">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_MILESTONES=&quot;$(hub api &quot;/repos/${GIT_BASE}/milestones&quot; | jq -r &quot;.[].title&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2366">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2367">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$CURR_MILESTONES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2368">
          <span class="hits">14</span>
          
          <code class="ruby">      echo -e &quot;  Current milestones:\n$(echo &quot;${CURR_MILESTONES}&quot; | awk &#39;{print &quot;    * &quot;$0}&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2369">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2370">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2371">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  No existing milestones found.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2372">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2373">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2374">
          <span class="hits">14</span>
          
          <code class="ruby">    local EXPECTED_MILESTONES_PRESENT=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2375">
          <span class="hits">14</span>
          
          <code class="ruby">    local MILESTONES_SYNCED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2376">
          <span class="hits">14</span>
          
          <code class="ruby">    check-and-add-milestone() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2377">
          <span class="hits">14</span>
          
          <code class="ruby">      local TITLE=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2378">
          <span class="hits">14</span>
          
          <code class="ruby">      local RESULT TITLE_OUT NUMBER</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2379">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;$(list-get-index CURR_MILESTONES &quot;${TITLE}&quot;)&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2380">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Attempting to add milestone &#39;${TITLE}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2381">
          <span class="hits">14</span>
          
          <code class="ruby">        RESULT=&quot;$(hub api -X POST &quot;/repos/${GIT_BASE}/milestones&quot; -f title=&quot;${TITLE}&quot;)&quot; &amp;&amp; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2382">
          <span class="hits">14</span>
          
          <code class="ruby">        { # milestone create success</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2383">
          <span class="hits">14</span>
          
          <code class="ruby">          TITLE_OUT=&quot;$(echo &quot;${RESULT}&quot; | jq -r &#39;.title&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2384">
          <span class="hits">14</span>
          
          <code class="ruby">          [[ &quot;${TITLE_OUT}&quot; == &quot;${TITLE}&quot; ]] || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2385">
          <span class="hits">14</span>
          
          <code class="ruby">            echowarn &quot;  Created title &#39;${TITLE_OUT}&#39; does not match input title &#39;${TITLE}&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2386">
          <span class="hits">14</span>
          
          <code class="ruby">          NUMBER=&quot;$(echo &quot;${RESULT}&quot; | jq -r &#39;.number&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2387">
          <span class="hits">14</span>
          
          <code class="ruby">          echo &quot;  Created milestone &#39;${TITLE}&#39; (milestone number: ${NUMBER})...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2388">
          <span class="hits">14</span>
          
          <code class="ruby">        } || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2389">
          <span class="hits">14</span>
          
          <code class="ruby">        { # milestone create failed</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2390">
          <span class="hits">14</span>
          
          <code class="ruby">          echoerr &quot;  Failed to create milestone &#39;${TITLE}&#39; (probably); check and add manually.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2391">
          <span class="hits">14</span>
          
          <code class="ruby">          MILESTONES_SYNCED=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2392">
          <span class="hits">14</span>
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2393">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2394">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Milestone &#39;${TITLE}&#39; already present.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2395">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2396">
          <span class="hits">14</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2397">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2398">
          <span class="hits">14</span>
          
          <code class="ruby">    semver-to-milestone() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2399">
          <span class="hits">14</span>
          
          <code class="ruby">      sed -E -e &#39;s/([[:digit:]]+\.[[:digit:]]+)\.[[:digit:]]+/\1/&#39; -e &#39;s/\.[[:digit:]]+$//&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2400">
          <span class="hits">14</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2401">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2402">
          <span class="hits">14</span>
          
          <code class="ruby">    EXPECTED_MILESTONES=&quot;backlog&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2403">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2404">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_VERSION CURR_PREID</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2405">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;${UNPUBLISHED}&quot; ]] &amp;&amp; npm search &quot;${PACKAGE_NAME}&quot; --parseable | grep -q &quot;${PACKAGE_NAME}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2406">
          <span class="hits">14</span>
          
          <code class="ruby">      CURR_VERSION=&quot;$(npm info &quot;${PACKAGE_NAME}&quot; version)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2407">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2408">
          <span class="hits">14</span>
          
          <code class="ruby">      # The package is not-published/not-findable.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2409">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;${UNPUBLISHED}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2410">
          <span class="hits">14</span>
          
          <code class="ruby">        echowarn &quot;Package &#39;${PACKAGE_NAME}&#39; not publised or not findable. Consider publishing.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2411">
          <span class="hits">14</span>
          
          <code class="ruby">        echowarn &quot;Current version will be read locally.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2412">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2413">
          <span class="hits">14</span>
          
          <code class="ruby">      CURR_VERSION=&quot;$(echo &quot;$PACKAGE&quot; | jq -r &#39;.version&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2414">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2415">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2416">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;${CURR_VERSION}&quot; == *&quot;-&quot;* ]]; then # it&#39;s a pre-release version</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2417">
          <span class="hits">14</span>
          
          <code class="ruby">      local NEXT_VER NEXT_PREID</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2418">
          <span class="hits">14</span>
          
          <code class="ruby">      CURR_PREID=&quot;$(echo &quot;${CURR_VERSION}&quot; | cut -d- -f2 | cut -d. -f1)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2419">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;${CURR_PREID}&quot; == &#39;alpha&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2420">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item EXPECTED_MILESTONES \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2421">
          <span class="hits">14</span>
          
          <code class="ruby">          &quot;$(semver &quot;$CURR_VERSION&quot; --increment prerelease --preid beta | semver-to-milestone)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2422">
          <span class="hits">14</span>
          
          <code class="ruby">      elif [[ &quot;${CURR_PREID}&quot; == &#39;rc&#39; ]] || [[ &quot;${CURR_PREID}&quot; == &#39;beta&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2423">
          <span class="hits">14</span>
          
          <code class="ruby">         # a released ver</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2424">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item EXPECTED_MILESTONES &quot;$(semver &quot;$CURR_VERSION&quot; --increment | semver-to-milestone)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2425">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2426">
          <span class="hits">14</span>
          
          <code class="ruby">        echowarn &quot;Unknown pre-release type &#39;${CURR_PREID}&#39;; defaulting to &#39;beta&#39; as next target release. Consider updating released version to standard &#39;alpha&#39;, &#39;beta&#39;, or &#39;rc&#39; types.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2427">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item EXPECTED_MILESTONES \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2428">
          <span class="hits">14</span>
          
          <code class="ruby">          &quot;$(semver &quot;$CURR_VERSION&quot; --increment prerelease --preid beta | semver-to-milestone)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2429">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2430">
          <span class="hits">14</span>
          
          <code class="ruby">    else # it&#39;s a released version tag</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2431">
          <span class="hits">14</span>
          
          <code class="ruby">      list-add-item TYPICAL_MILESTONES \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2432">
          <span class="hits">14</span>
          
          <code class="ruby">        &quot;$(semver &quot;$CURR_VERSION&quot; --increment premajor --preid alpha | semver-to-milestone)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2433">
          <span class="hits">14</span>
          
          <code class="ruby">      list-add-item TYPICAL_MILESTONES &quot;$(semver &quot;$CURR_VERSION&quot; --increment minor | semver-to-milestone)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2434">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2435">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2436">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${EXPECTED_MILESTONES}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2437">
          <span class="hits">14</span>
          
          <code class="ruby">      local TEST_MILESTONE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2438">
          <span class="hits">14</span>
          
          <code class="ruby">      while read -r TEST_MILESTONE; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2439">
          <span class="hits">14</span>
          
          <code class="ruby">        check-and-add-milestone &quot;${TEST_MILESTONE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2440">
          <span class="hits">14</span>
          
          <code class="ruby">      done &lt;&lt;&lt; &quot;${EXPECTED_MILESTONES}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2441">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2442">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${TYPICAL_MILESTONES}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2443">
          <span class="hits">14</span>
          
          <code class="ruby">      while read -r TEST_MILESTONE; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2444">
          <span class="hits">14</span>
          
          <code class="ruby">        check-and-add-milestone &quot;${TEST_MILESTONE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2445">
          <span class="hits">14</span>
          
          <code class="ruby">      done &lt;&lt;&lt; &quot;${TYPICAL_MILESTONES}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2446">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2447">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2448">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ &quot;${MILESTONES_SYNCED}&quot; != true ]] || echo &quot;Milestone setup complete.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2449">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ &quot;${MILESTONES_SYNCED}&quot; == true ]] || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2450">
          <span class="hits">14</span>
          
          <code class="ruby">      echowarn &quot;One or more expected milestones may be missing. Check above output for additional informaiton.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2451">
          <span class="hits">14</span>
          
          <code class="ruby">  } # end SKIP_MILESTONES check</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2452">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2453">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2454">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects sync</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2455">
          <span class="hits">14</span>
          
          <code class="ruby">projects-sync() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2456">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FETCH_ONLY NO_WORK_MASTER_MERGE:M PROJECT= -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2457">
          <span class="hits">14</span>
          
          <code class="ruby">    || { contextHelp; echoerrandexit &quot;Bad options.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2458">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2459">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$PROJECT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2460">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -n &quot;${BASE_DIR:-}&quot; ]] || findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2461">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;$(cat &quot;${BASE_DIR}/package.json&quot; | jq --raw-output &#39;.name&#39; | tr -d &quot;&#39;&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2462">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2463">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJECT=${PROJECT/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2464">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_DIR=&quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2465">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2466">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_WORK_MASTER_MERGE&quot; ]] &amp;&amp; [[ -z &quot;$FETCH_ONLY&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2467">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepo &quot;$PROJECT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2468">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2469">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2470">
          <span class="hits">14</span>
          
          <code class="ruby">  local CURR_BRANCH REMOTE_COMMITS MASTER_UPDATED</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2471">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_BRANCH=&quot;$(workCurrentWorkBranch)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2472">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2473">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Fetching remote histories...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2474">
          <span class="hits">14</span>
          
          <code class="ruby">  git fetch upstream master:remotes/upstream/master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2475">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$CURR_BRANCH&quot; != &quot;master&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2476">
          <span class="hits">14</span>
          
          <code class="ruby">    git fetch workspace master:remotes/workspace/master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2477">
          <span class="hits">14</span>
          
          <code class="ruby">    git fetch workspace &quot;${CURR_BRANCH}:remotes/workspace/${CURR_BRANCH}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2478">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2479">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Fetch done.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2480">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2481">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$FETCH_ONLY&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2482">
          <span class="hits">14</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2483">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2484">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2485">
          <span class="hits">14</span>
          
          <code class="ruby">  cleanupMaster() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2486">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2487">
          <span class="hits">14</span>
          
          <code class="ruby">    # heh, need this to always be &#39;true&#39; or &#39;set -e&#39; complains</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2488">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ ! -d _master ]] || git worktree remove _master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2489">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2490">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2491">
          <span class="hits">14</span>
          
          <code class="ruby">  REMOTE_COMMITS=$(git rev-list --right-only --count master...upstream/master)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2492">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $REMOTE_COMMITS &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2493">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Syncing with upstream master...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2494">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${PROJ_DIR}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2495">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$CURR_BRANCH&quot; != &#39;master&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2496">
          <span class="hits">14</span>
          
          <code class="ruby">      (git worktree add _master master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2497">
          <span class="hits">14</span>
          
          <code class="ruby">        || echoerrandexit &quot;Could not create &#39;master&#39; worktree.&quot;) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2498">
          <span class="hits">14</span>
          
          <code class="ruby">      &amp;&amp; { cd _master; git merge remotes/upstream/master; } || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2499">
          <span class="hits">14</span>
          
          <code class="ruby">          { cleanupMaster; echoerrandexit &quot;Could not merge upstream master to local master.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2500">
          <span class="hits">14</span>
          
          <code class="ruby">      MASTER_UPDATED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2501">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2502">
          <span class="hits">14</span>
          
          <code class="ruby">      git pull upstream master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2503">
          <span class="hits">14</span>
          
          <code class="ruby">        || echoerrandexit &quot;There were problems merging upstream master to local master.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2504">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2505">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2506">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Upstream master synced.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2507">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2508">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$CURR_BRANCH&quot; != &quot;master&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2509">
          <span class="hits">14</span>
          
          <code class="ruby">    REMOTE_COMMITS=$(git rev-list --right-only --count master...workspace/master)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2510">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $REMOTE_COMMITS &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2511">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Syncing with workspace master...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2512">
          <span class="hits">14</span>
          
          <code class="ruby">      cd &quot;${PROJ_DIR}/_master&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2513">
          <span class="hits">14</span>
          
          <code class="ruby">      git merge remotes/workspace/master || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2514">
          <span class="hits">14</span>
          
          <code class="ruby">          { cleanupMaster; echoerrandexit &quot;Could not merge upstream master to local master.&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2515">
          <span class="hits">14</span>
          
          <code class="ruby">      MASTER_UPDATED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2516">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2517">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Workspace master synced.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2518">
          <span class="hits">14</span>
          
          <code class="ruby">    cleanupMaster</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2519">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2520">
          <span class="hits">14</span>
          
          <code class="ruby">    REMOTE_COMMITS=$(git rev-list --right-only --count ${CURR_BRANCH}...workspace/${CURR_BRANCH})</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2521">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $REMOTE_COMMITS &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2522">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Synching with workspace workbranch...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2523">
          <span class="hits">14</span>
          
          <code class="ruby">      git pull workspace &quot;${CURR_BRANCH}:remotes/workspace/${CURR_BRANCH}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2524">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2525">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Workspace workbranch synced.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2526">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2527">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$NO_WORK_MASTER_MERGE&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2528">
          <span class="hits">14</span>
          
          <code class="ruby">         &amp;&amp; ( [[ &quot;$MASTER_UPDATED&quot; == true ]] || ! git merge-base --is-ancestor master $CURR_BRANCH ); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2529">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Merging master updates to work branch...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2530">
          <span class="hits">14</span>
          
          <code class="ruby">      git merge master --no-commit --no-ff || true # might fail with conflicts, and that&#39;s OK</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2531">
          <span class="hits">14</span>
          
          <code class="ruby">      if git diff-index --quiet HEAD &quot;${PROJ_DIR}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2532">
          <span class="hits">14</span>
          
          <code class="ruby">         &amp;&amp; git diff --quiet HEAD &quot;${PROJ_DIR}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2533">
          <span class="hits">14</span>
          
          <code class="ruby">        echowarn &quot;Hmm... expected to see changes from master, but none appeared. It&#39;s possible the changes have already been incorporated/recreated without a merge, so this isn&#39;t necessarily an issue, but you may want to double check that everything is as expected.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2534">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2535">
          <span class="hits">14</span>
          
          <code class="ruby">        if ! git diff-index --quiet HEAD &quot;${PROJ_DIR}/dist&quot; || ! git diff --quiet HEAD &quot;${PROJ_DIR}/dist&quot;; then # there are changes in ./dist</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2536">
          <span class="hits">14</span>
          
          <code class="ruby">          echowarn &quot;Backing out merge updates to &#39;./dist&#39;; rebuild to generate current distribution:\nliq projects build $PROJECT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2537">
          <span class="hits">14</span>
          
          <code class="ruby">          git checkout -f HEAD -- ./dist</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2538">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2539">
          <span class="hits">14</span>
          
          <code class="ruby">        if git diff --quiet &quot;${PROJ_DIR}&quot;; then # no conflicts</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2540">
          <span class="hits">14</span>
          
          <code class="ruby">          git add -A</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2541">
          <span class="hits">14</span>
          
          <code class="ruby">          git commit -m &quot;Merge updates from master to workbranch.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2542">
          <span class="hits">14</span>
          
          <code class="ruby">          work-save --backup-only</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2543">
          <span class="hits">14</span>
          
          <code class="ruby">          echo &quot;Master updates merged to workbranch.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2544">
          <span class="hits">14</span>
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2545">
          <span class="hits">14</span>
          
          <code class="ruby">          echowarn &quot;Merge was successful, but conflicts exist. Please resolve and then save changes:\nliq work save&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2546">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2547">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2548">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2549">
          <span class="hits">14</span>
          
          <code class="ruby">  fi # on workbranach check</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2550">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2551">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2552">
          <span class="hits">14</span>
          
          <code class="ruby"># see: liq help projects test</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2553">
          <span class="hits">14</span>
          
          <code class="ruby">projects-test() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2554">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions TYPES= NO_DATA_RESET:D GO_RUN= NO_START:S NO_SERVICE_CHECK:C -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2555">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2556">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2557">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${NO_SERVICE_CHECK}&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2558">
          <span class="hits">14</span>
          
          <code class="ruby">     &amp;&amp; ( [[ -z &quot;${TEST_TYPES:-}&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2559">
          <span class="hits">14</span>
          
          <code class="ruby">       || echo &quot;$TEST_TYPES&quot; | grep -qE &#39;(^|, *| +)int(egration)?(, *| +|$)&#39; ); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2560">
          <span class="hits">14</span>
          
          <code class="ruby">    if type -t projects-services-list | grep -q &#39;function&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2561">
          <span class="hits">14</span>
          
          <code class="ruby">      requireEnvironment</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2562">
          <span class="hits">14</span>
          
          <code class="ruby">      echo -n &quot;Checking services... &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2563">
          <span class="hits">14</span>
          
          <code class="ruby">      if ! projects-services-list --show-status --exit-on-stopped --quiet &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2564">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -z &quot;${NO_START:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2565">
          <span class="hits">14</span>
          
          <code class="ruby">          services-start || echoerrandexit &quot;Could not start services for testing.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2566">
          <span class="hits">14</span>
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2567">
          <span class="hits">14</span>
          
          <code class="ruby">          echo &quot;${red}necessary services not running.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2568">
          <span class="hits">14</span>
          
          <code class="ruby">          echoerrandexit &quot;Some services are not running. You can either run unit tests are start services. Try one of the following:\nliq projects test --types=unit\nliq services start&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2569">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2570">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2571">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;${green}looks good.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2572">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2573">
          <span class="hits">14</span>
          
          <code class="ruby">    fi # check if runtime extesions present</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2574">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2575">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2576">
          <span class="hits">14</span>
          
          <code class="ruby">  # note this entails &#39;pretest&#39; and &#39;posttest&#39; as well</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2577">
          <span class="hits">14</span>
          
          <code class="ruby">  TEST_TYPES=&quot;$TYPES&quot; NO_DATA_RESET=&quot;$NO_DATA_RESET&quot; GO_RUN=&quot;$GO_RUN&quot; projectsRunPackageScript test || \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2578">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;If failure due to non-running services, you can also run only the unit tests with:\nliq projects test --type=unit&quot; $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2579">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="2580">
          <span class="hits">8</span>
          
          <code class="ruby">PROJECTS_GROUPS=&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2581">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2582">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects() {</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2583">
          <span class="hits">1</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2584">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2585">
          <span class="hits">1</span>
          
          <code class="ruby">  local SUMMARY=&quot;Project configuration and tools.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2586">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="2587">
          <span class="hits">5</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}projects${reset} &lt;action&gt;: ${SUMMARY}&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2588">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}projects${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2589">
          <span class="hits">14</span>
          
          <code class="ruby">  ${SUMMARY}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2590">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list projects build close create import publish qa sync test | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2591">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-sub-group-list projects PROJECTS_GROUPS)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2592">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2593">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2594">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2595">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-build() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2596">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary build &quot;[&lt;name&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2597">
          <span class="hits">14</span>
          
          <code class="ruby">Builds the current or specified project(s).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2598">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2599">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2600">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2601">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-close() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2602">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary close &quot;[&lt;name&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2603">
          <span class="hits">14</span>
          
          <code class="ruby">Closes (deletes from playground) either the current or named project after checking that all changes are committed and pushed. &#39;--force&#39; will skip the &#39;up-to-date checks.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2604">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2605">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2606">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2607">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-create() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2608">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary create &quot;[[--new &lt;type&gt;] || [--source|-s &lt;pkg|URL&gt;] [--follow|-f]] [--no-fork|-F] [--version|-v &lt;semver&gt; ] [--license|-l &lt;license name&gt;] [--description|-d &lt;desc&gt;] [--public] [&lt;project name&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2609">
          <span class="hits">14</span>
          
          <code class="ruby">Note, &#39;project name&#39; should be a bare name. The scope is determined by the current org settings. An explicit name is required for &#39;--new&#39; projects. If no name is given for &#39;--source&#39; projects, then the base source name is used.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2610">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2611">
          <span class="hits">14</span>
          
          <code class="ruby">Creates a new Liquid project in one of two modes. If &#39;--new&#39; is specified, then the indicated type will be used to initiate a &#39;create&#39; script. There are various &#39;@liquid-labs/create-*&#39; projects which may be used, and third-party or private scripts may developed as well. This essentially calls &#39;npm init &lt;type&gt;&#39; and then sets up the GitHub repository and working repo (unless --no-fork is specified).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2612">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2613">
          <span class="hits">14</span>
          
          <code class="ruby">The &#39;raw&#39; type is a built-in type that initiates a completly raw repo with just minimal &#39;package.json&#39; defintion. The package attributes will be configured based on parameters with the version defaulting to &#39;1.0.0-alpha.0&#39; and &#39;license&#39; defaulting to &#39;UNLICENSED&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2614">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2615">
          <span class="hits">14</span>
          
          <code class="ruby">If &#39;--source&#39; is specified, will first clone the source repo as a starting point. This can be used to &quot;convert&quot; non-Liquid projects (from GitHub or other sources) as well as to create re-named duplicates of Liquid projects If set to &#39;--follow&#39; the source, then this effectively sets up a &#39;source&#39; remote conceptually upstream from &#39;upstream&#39; and future invocations of &#39;project sync&#39; will attempt to merge changes from &#39;source&#39; to &#39;upstream&#39;. This can later be managed using the &#39;projects remotes&#39; sub-group.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2616">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2617">
          <span class="hits">14</span>
          
          <code class="ruby">Regardless, the following &#39;package.json&#39; fields will be set according to the following:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2618">
          <span class="hits">14</span>
          
          <code class="ruby">* the package will be scoped accourding to the org scope.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2619">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;project name&#39; will be used to create a git repository under the org scope.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2620">
          <span class="hits">14</span>
          
          <code class="ruby">* the &#39;repository&#39; and &#39;bugs&#39; fields will be set to match.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2621">
          <span class="hits">14</span>
          
          <code class="ruby">* the &#39;homepage&#39; will be set to the repo &#39;README.md&#39; (#readme).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2622">
          <span class="hits">14</span>
          
          <code class="ruby">* version to &#39;--version&#39;, otherwise &#39;1.0.0&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2623">
          <span class="hits">14</span>
          
          <code class="ruby">* license to the &#39;--license&#39;, otherwise org&#39;s default license, otherwise &#39;UNLICENSED&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2624">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2625">
          <span class="hits">14</span>
          
          <code class="ruby">Any compatible create script must conform to the above, though additional rules and/or interactions may added. Note, just because no option is given to change some of the above parameters they can, of course, be modified post-create (though they are &quot;very standard&quot; for Liquid projects).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2626">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2627">
          <span class="hits">14</span>
          
          <code class="ruby">Use &#39;liq projects import&#39; to import an existing project from a URL.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2628">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2629">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2630">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2631">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-deploy() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2632">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary deploy &quot;[&lt;name&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2633">
          <span class="hits">14</span>
          
          <code class="ruby">Deploys the current or named project(s).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2634">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2635">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2636">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2637">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-edit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2638">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary edit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2639">
          <span class="hits">14</span>
          
          <code class="ruby">Opens a local project editor from the project root directory. Users may set `LIQ_EDITOR_CMD` to launch their project editor. The command is:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2640">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2641">
          <span class="hits">14</span>
          
          <code class="ruby">atom .</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2642">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2643">
          <span class="hits">14</span>
          
          <code class="ruby">The command is run from the project root.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2644">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2645">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2646">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2647">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-import() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2648">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary import &quot;[--no-install] &lt;package or URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2649">
          <span class="hits">14</span>
          
          <code class="ruby">Imports the indicated package into your playground. The newly imported package will be installed unless &#39;--no-install&#39; is given.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2650">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2651">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2652">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2653">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-publish() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2654">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary publish</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2655">
          <span class="hits">14</span>
          
          <code class="ruby">Performs verification tests, updates package version, and publishes package.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2656">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2657">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2658">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2659">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-qa() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2660">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary qa &quot;[--update|-u] [--audit|-a] [--lint|-l] [--version-check|-v]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2661">
          <span class="hits">14</span>
          
          <code class="ruby">Performs NPM audit, eslint, and NPM version checks. By default, all three checks are performed, but options can be used to select specific checks. The &#39;--update&#39; option instruct to the selected options to attempt updates/fixes.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2662">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2663">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2664">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2665">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-sync() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2666">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary sync &quot;[--fetch-only|-f] [--no-work-master-merge|-M]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2667">
          <span class="hits">14</span>
          
          <code class="ruby">Updates the remote master with new commits from upstream/master and, if currently on a work branch, workspace/master and workspace/&lt;workbranch&gt; and then merges those updates with the current workbranch (if any). &#39;--fetch-only&#39; will update the appropriate remote refs, and exit. --no-work-master-merge update the local master branch and pull the workspace workbranch, but skips merging the new master updates to the workbranch.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2668">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2669">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2670">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2671">
          <span class="hits">14</span>
          
          <code class="ruby">help-projects-test() {</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="2672">
          <span class="hits">2</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary test &quot;[-t|--types &lt;types&gt;][-D|--no-data-reset][-g|--go-run &lt;testregex&gt;][--no-start|-S] [&lt;name&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2673">
          <span class="hits">14</span>
          
          <code class="ruby">Runs unit tests the current or named projects.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2674">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;types&#39; may be &#39;unit&#39; or &#39;integration&#39; (==&#39;int&#39;) or &#39;all&#39;, which is default. Multiple tests may be specified in a comma delimited list. E.g., &#39;-t=unit,int&#39; is equivalent no type or &#39;-t=&quot;&quot;&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2675">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;--no-start&#39; will skip tryng to start necessary services.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2676">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;--no-data-reset&#39; will cause the standard test DB reset to be skipped.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2677">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;--no-service-check&#39; will skip checking service status. This is useful when re-running tests and the services are known to be running.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2678">
          <span class="hits">14</span>
          
          <code class="ruby">* &#39;--go-run&#39; will only run those tests matching the provided regex (per go &#39;-run&#39; standards).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2679">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2680">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2681">
          <span class="hits">14</span>
          
          <code class="ruby">projectCheckIfInPlayground() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2682">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_NAME=&quot;${1/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2683">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -d &quot;${LIQ_PLAYGROUND}/${PROJ_NAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2684">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;&#39;$PROJ_NAME&#39; is already in the playground.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2685">
          <span class="hits">14</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2686">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2687">
          <span class="hits">14</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2688">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2689">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2690">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2691">
          <span class="hits">14</span>
          
          <code class="ruby">projectsGetUpstreamUrl() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2692">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_NAME=&quot;${1/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2693">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2694">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2695">
          <span class="hits">14</span>
          
          <code class="ruby">  git config --get remote.upstream.url \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2696">
          <span class="hits">14</span>
          
          <code class="ruby">		|| echoerrandexit &quot;Failed to get upstream remote URL for ${LIQ_PLAYGROUND}/${PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2697">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2698">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2699">
          <span class="hits">14</span>
          
          <code class="ruby"># expects STAGING and PROJ_STAGE to be set declared by caller(s)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2700">
          <span class="hits">14</span>
          
          <code class="ruby">projectResetStaging() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2701">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2702">
          <span class="hits">14</span>
          
          <code class="ruby">  STAGING=&quot;${LIQ_PLAYGROUND}/.staging&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2703">
          <span class="hits">14</span>
          
          <code class="ruby">  rm -rf &quot;${STAGING}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2704">
          <span class="hits">14</span>
          
          <code class="ruby">  mkdir -p &quot;${STAGING}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2705">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2706">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJ_STAGE=&quot;$PROJ_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2707">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJ_STAGE=&quot;${PROJ_STAGE%.*}&quot; # remove &#39;.git&#39; if present</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2708">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJ_STAGE=&quot;${STAGING}/${PROJ_STAGE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2709">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2710">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2711">
          <span class="hits">14</span>
          
          <code class="ruby"># Expects &#39;PROJ_STAGE&#39; to be declared local by the caller.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2712">
          <span class="hits">14</span>
          
          <code class="ruby">projectClone() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2713">
          <span class="hits">14</span>
          
          <code class="ruby">  local URL=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2714">
          <span class="hits">14</span>
          
          <code class="ruby">  local ORIGIN_NAME=&quot;${2:-upstream}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2715">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2716">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2717">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2718">
          <span class="hits">14</span>
          
          <code class="ruby">  local STAGING</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2719">
          <span class="hits">14</span>
          
          <code class="ruby">  projectResetStaging $(basename &quot;$URL&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2720">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;$STAGING&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2721">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2722">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Cloning &#39;${ORIGIN_NAME}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2723">
          <span class="hits">14</span>
          
          <code class="ruby">  git clone --quiet --origin &quot;$ORIGIN_NAME&quot; &quot;${URL}&quot; || echoerrandexit &quot;Failed to clone.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2724">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2725">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -d &quot;$PROJ_STAGE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2726">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Did not find expected project direcotry &#39;$PROJ_STAGE&#39; in staging after cloning repo.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2727">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2728">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2729">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2730">
          <span class="hits">14</span>
          
          <code class="ruby"># Returns true if the current working project has the dependency as either dep, dev, or peer.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2731">
          <span class="hits">14</span>
          
          <code class="ruby">projects-lib-has-any-dep() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2732">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2733">
          <span class="hits">14</span>
          
          <code class="ruby">  local DEP=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2734">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2735">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &quot;${LIQ_PLAYGROUND}/${PROJ/@/}/package.json&quot; | jq -r &#39;.dependencies + .devDependencies + .peerDependencies + {} | keys&#39; | grep -qE &#39;&quot;@?&#39;${DEP}&#39;&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2736">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2737">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2738">
          <span class="hits">14</span>
          
          <code class="ruby">projectHubWhoami() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2739">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2740">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2741">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -f ~/.config/hub ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2742">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Need to establish GitHub connection...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2743">
          <span class="hits">14</span>
          
          <code class="ruby">    hub api https://api.github.com/user &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2744">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2745">
          <span class="hits">14</span>
          
          <code class="ruby">  local WHOAMI</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2746">
          <span class="hits">14</span>
          
          <code class="ruby">  WHOAMI=$(cat ~/.config/hub | grep &#39;user:&#39; | sed &#39;s/^[[:space:]]*-[[:space:]]*user:[[:space:]]*//&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2747">
          <span class="hits">14</span>
          
          <code class="ruby">  eval $VAR_NAME=$WHOAMI</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2748">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2749">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2750">
          <span class="hits">14</span>
          
          <code class="ruby">projectForkClone() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2751">
          <span class="hits">14</span>
          
          <code class="ruby">  local URL=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2752">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2753">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2754">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2755">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_NAME ORG_URL GITHUB_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2756">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJ_NAME=$(basename &quot;$URL&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2757">
          <span class="hits">14</span>
          
          <code class="ruby">  ORG_URL=$(dirname &quot;$URL&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2758">
          <span class="hits">14</span>
          
          <code class="ruby">  projectHubWhoami GITHUB_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2759">
          <span class="hits">14</span>
          
          <code class="ruby">  FORK_URL=&quot;$(echo &quot;$ORG_URL&quot; | sed &#39;s|[a-zA-Z0-9-]*$||&#39;)/${GITHUB_NAME}/${PROJ_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2760">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2761">
          <span class="hits">14</span>
          
          <code class="ruby">  local STAGING</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2762">
          <span class="hits">14</span>
          
          <code class="ruby">  projectResetStaging $PROJ_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2763">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;$STAGING&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2764">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2765">
          <span class="hits">14</span>
          
          <code class="ruby">  echo -n &quot;Checking for existing fork at &#39;${FORK_URL}&#39;... &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2766">
          <span class="hits">14</span>
          
          <code class="ruby">  git clone --quiet --origin workspace &quot;${FORK_URL}&quot; 2&gt; /dev/null \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2767">
          <span class="hits">14</span>
          
          <code class="ruby">  &amp;&amp; { \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2768">
          <span class="hits">14</span>
          
          <code class="ruby">    # Be sure and exit on errors to avoid a failure here and then executing the || branch</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2769">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;found existing fork.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2770">
          <span class="hits">14</span>
          
          <code class="ruby">    cd $PROJ_STAGE || echoerrandexit &quot;Did not find expected staging dir: $PROJ_STAGE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2771">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Updating remotes...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2772">
          <span class="hits">14</span>
          
          <code class="ruby">    git remote add upstream &quot;$URL&quot; || echoerrandexit &quot;Problem setting upstream URL.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2773">
          <span class="hits">14</span>
          
          <code class="ruby">    git fetch upstream || echoerrandexit &quot;Could not fetch upstream data.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2774">
          <span class="hits">14</span>
          
          <code class="ruby">    git branch -u upstream/master master || echoerrandexit &quot;Failed to configure upstream master.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2775">
          <span class="hits">14</span>
          
          <code class="ruby">    git pull || echoerrandexit &quot;Failed to pull from upstream master.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2776">
          <span class="hits">14</span>
          
          <code class="ruby">  } \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2777">
          <span class="hits">14</span>
          
          <code class="ruby">  || { \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2778">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;none found; cloning source.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2779">
          <span class="hits">14</span>
          
          <code class="ruby">    local GITHUB_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2780">
          <span class="hits">14</span>
          
          <code class="ruby">    git clone --quiet --origin upstream &quot;${URL}&quot; || echoerrandexit &quot;Could not clone source.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2781">
          <span class="hits">14</span>
          
          <code class="ruby">    cd $PROJ_STAGE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2782">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Creating fork...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2783">
          <span class="hits">14</span>
          
          <code class="ruby">    hub fork --remote-name workspace &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2784">
          <span class="hits">14</span>
          
          <code class="ruby">    git branch --quiet -u upstream/master master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2785">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2786">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2787">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2788">
          <span class="hits">14</span>
          
          <code class="ruby"># Expects caller to have defined PROJ_NAME and PROJ_STAGE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2789">
          <span class="hits">14</span>
          
          <code class="ruby">projectMoveStaged() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2790">
          <span class="hits">14</span>
          
          <code class="ruby">  local NPM_ORG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2791">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_NAME=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2792">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ_STAGE=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2793">
          <span class="hits">14</span>
          
          <code class="ruby">  NPM_ORG=&quot;$(dirname &quot;$PROJ_NAME&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2794">
          <span class="hits">14</span>
          
          <code class="ruby">  NPM_ORG=&quot;${NPM_ORG/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2795">
          <span class="hits">14</span>
          
          <code class="ruby">  mkdir -p &quot;${LIQ_PLAYGROUND}/${NPM_ORG}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2796">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Moving staging dir to playground...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2797">
          <span class="hits">14</span>
          
          <code class="ruby">  mv &quot;$PROJ_STAGE&quot; &quot;$LIQ_PLAYGROUND/${NPM_ORG}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2798">
          <span class="hits">14</span>
          
          <code class="ruby">    || echoerrandexit &quot;Could not moved staged &#39;$PROJ_NAME&#39; to playground. See above for details.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2799">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2800">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2801">
          <span class="hits">14</span>
          
          <code class="ruby">projectsRunPackageScript() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2802">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions IGNORE_MISSING SCRIPT_ONLY -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2803">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2804">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2805">
          <span class="hits">14</span>
          
          <code class="ruby">  local ACTION=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2806">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2807">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${BASE_DIR}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2808">
          <span class="hits">14</span>
          
          <code class="ruby">  if cat package.json | jq -e &quot;(.scripts | keys | map(select(. == \&quot;$ACTION\&quot;)) | length) == 1&quot; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2809">
          <span class="hits">14</span>
          
          <code class="ruby">    npm run-script &quot;${ACTION}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2810">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$SCRIPT_ONLY&quot; ]] &amp;&amp; [[ -z &quot;$IGNORE_MISSING&quot; ]]; then # SCRIPT_ONLY is a temp. workaround to implement future behaior. See note below.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2811">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Did not find expected NPM script for &#39;$ACTION&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2812">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -z &quot;$SCRIPT_ONLY&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2813">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: drop this; require that the package interface with catalyst-scripts</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2814">
          <span class="hits">14</span>
          
          <code class="ruby">    # through the the &#39;package-scripts&#39;. This will avoid confusion and also</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2815">
          <span class="hits">14</span>
          
          <code class="ruby">    # allow &quot;plain npm&quot; to run more of what can be run. It will also allow users</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2816">
          <span class="hits">14</span>
          
          <code class="ruby">    # to override the scripts if they really want to. (But we should catch) that</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2817">
          <span class="hits">14</span>
          
          <code class="ruby">    # on an audit.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2818">
          <span class="hits">14</span>
          
          <code class="ruby">    local CATALYST_SCRIPTS=$(npm bin)/catalyst-scripts</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2819">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ ! -x &quot;$CATALYST_SCRIPTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2820">
          <span class="hits">14</span>
          
          <code class="ruby">      # TODO: offer to install and re-run</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2821">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerr &quot;This project does not appear to be using &#39;catalyst-scripts&#39;. Try:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2822">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerr &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2823">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;npm install --save-dev @liquid-labs/catalyst-scripts&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2824">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2825">
          <span class="hits">14</span>
          
          <code class="ruby">    # kill the debug trap because if the script exits with an error (as in a</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2826">
          <span class="hits">14</span>
          
          <code class="ruby">    # failed lint), that&#39;s OK and the debug doesn&#39;t provide any useful info.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2827">
          <span class="hits">14</span>
          
          <code class="ruby">    &quot;${CATALYST_SCRIPTS}&quot; &quot;${BASE_DIR}&quot; $ACTION || true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2828">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2829">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2830">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2831">
          <span class="hits">14</span>
          
          <code class="ruby"># Accepts single NPM package name and exports &#39;PKG_ORG_NAME&#39; and &#39;PKG_BASENAME&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2832">
          <span class="hits">14</span>
          
          <code class="ruby">projectsSetPkgNameComponents() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2833">
          <span class="hits">14</span>
          
          <code class="ruby">  PKG_ORG_NAME=&quot;$(dirname ${1/@/})&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2834">
          <span class="hits">14</span>
          
          <code class="ruby">  PKG_BASENAME=&quot;$(basename &quot;$1&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2835">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="2836">
          <span class="hits">8</span>
          
          <code class="ruby">_QA_OPTIONS_SPEC=&quot;UPDATE OPTIONS=&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2837">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2838">
          <span class="hits">14</span>
          
          <code class="ruby">## Main lib functions</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2839">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2840">
          <span class="hits">14</span>
          
          <code class="ruby"># Assumes we are already in the BASE_DIR of the target project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2841">
          <span class="hits">14</span>
          
          <code class="ruby">projectsNpmAudit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2842">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions $_QA_OPTIONS_SPEC -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2843">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2844">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2845">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$UPDATE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2846">
          <span class="hits">14</span>
          
          <code class="ruby">    npm audit fix</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2847">
          <span class="hits">14</span>
          
          <code class="ruby">  else npm audit; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2848">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2849">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2850">
          <span class="hits">14</span>
          
          <code class="ruby"># Assumes we are already in the BASE_DIR of the target project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2851">
          <span class="hits">14</span>
          
          <code class="ruby">projectsLint() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2852">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions $_QA_OPTIONS_SPEC -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2853">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2854">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2855">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$UPDATE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2856">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsRunPackageScript lint</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2857">
          <span class="hits">14</span>
          
          <code class="ruby">  else projectsRunPackageScript lint-fix; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2858">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2859">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2860">
          <span class="hits">14</span>
          
          <code class="ruby"># Runs checks that &#39;package.json&#39; conforms to Liquid Project standards. This is very much non-exhaustive.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2861">
          <span class="hits">14</span>
          
          <code class="ruby">projectsLiqCheck() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2862">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2863">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! [[ -f &quot;${BASE_DIR}/package.json&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2864">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &quot;No &#39;package.json&#39; found.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2865">
          <span class="hits">14</span>
          
          <code class="ruby">    return 1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2866">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2867">
          <span class="hits">14</span>
          
          <code class="ruby">  local ORG_BASE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2868">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2869">
          <span class="hits">14</span>
          
          <code class="ruby">  ORG_BASE=&quot;$(cat &quot;${BASE_DIR}/package.json&quot; | jq &quot;.${LIQ_NPM_KEY}.orgBase&quot; | tr -d &#39;&quot;&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2870">
          <span class="hits">14</span>
          
          <code class="ruby">  # no idea why, but this is outputting &#39;null&#39; on blanks, even though direct testing doesn&#39;t</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2871">
          <span class="hits">14</span>
          
          <code class="ruby">  ORG_BASE=${ORG_BASE/null/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2872">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$ORG_BASE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2873">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: provide reference to docs.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2874">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &quot;Did not find &#39;.${LIQ_NPM_KEY}.orgBase&#39; in &#39;package.json&#39;. Add this to your &#39;package.json&#39; to define the NPM package name or URL pointing to the base, public org repository.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2875">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2876">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2877">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2878">
          <span class="hits">14</span>
          
          <code class="ruby">projectsVersionCheck() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2879">
          <span class="hits">14</span>
          
          <code class="ruby">  projectsRequireNpmCheck</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2880">
          <span class="hits">14</span>
          
          <code class="ruby">  # we are temporarily disabling the config manegement options</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2881">
          <span class="hits">14</span>
          
          <code class="ruby">  # see https://github.com/Liquid-Labs/liq-cli/issues/94</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2882">
          <span class="hits">14</span>
          
          <code class="ruby">  # IGNORE UNIGNORE:I SHOW_CONFIG:c UPDATE OPTIONS=</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2883">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions $_QA_OPTIONS_SPEC IGNORE UNIGNORE:I SHOW_CONFIG:c UPDATE OPTIONS= -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2884">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( help-projects; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2885">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2886">
          <span class="hits">14</span>
          
          <code class="ruby">  local IGNORED_PACKAGES=&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2887">
          <span class="hits">14</span>
          
          <code class="ruby">  # the &#39;@sh&#39; breaks &#39;-e&#39;; https://github.com/stedolan/jq/issues/1792</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2888">
          <span class="hits">14</span>
          
          <code class="ruby">  if echo &quot;$PACKAGE&quot; | jq -e --raw-output &#39;.catalyst.&quot;version-check&quot;.ignore&#39; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2889">
          <span class="hits">14</span>
          
          <code class="ruby">    IGNORED_PACKAGES=`echo &quot;$PACKAGE&quot; | jq --raw-output &#39;.catalyst.&quot;version-check&quot;.ignore | @sh&#39; | tr -d &quot;&#39;&quot; | sort`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2890">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2891">
          <span class="hits">14</span>
          
          <code class="ruby">  local CMD_OPTS=&quot;$OPTIONS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2892">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$CMD_OPTS&quot; ]] &amp;&amp; echo &quot;$PACKAGE&quot; | jq -e --raw-output &#39;.catalyst.&quot;version-check&quot;.options&#39; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2893">
          <span class="hits">14</span>
          
          <code class="ruby">    CMD_OPTS=`echo &quot;$PACKAGE&quot; | jq --raw-output &#39;.catalyst.&quot;version-check&quot;.options&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2894">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2895">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2896">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$UPDATE&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2897">
          <span class="hits">14</span>
          
          <code class="ruby">      &amp;&amp; ( (( ${_OPTS_COUNT} &gt; 2 )) || ( (( ${_OPTS_COUNT} == 2 )) &amp;&amp; [[ -z $OPTIONS_SET ]]) ); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2898">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;&#39;--update&#39; option may only be combined with &#39;--options&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2899">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$IGNORE&quot; ]] || [[ -n &quot;$UNIGNORE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2900">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$IGNORE&quot; ]] &amp;&amp; [[ -n &quot;$UNIGNORE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2901">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Cannot &#39;ignore&#39; and &#39;unignore&#39; projects in same command.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2902">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2903">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2904">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheckManageIgnored</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2905">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$SHOW_CONFIG&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2906">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheckShowConfig</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2907">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$OPTIONS_SET&quot; ]] &amp;&amp; (( $_OPTS_COUNT == 1 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2908">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheckSetOptions</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2909">
          <span class="hits">14</span>
          
          <code class="ruby">  else # actually do the check</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2910">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheckDo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2911">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2912">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2913">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2914">
          <span class="hits">14</span>
          
          <code class="ruby">## helper functions</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2915">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2916">
          <span class="hits">14</span>
          
          <code class="ruby">projectsRequireNpmCheck() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2917">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: offer to install</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2918">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! which -s npm-check; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2919">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &quot;&#39;npm-check&#39; not found; could not check package status. Install with:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2920">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2921">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &#39;    npm install -g npm-check&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2922">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerr &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2923">
          <span class="hits">14</span>
          
          <code class="ruby">    exit 10</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2924">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2925">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2926">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2927">
          <span class="hits">14</span>
          
          <code class="ruby">projectsVersionCheckManageIgnored() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2928">
          <span class="hits">14</span>
          
          <code class="ruby">  local IPACKAGES IPACKAGE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2929">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$IGNORE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2930">
          <span class="hits">14</span>
          
          <code class="ruby">    local LIVE_PACKAGES=`echo &quot;$PACKAGE&quot; | jq --raw-output &#39;.dependencies | keys | @sh&#39; | tr -d &quot;&#39;&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2931">
          <span class="hits">14</span>
          
          <code class="ruby">    for IPACKAGE in $IGNORED_PACKAGES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2932">
          <span class="hits">14</span>
          
          <code class="ruby">      LIVE_PACKAGES=$(echo &quot;$LIVE_PACKAGES&quot; | sed -Ee &#39;s~(^| +)&#39;$IPACKAGE&#39;( +|$)~~&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2933">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2934">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $# == 0 )); then # interactive add</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2935">
          <span class="hits">14</span>
          
          <code class="ruby">      PS3=&quot;Exclude package: &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2936">
          <span class="hits">14</span>
          
          <code class="ruby">      selectDoneCancel IPACKAGES LIVE_PACKAGES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2937">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2938">
          <span class="hits">14</span>
          
          <code class="ruby">      IPACKAGES=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2939">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2940">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2941">
          <span class="hits">14</span>
          
          <code class="ruby">    for IPACKAGE in $IPACKAGES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2942">
          <span class="hits">14</span>
          
          <code class="ruby">      if echo &quot;$IGNORED_PACKAGES&quot; | grep -Eq &#39;(^| +)&#39;$IPACKAGE&#39;( +|$)&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2943">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;Package &#39;$IPACKAGE&#39; already ignored.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2944">
          <span class="hits">14</span>
          
          <code class="ruby">      elif ! echo &quot;$LIVE_PACKAGES&quot; | grep -Eq &#39;(^| +)&#39;$IPACKAGE&#39;( +|$)&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2945">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;No such package &#39;$IPACKAGE&#39; in dependencies.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2946">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2947">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -z &quot;$IGNORED_PACKAGES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2948">
          <span class="hits">14</span>
          
          <code class="ruby">          PACKAGE=`echo &quot;$PACKAGE&quot; | jq &#39;setpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;ignore&quot;]; [&quot;&#39;$IPACKAGE&#39;&quot;])&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2949">
          <span class="hits">14</span>
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2950">
          <span class="hits">14</span>
          
          <code class="ruby">          PACKAGE=`echo &quot;$PACKAGE&quot; | jq &#39;setpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;ignore&quot;]; getpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;ignore&quot;]) + [&quot;&#39;$IPACKAGE&#39;&quot;])&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2951">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2952">
          <span class="hits">14</span>
          
          <code class="ruby">        IGNORED_PACKAGES=&quot;${IGNORED_PACKAGES} ${IPACKAGE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2953">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2954">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2955">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$UNIGNORE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2956">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$IGNORED_PACKAGES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2957">
          <span class="hits">14</span>
          
          <code class="ruby">      if (( $# &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2958">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;No projects currently ignored.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2959">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2960">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;No projects currently ignored.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2961">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2962">
          <span class="hits">14</span>
          
          <code class="ruby">      exit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2963">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2964">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $# == 0 )); then # interactive add</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2965">
          <span class="hits">14</span>
          
          <code class="ruby">      PS3=&quot;Include package: &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2966">
          <span class="hits">14</span>
          
          <code class="ruby">      selectDoneCancelAll IPACKAGES IGNORED_PACKAGES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2967">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2968">
          <span class="hits">14</span>
          
          <code class="ruby">      IPACKAGES=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2969">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2970">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2971">
          <span class="hits">14</span>
          
          <code class="ruby">    for IPACKAGE in $IPACKAGES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2972">
          <span class="hits">14</span>
          
          <code class="ruby">      if ! echo &quot;$IGNORED_PACKAGES&quot; | grep -Eq &#39;(^| +)&#39;$IPACKAGE&#39;( +|$)&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2973">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;Package &#39;$IPACKAGE&#39; is not currently ignored.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2974">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2975">
          <span class="hits">14</span>
          
          <code class="ruby">        PACKAGE=`echo &quot;$PACKAGE&quot; | jq &#39;setpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;ignore&quot;]; getpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;ignore&quot;]) | map(select(. != &quot;&#39;$IPACKAGE&#39;&quot;)))&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2976">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2977">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2978">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2979">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2980">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: cleanup empty bits</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2981">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; &gt; &quot;$PACKAGE_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2982">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2983">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$SHOW_CONFIG&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2984">
          <span class="hits">14</span>
          
          <code class="ruby">    projectsVersionCheck -c</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2985">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2986">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2987">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2988">
          <span class="hits">14</span>
          
          <code class="ruby">projectsVersionCheckShowConfig() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2989">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$IGNORED_PACKAGES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2990">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Ignored projects: none&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2991">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2992">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Ignored projects:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2993">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$IGNORED_PACKAGES&quot; | tr &quot; &quot; &quot;\n&quot; | sed -E &#39;s/^/  /&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2994">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2995">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$CMD_OPTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2996">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Additional options: none&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2997">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2998">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Additional options: $CMD_OPTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="2999">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3000">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3001">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3002">
          <span class="hits">14</span>
          
          <code class="ruby">projectsVersionCheckSetOptions() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3003">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$OPTIONS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3004">
          <span class="hits">14</span>
          
          <code class="ruby">    PACKAGE=$(echo &quot;$PACKAGE&quot; | jq &#39;setpath([&quot;catalyst&quot;,&quot;version-check&quot;,&quot;options&quot;]; &quot;&#39;$OPTIONS&#39;&quot;)&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3005">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -z &quot;$OPTIONS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3006">
          <span class="hits">14</span>
          
          <code class="ruby">    PACKAGE=$(echo &quot;$PACKAGE&quot; | jq &#39;del(.catalyst.&quot;version-check&quot;.options)&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3007">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3008">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; &gt; &quot;$PACKAGE_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3009">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3010">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3011">
          <span class="hits">14</span>
          
          <code class="ruby">projectsVersionCheckDo() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3012">
          <span class="hits">14</span>
          
          <code class="ruby">  for IPACKAGE in $IGNORED_PACKAGES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3013">
          <span class="hits">14</span>
          
          <code class="ruby">    CMD_OPTS=&quot;${CMD_OPTS} -i ${IPACKAGE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3014">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3015">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$UPDATE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3016">
          <span class="hits">14</span>
          
          <code class="ruby">    CMD_OPTS=&quot;${CMD_OPTS} -u&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3017">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3018">
          <span class="hits">14</span>
          
          <code class="ruby">  npm-check ${CMD_OPTS} || true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3019">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3020">
          <span class="hits">14</span>
          
          <code class="ruby"># Expects:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3021">
          <span class="hits">14</span>
          
          <code class="ruby"># * NO_DELETE_LABELS, PROJECT, NO_UPDATE_LABELS from options, and</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3022">
          <span class="hits">14</span>
          
          <code class="ruby"># * GIT_BASE and PACKAGE to be set.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3023">
          <span class="hits">14</span>
          
          <code class="ruby">projects-lib-setup-labels-sync() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3024">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Setting up labels...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3025">
          <span class="hits">14</span>
          
          <code class="ruby">  local ORG_BASE ORG_PROJECT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3026">
          <span class="hits">14</span>
          
          <code class="ruby">  ORG_BASE=&quot;$(echo &quot;${PACKAGE}&quot; | jq -r &quot;.${LIQ_NPM_KEY}.orgBase&quot; )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3027">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;${ORG_BASE}&quot; == *&#39;github.com&#39;*&#39;git&#39; ]]; then # it&#39;s a git URL; convert to project name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3028">
          <span class="hits">14</span>
          
          <code class="ruby">    # separate the path element from the URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3029">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_PROJECT=&quot;$(echo &quot;${ORG_BASE}&quot; | cut -d: -f2 )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3030">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_PROJECT=&quot;${ORG_PROJECT:0:$(( ${#ORG_PROJECT} - 4 ))}&quot; # remove &#39;.git&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3031">
          <span class="hits">14</span>
          
          <code class="ruby">    local ORG_BIT PROJ_BIT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3032">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: our defacto conventions are all over the place</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3033">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_BIT=&quot;$(echo &quot;${ORG_PROJECT}&quot; | cut -d/ -f1 | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3034">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJ_BIT=&quot;$(echo &quot;${ORG_PROJECT}&quot; | cut -d/ -f2)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3035">
          <span class="hits">14</span>
          
          <code class="ruby">    ORG_PROJECT=&quot;${ORG_BIT}/${PROJ_BIT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3036">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3037">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;&#39;${LIQ_NPM_KEY}.orgBase&#39; from &#39;package.json&#39; in unknown format.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3038">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3039">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3040">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! [[ -d &quot;${LIQ_PLAYGROUND}/${ORG_PROJECT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3041">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: support &#39;--import-org&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3042">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Org def project &#39;${ORG_PROJECT}&#39; not found locally. Try:\nliq projects import ${ORG_BASE}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3043">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3044">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_PLAYGROUND}/${ORG_PROJECT}/data/orgs/settings.sh&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3045">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${PROJECT_LABELS:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3046">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;  No project labels defined; using default label set...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3047">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT_LABELS=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3048">
          <span class="hits">14</span>
          
          <code class="ruby">bounty:This task offers a bounty:209020</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3049">
          <span class="hits">14</span>
          
          <code class="ruby">bug:Something is broken:d73a4a</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3050">
          <span class="hits">14</span>
          
          <code class="ruby">enhancement:New feature or request:a2eeef</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3051">
          <span class="hits">14</span>
          
          <code class="ruby">good first issue:Good for newcomers:7050ff</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3052">
          <span class="hits">14</span>
          
          <code class="ruby">needs spec:Task not fully specified:ff4040</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3053">
          <span class="hits">14</span>
          
          <code class="ruby">optimization:Non-behavior changing improvement:00dd70</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3054">
          <span class="hits">14</span>
          
          <code class="ruby">security:A security related tasks:ff0000</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3055">
          <span class="hits">14</span>
          
          <code class="ruby">task:General task:009900</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3056">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3057">
          <span class="hits">14</span>
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3058">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3059">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3060">
          <span class="hits">14</span>
          
          <code class="ruby">  local CURR_LABEL_DATA CURR_LABELS TEST_LABEL INDEX PROJECT_LABEL_NAMES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3061">
          <span class="hits">14</span>
          
          <code class="ruby">  PROJECT_LABEL_NAMES=&quot;$(echo &quot;${PROJECT_LABELS}&quot; | awk -F: &#39;{print $1}&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3062">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_LABEL_DATA=&quot;$(hub api &quot;/repos/${GIT_BASE}/labels&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3063">
          <span class="hits">14</span>
          
          <code class="ruby">  CURR_LABELS=&quot;$(echo &quot;$CURR_LABEL_DATA&quot; | jq -r &#39;.[].name&#39; )&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3064">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3065">
          <span class="hits">14</span>
          
          <code class="ruby">  local NON_STD_LABELS=&quot;${CURR_LABELS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3066">
          <span class="hits">14</span>
          
          <code class="ruby">  while read -r TEST_LABEL; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3067">
          <span class="hits">14</span>
          
          <code class="ruby">    INDEX=$(list-get-index NON_STD_LABELS &quot;${TEST_LABEL}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3068">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${INDEX}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3069">
          <span class="hits">14</span>
          
          <code class="ruby">      list-rm-item NON_STD_LABELS &quot;${TEST_LABEL}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3070">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3071">
          <span class="hits">14</span>
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${PROJECT_LABEL_NAMES}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3072">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3073">
          <span class="hits">14</span>
          
          <code class="ruby">  MISSING_LABELS=&quot;${PROJECT_LABEL_NAMES}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3074">
          <span class="hits">14</span>
          
          <code class="ruby">  while read -r TEST_LABEL; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3075">
          <span class="hits">14</span>
          
          <code class="ruby">    INDEX=$(list-get-index MISSING_LABELS &quot;${TEST_LABEL}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3076">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${INDEX}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3077">
          <span class="hits">14</span>
          
          <code class="ruby">      list-rm-item MISSING_LABELS &quot;${TEST_LABEL}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3078">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3079">
          <span class="hits">14</span>
          
          <code class="ruby">  done &lt;&lt;&lt; &quot;${CURR_LABELS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3080">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3081">
          <span class="hits">14</span>
          
          <code class="ruby">  local LABELS_SYNCED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3082">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;${NON_STD_LABELS}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3083">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;${NO_DELETE_LABELS}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3084">
          <span class="hits">14</span>
          
          <code class="ruby">      while read -r TEST_LABEL; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3085">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Removing non-standard label &#39;${TEST_LABEL}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3086">
          <span class="hits">14</span>
          
          <code class="ruby">        hub api -X DELETE &quot;/repos/${GIT_BASE}/labels/${TEST_LABEL}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3087">
          <span class="hits">14</span>
          
          <code class="ruby">      done &lt;&lt;&lt; &quot;${NON_STD_LABELS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3088">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3089">
          <span class="hits">14</span>
          
          <code class="ruby">      echowarn &quot;  The following non-standard labels where found in ${PROJECT}:\n$(echo &quot;${NON_STD_LABELS}&quot; | awk &#39;{ print &quot;* &quot;$0 }&#39;)\n\nInclude the &#39;--delete&#39; option to attempt removal.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3090">
          <span class="hits">14</span>
          
          <code class="ruby">      LABELS_SYNCED=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3091">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3092">
          <span class="hits">14</span>
          
          <code class="ruby">  fi # non-standard label check; potential deletion</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3093">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3094">
          <span class="hits">14</span>
          
          <code class="ruby">  local LABEL_SPEC NAME COLOR DESC</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3095">
          <span class="hits">14</span>
          
          <code class="ruby">  set-spec() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3096">
          <span class="hits">14</span>
          
          <code class="ruby">    NAME=&quot;$(echo &quot;${LABEL_SPEC}&quot; | awk -F: &#39;{print $1}&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3097">
          <span class="hits">14</span>
          
          <code class="ruby">    DESC=&quot;$(echo &quot;${LABEL_SPEC}&quot; | awk -F: &#39;{print $2}&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3098">
          <span class="hits">14</span>
          
          <code class="ruby">    COLOR=&quot;$(echo &quot;${LABEL_SPEC}&quot; | awk -F: &#39;{print $3}&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3099">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3100">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3101">
          <span class="hits">14</span>
          
          <code class="ruby">  local LABELS_CREATED</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3102">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;${MISSING_LABELS}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3103">
          <span class="hits">14</span>
          
          <code class="ruby">    while read -r TEST_LABEL; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3104">
          <span class="hits">14</span>
          
          <code class="ruby">      LABEL_SPEC=&quot;$(list-get-item-by-prefix PROJECT_LABELS &quot;${TEST_LABEL}:&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3105">
          <span class="hits">14</span>
          
          <code class="ruby">      set-spec</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3106">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  Adding label &#39;${TEST_LABEL}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3107">
          <span class="hits">14</span>
          
          <code class="ruby">      hub api -X POST &quot;/repos/${GIT_BASE}/labels&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3108">
          <span class="hits">14</span>
          
          <code class="ruby">        -f name=&quot;${NAME}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3109">
          <span class="hits">14</span>
          
          <code class="ruby">        -f description=&quot;${DESC}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3110">
          <span class="hits">14</span>
          
          <code class="ruby">        -f color=&quot;${COLOR}&quot; &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3111">
          <span class="hits">14</span>
          
          <code class="ruby">      list-add-item LABELS_CREATED &quot;${NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3112">
          <span class="hits">14</span>
          
          <code class="ruby">    done &lt;&lt;&lt; &quot;$MISSING_LABELS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3113">
          <span class="hits">14</span>
          
          <code class="ruby">  fi # missing labels creation</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3114">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3115">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_UPDATE_LABELS&quot; ]] &amp;&amp; [[ &quot;${LABELS_SYNCED}&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3116">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ &quot;${LABELS_SYNCED}&quot; != true ]] || echo &quot;  Label names synchronized...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3117">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;  Checking label definitions...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3118">
          <span class="hits">14</span>
          
          <code class="ruby">    LABELS_SYNCED=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3119">
          <span class="hits">14</span>
          
          <code class="ruby">    while read -r LABEL_SPEC; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3120">
          <span class="hits">14</span>
          
          <code class="ruby">      set-spec</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3121">
          <span class="hits">14</span>
          
          <code class="ruby">      local CURR_DESC CURR_COLOR</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3122">
          <span class="hits">14</span>
          
          <code class="ruby">      CURR_DESC=&quot;$(echo &quot;$CURR_LABEL_DATA&quot; | jq -r &quot;map(select(.name == \&quot;${NAME}\&quot;))[0].description&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3123">
          <span class="hits">14</span>
          
          <code class="ruby">      CURR_COLOR=&quot;$(echo &quot;$CURR_LABEL_DATA&quot; | jq -r &quot;map(select(.name == \&quot;${NAME}\&quot;))[0].color&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3124">
          <span class="hits">14</span>
          
          <code class="ruby">      if { [[ &quot;${CURR_COLOR}&quot; != &quot;${COLOR}&quot; ]] || [[ &quot;$CURR_DESC&quot; != &quot;${DESC}&quot; ]]; } \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3125">
          <span class="hits">14</span>
          
          <code class="ruby">         &amp;&amp; [[ -z $(list-get-index LABELS_CREATED &quot;${NAME}&quot;) ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3126">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Updating label definition for &#39;${NAME}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3127">
          <span class="hits">14</span>
          
          <code class="ruby">        hub api -X PATCH &quot;/repos/${GIT_BASE}/labels/${NAME}&quot; -f description=&quot;${DESC}&quot; -f color=&quot;${COLOR}&quot; &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3128">
          <span class="hits">14</span>
          
          <code class="ruby">        LABELS_SYNCED=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3129">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3130">
          <span class="hits">14</span>
          
          <code class="ruby">    done &lt;&lt;&lt; &quot;${PROJECT_LABELS}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3131">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3132">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ &quot;$LABELS_SYNCED&quot; == true ]] &amp;&amp; echo &quot;Label definitions updated.&quot; || echo &quot;Labels already up-to-date.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3133">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3134">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ &quot;${LABELS_SYNCED}&quot; != true ]] || [[ -n &quot;$NO_UPDATE_LABELS&quot; ]] || echo &quot;Labels not synchronized; skipping update.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3135">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -z &quot;${NO_UPDATE_LABELS}&quot; ]] || echo &quot;Skipping labels update.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3136">
          <span class="hits">14</span>
          
          <code class="ruby">  fi # labels definition check and update</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3137">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3138">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3139">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: deprecated</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3140">
          <span class="hits">14</span>
          
          <code class="ruby">requirements-required-services() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3141">
          <span class="hits">14</span>
          
          <code class="ruby">  requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3142">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3143">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3144">
          <span class="hits">14</span>
          
          <code class="ruby">required-services-add() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3145">
          <span class="hits">14</span>
          
          <code class="ruby">  local IFACE_CLASS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3146">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $# -eq 0 ]]; then # interactive add</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3147">
          <span class="hits">14</span>
          
          <code class="ruby">    local NEW_SERVICES=&quot;$STD_IFACE_CLASSES&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3148">
          <span class="hits">14</span>
          
          <code class="ruby">    local EXISTING_SERVICES=$(required-services-list)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3149">
          <span class="hits">14</span>
          
          <code class="ruby">    local EXISTING_SERVICE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3150">
          <span class="hits">14</span>
          
          <code class="ruby">    for EXISTING_SERVICE in $EXISTING_SERVICES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3151">
          <span class="hits">14</span>
          
          <code class="ruby">      NEW_SERVICES=`echo &quot;$NEW_SERVICES&quot; | sed -Ee &quot;s/(^| +)${EXISTING_SERVICE}( +|\$)/\1\2/&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3152">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3153">
          <span class="hits">14</span>
          
          <code class="ruby">    local REQ_SERVICES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3154">
          <span class="hits">14</span>
          
          <code class="ruby">    PS3=&quot;Required service interface: &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3155">
          <span class="hits">14</span>
          
          <code class="ruby">    selectOneCancelOther REQ_SERVICES NEW_SERVICES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3156">
          <span class="hits">14</span>
          
          <code class="ruby">    for IFACE_CLASS in $REQ_SERVICES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3157">
          <span class="hits">14</span>
          
          <code class="ruby">      reqServDefine &quot;$IFACE_CLASS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3158">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3159">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3160">
          <span class="hits">14</span>
          
          <code class="ruby">    while (($# &gt; 0)); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3161">
          <span class="hits">14</span>
          
          <code class="ruby">      IFACE_CLASS=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3162">
          <span class="hits">14</span>
          
          <code class="ruby">      reqServDefine &quot;$IFACE_CLASS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3163">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3164">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3165">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; | jq &gt; &quot;$PACKAGE_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3166">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3167">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3168">
          <span class="hits">14</span>
          
          <code class="ruby">required-services-delete() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3169">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $# -eq 0 ]]; then # interactive delete</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3170">
          <span class="hits">14</span>
          
          <code class="ruby">    local DEL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3171">
          <span class="hits">14</span>
          
          <code class="ruby">    while [[ $DEL != &#39;...quit...&#39; ]]; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3172">
          <span class="hits">14</span>
          
          <code class="ruby">      local OPTIONS=`required-services-list`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3173">
          <span class="hits">14</span>
          
          <code class="ruby">      # TODO: rework to support canctel; add and use &#39;selectDone&#39;?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3174">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;$OPTIONS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3175">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;Nothing left to delete.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3176">
          <span class="hits">14</span>
          
          <code class="ruby">        DEL=&#39;...quit...&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3177">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3178">
          <span class="hits">14</span>
          
          <code class="ruby">        select DEL in &#39;&lt;done&gt;&#39; $OPTIONS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3179">
          <span class="hits">14</span>
          
          <code class="ruby">          case $DEL in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3180">
          <span class="hits">14</span>
          
          <code class="ruby">            &#39;&lt;done&gt;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3181">
          <span class="hits">14</span>
          
          <code class="ruby">              DEL=&#39;...quit...&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3182">
          <span class="hits">14</span>
          
          <code class="ruby">              break;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3183">
          <span class="hits">14</span>
          
          <code class="ruby">            *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3184">
          <span class="hits">14</span>
          
          <code class="ruby">              required-services-delete &quot;$DEL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3185">
          <span class="hits">14</span>
          
          <code class="ruby">              PACKAGE=`cat &quot;$PACKAGE_FILE&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3186">
          <span class="hits">14</span>
          
          <code class="ruby">              break;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3187">
          <span class="hits">14</span>
          
          <code class="ruby">          esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3188">
          <span class="hits">14</span>
          
          <code class="ruby">        done # select</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3189">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3190">
          <span class="hits">14</span>
          
          <code class="ruby">    done # while</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3191">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3192">
          <span class="hits">14</span>
          
          <code class="ruby">    while (($# &gt; 0)); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3193">
          <span class="hits">14</span>
          
          <code class="ruby">      local IFACE_CLASS=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3194">
          <span class="hits">14</span>
          
          <code class="ruby">      if ! echo &quot;$PACKAGE&quot; | jq -e &quot;(.catalyst.requires | map(select(.iface == \&quot;$IFACE_CLASS\&quot;)) | length) &gt; 0&quot; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3195">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;No such requirement &#39;$IFACE_CLASS&#39; found.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3196">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3197">
          <span class="hits">14</span>
          
          <code class="ruby">        PACKAGE=`echo &quot;$PACKAGE&quot; | jq &quot;.catalyst + { requires: [ .catalyst.requires | .[] | select(.iface != \&quot;$IFACE_CLASS\&quot;) ] }&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3198">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3199">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3200">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3201">
          <span class="hits">14</span>
          
          <code class="ruby">  # cleanup .catalyst.requires if empty</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3202">
          <span class="hits">14</span>
          
          <code class="ruby">  if echo &quot;$PACKAGE&quot; | jq -e &quot;(.catalyst.requires | length) == 0&quot; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3203">
          <span class="hits">14</span>
          
          <code class="ruby">    PACKAGE=`echo &quot;$PACKAGE&quot; | jq &quot;del(.catalyst.requires)&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3204">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3205">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; | jq &gt; &quot;$PACKAGE_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3206">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3207">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3208">
          <span class="hits">14</span>
          
          <code class="ruby">required-services-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3209">
          <span class="hits">14</span>
          
          <code class="ruby">  if echo &quot;$PACKAGE&quot; | jq -e &quot;(.catalyst.requires | length) &gt; 0&quot; &gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3210">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$PACKAGE&quot; | jq --raw-output &quot;.catalyst.requires | .[] | .iface | @sh&quot; | tr -d &quot;&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3211">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3212">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3213">
          <span class="hits">14</span>
          
          <code class="ruby">help-required-services() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3214">
          <span class="hits">14</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3215">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3216">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${red_b}(deprated)${reset} ${cyan_u}required-services${reset} &lt;action&gt;: Configures runtime service requirements.&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3217">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}required-services${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3218">
          <span class="hits">14</span>
          
          <code class="ruby">  ${underline}list${reset} [&lt;project name&gt;...]: Lists the services required by the named current or named project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3219">
          <span class="hits">14</span>
          
          <code class="ruby">  ${underline}add${reset} [&lt;package name&gt;]: Add a required service.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3220">
          <span class="hits">14</span>
          
          <code class="ruby">  ${underline}delete${reset} [&lt;package name&gt;] &lt;name&gt;: Deletes a required service.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3221">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3222">
          <span class="hits">14</span>
          
          <code class="ruby">${red_b}Deprated: These commands will migrate under &#39;project&#39;.${reset}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3223">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3224">
          <span class="hits">14</span>
          
          <code class="ruby">The &#39;add&#39; action works interactively. Non-interactive alternatives will be</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3225">
          <span class="hits">14</span>
          
          <code class="ruby">provided in future versions.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3226">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3227">
          <span class="hits">14</span>
          
          <code class="ruby">The ${underline}package name${reset} parameter in the &#39;add&#39; and &#39;delete&#39; actions is optional if</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3228">
          <span class="hits">14</span>
          
          <code class="ruby">there is a single package in the current repository.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3229">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3230">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3231">
          <span class="hits">14</span>
          
          <code class="ruby">reqServDefine() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3232">
          <span class="hits">14</span>
          
          <code class="ruby">  local IFACE_CLASS=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3233">
          <span class="hits">14</span>
          
          <code class="ruby">  local SERVICE_DEF=$(cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3234">
          <span class="hits">14</span>
          
          <code class="ruby">{</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3235">
          <span class="hits">14</span>
          
          <code class="ruby">  &quot;iface&quot;: &quot;${IFACE_CLASS}&quot;,</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3236">
          <span class="hits">14</span>
          
          <code class="ruby">  &quot;params-req&quot;: [],</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3237">
          <span class="hits">14</span>
          
          <code class="ruby">  &quot;params-opt&quot;: [],</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3238">
          <span class="hits">14</span>
          
          <code class="ruby">  &quot;config-const&quot;: {}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3239">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3240">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3241">
          <span class="hits">14</span>
          
          <code class="ruby">)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3242">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3243">
          <span class="hits">14</span>
          
          <code class="ruby">  defineParameters SERVICE_DEF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3244">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3245">
          <span class="hits">14</span>
          
          <code class="ruby">  PACKAGE=`echo &quot;$PACKAGE&quot; | jq &quot;.catalyst + { \&quot;requires\&quot; : ( .catalyst.requires + [ $SERVICE_DEF ] ) }&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3246">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PACKAGE&quot; | jq &gt; &quot;$PACKAGE_FILE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3247">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3248">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3249">
          <span class="hits">14</span>
          
          <code class="ruby">requirements-work() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3250">
          <span class="hits">14</span>
          
          <code class="ruby">  :</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3251">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3252">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3253">
          <span class="hits">14</span>
          
          <code class="ruby">work-backup() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3254">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3255">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3256">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions TEST -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3257">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3258">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$TEST&quot; != true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3259">
          <span class="hits">14</span>
          
          <code class="ruby">    local OLD_MSG</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3260">
          <span class="hits">14</span>
          
          <code class="ruby">    OLD_MSG=&quot;$(git log -1 --pretty=%B)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3261">
          <span class="hits">14</span>
          
          <code class="ruby">    git commit --amend -m &quot;${OLD_MSG} [no ci]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3262">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3263">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: retrive and use workbranch name instead</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3264">
          <span class="hits">14</span>
          
          <code class="ruby">  git push workspace HEAD</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3265">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3266">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3267">
          <span class="hits">14</span>
          
          <code class="ruby">work-diff-master() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3268">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3269">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3270">
          <span class="hits">14</span>
          
          <code class="ruby">  git diff $(git merge-base master HEAD)..HEAD &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3271">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3272">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3273">
          <span class="hits">14</span>
          
          <code class="ruby">work-close() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3274">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions POP TEST NO_SYNC -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3275">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3276">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3277">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3278">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3279">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3280">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECTS=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3281">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3282">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECTS=&quot;$INVOLVED_PROJECTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3283">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3284">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3285">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3286">
          <span class="hits">14</span>
          
          <code class="ruby">  # first, do the checks</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3287">
          <span class="hits">14</span>
          
          <code class="ruby">  for PROJECT in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3288">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=$(workConvertDot &quot;$PROJECT&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3289">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;${PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3290">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_BRANCH</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3291">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3292">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_BRANCH=$(workCurrentWorkBranch)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3293">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3294">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$CURR_BRANCH&quot; != &quot;$WORK_BRANCH&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3295">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Local project &#39;$PROJECT&#39; repo branch does not match expected work branch.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3296">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3297">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3298">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepo &quot;$PROJECT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3299">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3300">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3301">
          <span class="hits">14</span>
          
          <code class="ruby">  # now actually do the closures</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3302">
          <span class="hits">14</span>
          
          <code class="ruby">  for PROJECT in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3303">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=$(workConvertDot &quot;$PROJECT&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3304">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;${PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3305">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3306">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_BRANCH</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3307">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_BRANCH=$(git branch | (grep &#39;*&#39; || true) | awk &#39;{print $2}&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3308">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3309">
          <span class="hits">14</span>
          
          <code class="ruby">    git checkout master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3310">
          <span class="hits">14</span>
          
          <code class="ruby">    git push workspace &quot;${WORK_BRANCH}:${WORK_BRANCH}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3311">
          <span class="hits">14</span>
          
          <code class="ruby">      || echoerrandexit &quot;Could not push &#39;${WORK_BRANCH}&#39; to workspace; refusing to close without backing up.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3312">
          <span class="hits">14</span>
          
          <code class="ruby">    git branch -qd &quot;$WORK_BRANCH&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3313">
          <span class="hits">14</span>
          
          <code class="ruby">      || ( echoerr &quot;Could not delete local &#39;${WORK_BRANCH}&#39;. This can happen if the branch was renamed.&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3314">
          <span class="hits">14</span>
          
          <code class="ruby">          &amp;&amp; false)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3315">
          <span class="hits">14</span>
          
          <code class="ruby">    list-rm-item INVOLVED_PROJECTS &quot;@${PROJECT}&quot; # this cannot be done in a subshell</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3316">
          <span class="hits">14</span>
          
          <code class="ruby">    workUpdateWorkDb</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3317">
          <span class="hits">14</span>
          
          <code class="ruby">		if [[ -z &quot;$NO_SYNC&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3318">
          <span class="hits">14</span>
          
          <code class="ruby">			projects-sync --project=&quot;${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3319">
          <span class="hits">14</span>
          
          <code class="ruby">		fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3320">
          <span class="hits">14</span>
          
          <code class="ruby">    # Notice we don&#39;t close the workspace branch. It may be involved in a PR and, generally, we don&#39;t care if the</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3321">
          <span class="hits">14</span>
          
          <code class="ruby">    # workspace gets a little messy. TODO: reference workspace cleanup method here when we have one.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3322">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3323">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3324">
          <span class="hits">14</span>
          
          <code class="ruby">  # If all involved projects are closed, then our work is done.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3325">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;${INVOLVED_PROJECTS}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3326">
          <span class="hits">14</span>
          
          <code class="ruby">    rm &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3327">
          <span class="hits">14</span>
          
          <code class="ruby">    rm &quot;${LIQ_WORK_DB}/${WORK_BRANCH}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3328">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3329">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$POP&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3330">
          <span class="hits">14</span>
          
          <code class="ruby">      work-resume --pop</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3331">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3332">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3333">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3334">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3335">
          <span class="hits">14</span>
          
          <code class="ruby"># Helps get users find the right command.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3336">
          <span class="hits">14</span>
          
          <code class="ruby">work-commit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3337">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3338">
          <span class="hits">14</span>
          
          <code class="ruby">  # The command generator is a bit hackish; do we have a library that handles the quotes correctly?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3339">
          <span class="hits">14</span>
          
          <code class="ruby">  echoerrandexit &quot;Invalid action &#39;commit&#39;; do you want to &#39;save&#39;?\nRefer to:\nliq help work save\nor try:\nliq work save $(for i in &quot;$@&quot;; do if [[ &quot;$i&quot; == *&#39; &#39;* ]]; then echo -n &quot;&#39;$i&#39; &quot;; else echo -n &quot;$i &quot;; fi; done)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3340">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3341">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3342">
          <span class="hits">14</span>
          
          <code class="ruby"># `liq help work edit`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3343">
          <span class="hits">14</span>
          
          <code class="ruby"># TODO: untested</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3344">
          <span class="hits">14</span>
          
          <code class="ruby">work-edit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3345">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3346">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3347">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3348">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3349">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3350">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECTS=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3351">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3352">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECTS=&quot;$INVOLVED_PROJECTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3353">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3354">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3355">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3356">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: first, do the checks</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3357">
          <span class="hits">14</span>
          
          <code class="ruby">  ( for PROJECT in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3358">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=$(workConvertDot &quot;$PROJECT&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3359">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;${PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3360">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3361">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3362">
          <span class="hits">14</span>
          
          <code class="ruby">    projects-edit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3363">
          <span class="hits">14</span>
          
          <code class="ruby">  done )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3364">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3365">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3366">
          <span class="hits">14</span>
          
          <code class="ruby">work-ignore-rest() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3367">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3368">
          <span class="hits">14</span>
          
          <code class="ruby">  pushd &quot;${BASE_DIR}&quot; &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3369">
          <span class="hits">14</span>
          
          <code class="ruby">  touch .gitignore</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3370">
          <span class="hits">14</span>
          
          <code class="ruby">  # first ignore whole directories</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3371">
          <span class="hits">14</span>
          
          <code class="ruby">  for i in `git ls-files . --exclude-standard --others --directory`; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3372">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${i}&quot; &gt;&gt; .gitignore</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3373">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3374">
          <span class="hits">14</span>
          
          <code class="ruby">  popd &gt; /dev/null</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3375">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3376">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3377">
          <span class="hits">14</span>
          
          <code class="ruby">work-involve() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3378">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # this will be optional once we support &#39;--project&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3379">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3380">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_LINK:L -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3381">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJECT_NAME WORK_DESC WORK_STARTED WORK_INITIATOR INVOLVED_PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3382">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3383">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;There is no active unit of work to involve. Try:\nliq work resume&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3384">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3385">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3386">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3387">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3388">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# == 0 )) &amp;&amp; [[ -n &quot;$BASE_DIR&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3389">
          <span class="hits">14</span>
          
          <code class="ruby">    requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3390">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT_NAME=$(echo &quot;$PACKAGE&quot; | jq --raw-output &#39;.name | @sh&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3391">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT_NAME=${PROJECT_NAME/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3392">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3393">
          <span class="hits">14</span>
          
          <code class="ruby">    exactUserArgs PROJECT_NAME -- &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3394">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT_NAME=${PROJECT_NAME/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3395">
          <span class="hits">14</span>
          
          <code class="ruby">    test -d &quot;${LIQ_PLAYGROUND}/${PROJECT_NAME}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3396">
          <span class="hits">14</span>
          
          <code class="ruby">      || echoerrandexit &quot;Invalid project name &#39;$PROJECT_NAME&#39;. Perhaps it needs to be imported? Try:\nliq playground import &lt;git URL&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3397">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3398">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3399">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3400">
          <span class="hits">14</span>
          
          <code class="ruby">  local BRANCH_NAME=$(basename $(readlink &quot;${LIQ_WORK_DB}/curr_work&quot;))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3401">
          <span class="hits">14</span>
          
          <code class="ruby">  requirePackage # used later if auto-linking</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3402">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3403">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${LIQ_PLAYGROUND}/${PROJECT_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3404">
          <span class="hits">14</span>
          
          <code class="ruby">  if git branch | grep -qE &quot;^\*? *${BRANCH_NAME}\$&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3405">
          <span class="hits">14</span>
          
          <code class="ruby">    echowarn &quot;Found existing work branch &#39;${BRANCH_NAME}&#39; in project ${PROJECT_NAME}. We will use it. Please fix manually if this is unexpected.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3406">
          <span class="hits">14</span>
          
          <code class="ruby">    git checkout -q &quot;${BRANCH_NAME}&quot; || echoerrandexit &quot;There was a problem checking out the work branch. ($?)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3407">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3408">
          <span class="hits">14</span>
          
          <code class="ruby">    git checkout -qb &quot;${BRANCH_NAME}&quot; || echoerrandexit &quot;There was a problem creating the work branch. ($?)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3409">
          <span class="hits">14</span>
          
          <code class="ruby">    git push --set-upstream workspace ${BRANCH_NAME}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3410">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Created work branch &#39;${BRANCH_NAME}&#39; for project &#39;${PROJECT_NAME}&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3411">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3412">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3413">
          <span class="hits">14</span>
          
          <code class="ruby">  local OTHER_PROJECTS=&quot;${INVOLVED_PROJECTS}&quot; # save this for use in linking later...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3414">
          <span class="hits">14</span>
          
          <code class="ruby">  list-add-item INVOLVED_PROJECTS &quot;@${PROJECT_NAME}&quot; # do include the &#39;@&#39; here for display</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3415">
          <span class="hits">14</span>
          
          <code class="ruby">  workUpdateWorkDb</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3416">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3417">
          <span class="hits">14</span>
          
          <code class="ruby">  # Now, let&#39;s see about automatic linking!</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3418">
          <span class="hits">14</span>
          
          <code class="ruby">  local PRIMARY_PROJECT=$INVOLVED_PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3419">
          <span class="hits">14</span>
          
          <code class="ruby">  # if this is the first/primary project, no need to worry about linking</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3420">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$PRIMARY_PROJECT&quot; != &quot;$PROJECT_NAME&quot; ]] &amp;&amp; [[ -z &quot;${NO_LINK}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3421">
          <span class="hits">14</span>
          
          <code class="ruby">    # first, link this project to other projects</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3422">
          <span class="hits">14</span>
          
          <code class="ruby">    local LINKS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3423">
          <span class="hits">14</span>
          
          <code class="ruby">    work-links-add --set-links LINKS &quot;${PROJECT_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3424">
          <span class="hits">14</span>
          
          <code class="ruby">    # now link other, already involved projects to this project</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3425">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3426">
          <span class="hits">14</span>
          
          <code class="ruby">    local SOURCE_PROJ</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3427">
          <span class="hits">14</span>
          
          <code class="ruby">    for SOURCE_PROJ in $OTHER_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3428">
          <span class="hits">14</span>
          
          <code class="ruby">      if projects-lib-has-any-dep &quot;${PROJECT_NAME}&quot; &quot;${SOURCE_PROJ}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3429">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -n &quot;$(list-get-index LINKS &quot;${SOURCE_PROJ}&quot;)&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3430">
          <span class="hits">14</span>
          
          <code class="ruby">          echowarn &quot;Project &#39;${SOURCE_PROJ}&#39; linked to &#39;${PROJECT_NAME}&#39;, but &#39;${PROJECT_NAME}&#39; also depends on &#39;${SOURCE_PROJ}&#39;; skipping the link back-link to avoid circular reference.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3431">
          <span class="hits">14</span>
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3432">
          <span class="hits">14</span>
          
          <code class="ruby">          work-links-add --projects=&quot;${PROJECT_NAME}&quot; &quot;${SOURCE_PROJ}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3433">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3434">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3435">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3436">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3437">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3438">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3439">
          <span class="hits">14</span>
          
          <code class="ruby">work-issues() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3440">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3441">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3442">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions LIST ADD= REMOVE= -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3443">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3444">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3445">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3446">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No current work selected; cannot list issues.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3447">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3448">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3449">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3450">
          <span class="hits">14</span>
          
          <code class="ruby">  BUGS_URL=$(cat &quot;$BASE_DIR/package.json&quot; | jq --raw-output &#39;.bugs.url&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3451">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3452">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$ADD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3453">
          <span class="hits">14</span>
          
          <code class="ruby">    local NEW_ISSUE NEW_ISSUES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3454">
          <span class="hits">14</span>
          
          <code class="ruby">    work-lib-process-issues NEW_ISSUES &quot;$ADD&quot; &quot;$BUGS_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3455">
          <span class="hits">14</span>
          
          <code class="ruby">    for NEW_ISSUE in $NEW_ISSUES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3456">
          <span class="hits">14</span>
          
          <code class="ruby">      list-add-item WORK_ISSUES &quot;$NEW_ISSUE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3457">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3458">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3459">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$REMOVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3460">
          <span class="hits">14</span>
          
          <code class="ruby">    local RM_ISSUE RM_ISSUES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3461">
          <span class="hits">14</span>
          
          <code class="ruby">    work-lib-process-issues RM_ISSUES &quot;$REMOVE&quot; &quot;$BUGS_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3462">
          <span class="hits">14</span>
          
          <code class="ruby">    for RM_ISSUE in $RM_ISSUES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3463">
          <span class="hits">14</span>
          
          <code class="ruby">      list-rm-item WORK_ISSUES &quot;$RM_ISSUE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3464">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3465">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3466">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$LIST&quot; ]] || [[ -z &quot;$LIST&quot; ]] &amp;&amp; [[ -z &quot;$ADD&quot; ]] &amp;&amp; [[ -z &quot;$REMOVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3467">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$WORK_ISSUES&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3468">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3469">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$ADD&quot; ]] || [[ -n &quot;$REMOVE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3470">
          <span class="hits">14</span>
          
          <code class="ruby">    workUpdateWorkDb</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3471">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3472">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3473">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3474">
          <span class="hits">14</span>
          
          <code class="ruby"># see liq help work list</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3475">
          <span class="hits">14</span>
          
          <code class="ruby">work-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3476">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_DESC WORK_STARTED WORK_INITIATOR INVOLVED_PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3477">
          <span class="hits">14</span>
          
          <code class="ruby">  # find &quot;${LIQ_WORK_DB}&quot; -maxdepth 1 -not -name &quot;*~&quot; -type f -exec basename &#39;{}&#39; \;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3478">
          <span class="hits">14</span>
          
          <code class="ruby">  for i in $(find &quot;${LIQ_WORK_DB}&quot; -maxdepth 1 -not -name &quot;*~&quot; -type f -exec basename &#39;{}&#39; \;); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3479">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${LIQ_WORK_DB}/${i}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3480">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/${i}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3481">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -e &quot;* ${yellow_b}${WORK_DESC}${reset}: started ${bold}${WORK_STARTED}${reset} by ${bold}${WORK_INITIATOR}${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3482">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3483">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3484">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3485">
          <span class="hits">14</span>
          
          <code class="ruby"># see liq help work merge</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3486">
          <span class="hits">14</span>
          
          <code class="ruby">work-merge() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3487">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: https://github.com/Liquid-Labs/liq-cli/issues/57 support org-level config to default allow unforced merge</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3488">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FORCE CLOSE PUSH_UPSTREAM -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3489">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3490">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;${PUSH_UPSTREAM}&quot; == true ]] &amp;&amp; [[ &quot;$FORCE&quot; != true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3491">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;&#39;work merge --push-upstream&#39; is not allowed by default. You can use &#39;--force&#39;, but generally you will either want to configure the project to enable non-forced upstream merges or try:\nliq work submit&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3492">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3493">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3494">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3495">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;&#39;merge&#39; can only be perfomred on the current unit of work. Try:\nliq work select&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3496">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3497">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3498">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_DESC WORK_STARTED WORK_INITIATOR INVOLVED_PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3499">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3500">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3501">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$INVOLVED_PROJECTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3502">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No projects involved in the current unit of work &#39;${WORK_BRANCH}&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3503">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3504">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# == 0 )) &amp;&amp; ! yes-no &quot;Are you sure want to merge the entire unit of work? (y/N)&quot; &#39;N&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3505">
          <span class="hits">14</span>
          
          <code class="ruby">    return</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3506">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3507">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3508">
          <span class="hits">14</span>
          
          <code class="ruby">  local TO_MERGE=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3509">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$TO_MERGE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3510">
          <span class="hits">14</span>
          
          <code class="ruby">    TO_MERGE=&quot;$INVOLVED_PROJECTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3511">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3512">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3513">
          <span class="hits">14</span>
          
          <code class="ruby">  local TM</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3514">
          <span class="hits">14</span>
          
          <code class="ruby">  for TM in $TO_MERGE; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3515">
          <span class="hits">14</span>
          
          <code class="ruby">    TM=$(workConvertDot &quot;$TM&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3516">
          <span class="hits">14</span>
          
          <code class="ruby">    if ! echo &quot;$INVOLVED_PROJECTS&quot; | grep -qE &#39;(^| +)&#39;$TM&#39;( +|$)&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3517">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Project &#39;$TM&#39; not in the current unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3518">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3519">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_BRANCH</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3520">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_BRANCH=$(git branch | (grep &#39;*&#39; || true) | awk &#39;{print $2}&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3521">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$CURR_BRANCH&quot; != master ]] &amp;&amp; [[ &quot;$CURR_BRANCH&quot; != &quot;$WORK_BRANCH&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3522">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Project &#39;$TM&#39; is not currently on the expected workbranch &#39;$WORK_BRANCH&#39;. Please fix and re-run.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3523">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3524">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepo &quot;$TM&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3525">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3526">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3527">
          <span class="hits">14</span>
          
          <code class="ruby">  for TM in $TO_MERGE; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3528">
          <span class="hits">14</span>
          
          <code class="ruby">    TM=$(workConvertDot &quot;$TM&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3529">
          <span class="hits">14</span>
          
          <code class="ruby">    TM=${TM/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3530">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${TM}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3531">
          <span class="hits">14</span>
          
          <code class="ruby">    local SHORT_STAT=`git diff --shortstat master ${WORK_BRANCH}`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3532">
          <span class="hits">14</span>
          
          <code class="ruby">    local INS_COUNT=`echo &quot;${SHORT_STAT}&quot; | egrep -Eio -e &#39;\d+ insertion&#39; | awk &#39;{print $1}&#39; || true`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3533">
          <span class="hits">14</span>
          
          <code class="ruby">    INS_COUNT=${INS_COUNT:-0}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3534">
          <span class="hits">14</span>
          
          <code class="ruby">    local DEL_COUNT=`echo &quot;${SHORT_STAT}&quot; | egrep -Eio -e &#39;\d+ deletion&#39; | awk &#39;{print $1}&#39; || true`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3535">
          <span class="hits">14</span>
          
          <code class="ruby">    DEL_COUNT=${DEL_COUNT:-0}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3536">
          <span class="hits">14</span>
          
          <code class="ruby">    local DIFF_COUNT=$(( $INS_COUNT - $DEL_COUNT ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3537">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3538">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: don&#39;t assume the merge closes anything; may be merging for different reasons. Accept &#39;--no-close&#39; option or</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3539">
          <span class="hits">14</span>
          
          <code class="ruby">    # &#39;--closes=x,y,z&#39; where x etc. are alread associated to the unit of work</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3540">
          <span class="hits">14</span>
          
          <code class="ruby">    local CLOSE_MSG BUGS_URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3541">
          <span class="hits">14</span>
          
          <code class="ruby">    BUGS_URL=$(cat &quot;$BASE_DIR/package.json&quot; | jq --raw-output &#39;.bugs.url&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3542">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$WORK_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3543">
          <span class="hits">14</span>
          
          <code class="ruby">      echowarn &quot;No issues associated with this unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3544">
          <span class="hits">14</span>
          
          <code class="ruby">    elif [[ -n &quot;$BUGS_URL&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3545">
          <span class="hits">14</span>
          
          <code class="ruby">      local ISSUE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3546">
          <span class="hits">14</span>
          
          <code class="ruby">      for ISSUE in $WORK_ISSUES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3547">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ $ISSUE == $BUGS_URL* ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3548">
          <span class="hits">14</span>
          
          <code class="ruby">          local NUMBER=${ISSUE/$BUGS_URL/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3549">
          <span class="hits">14</span>
          
          <code class="ruby">          NUMBER=${NUMBER/\//}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3550">
          <span class="hits">14</span>
          
          <code class="ruby">          list-add-item CLOSE_MSG &quot;closes #${NUMBER}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3551">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3552">
          <span class="hits">14</span>
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3553">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3554">
          <span class="hits">14</span>
          
          <code class="ruby">      echowarn &quot;No issues URL associated with this project.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3555">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3556">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3557">
          <span class="hits">14</span>
          
          <code class="ruby">    cleanupMaster() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3558">
          <span class="hits">14</span>
          
          <code class="ruby">      cd ${BASE_DIR}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3559">
          <span class="hits">14</span>
          
          <code class="ruby">      git worktree remove _master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3560">
          <span class="hits">14</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3561">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3562">
          <span class="hits">14</span>
          
          <code class="ruby">    cd ${BASE_DIR}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3563">
          <span class="hits">14</span>
          
          <code class="ruby">    # if [[ &quot;${WORK_BRANCH}&quot; != master ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3564">
          <span class="hits">14</span>
          
          <code class="ruby">    #  git checkout -q master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3565">
          <span class="hits">14</span>
          
          <code class="ruby">    #    || echoerrandexit &quot;Could not switch to master branch in project &#39;$TM&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3566">
          <span class="hits">14</span>
          
          <code class="ruby">    # fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3567">
          <span class="hits">14</span>
          
          <code class="ruby">    (git worktree add _master master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3568">
          <span class="hits">14</span>
          
          <code class="ruby">      || echoerrandexit &quot;Could not create &#39;master&#39; worktree.&quot;) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3569">
          <span class="hits">14</span>
          
          <code class="ruby">    &amp;&amp; (cd _master; git pull upstream master:master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3570">
          <span class="hits">14</span>
          
          <code class="ruby">        || (cleanupMaster; echoerrandexit $echoerrandexit &quot;Could not update local master from upstream for &#39;$TM&#39;.&quot;)) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3571">
          <span class="hits">14</span>
          
          <code class="ruby">    &amp;&amp; (cd _master; git merge --no-ff -qm &quot;merge branch $WORK_BRANCH&quot; &quot;$WORK_BRANCH&quot; -m &quot;$CLOSE_MSG&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3572">
          <span class="hits">14</span>
          
          <code class="ruby">        || (cleanupMaster; echoerrandexit &quot;Problem merging &#39;${WORK_BRANCH}&#39; with &#39;master&#39; for project &#39;$TM&#39;. ($?)&quot;)) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3573">
          <span class="hits">14</span>
          
          <code class="ruby">    &amp;&amp; (cleanupMaster || echoerr &quot;There was a problem removing &#39;_master&#39; worktree.&quot;) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3574">
          <span class="hits">14</span>
          
          <code class="ruby">    &amp;&amp; ( (git push -q workspace master:master &amp;&amp; echo &quot;Work merged to &#39;master&#39; and pushed to workspace/master.&quot;) \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3575">
          <span class="hits">14</span>
          
          <code class="ruby">        || echoerr &quot;Local merge successful, but there was a problem pushing work to workspace/master; bailing out.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3576">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3577">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$PUSH_UPSTREAM&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3578">
          <span class="hits">14</span>
          
          <code class="ruby">      git push -q upstream master:master \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3579">
          <span class="hits">14</span>
          
          <code class="ruby">        || echoerrandexit &quot;Failed to push local master to upstream master. Bailing out.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3580">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3581">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3582">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$CLOSE&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3583">
          <span class="hits">14</span>
          
          <code class="ruby">      work-close &quot;$TM&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3584">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3585">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3586">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$TM linecount change: $DIFF_COUNT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3587">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3588">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3589">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3590">
          <span class="hits">14</span>
          
          <code class="ruby">work-qa() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3591">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3592">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3593">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Checking local repo status...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3594">
          <span class="hits">14</span>
          
          <code class="ruby">  work-report</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3595">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3596">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3597">
          <span class="hits">14</span>
          
          <code class="ruby">  for PROJECT in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3598">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJECT=&quot;${PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3599">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${PROJECT}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3600">
          <span class="hits">14</span>
          
          <code class="ruby">    projects-qa &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3601">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3602">
          <span class="hits">14</span>
          
          <code class="ruby">} # work merge</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3603">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3604">
          <span class="hits">14</span>
          
          <code class="ruby">work-report() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3605">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3606">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3607">
          <span class="hits">14</span>
          
          <code class="ruby">  local BRANCH_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3608">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3609">
          <span class="hits">14</span>
          
          <code class="ruby">    local COUNT=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3610">
          <span class="hits">14</span>
          
          <code class="ruby">    local DESC=&quot;$2&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3611">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $COUNT &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3612">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;$1 files $2.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3613">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3614">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3615">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3616">
          <span class="hits">14</span>
          
          <code class="ruby">  requireCatalystfile</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3617">
          <span class="hits">14</span>
          
          <code class="ruby">  (cd &quot;${BASE_DIR}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3618">
          <span class="hits">14</span>
          
          <code class="ruby">   echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3619">
          <span class="hits">14</span>
          
          <code class="ruby">   echo &quot;${green}&quot;`basename &quot;$PWD&quot;`; tput sgr0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3620">
          <span class="hits">14</span>
          
          <code class="ruby">   BRANCH_NAME=`git rev-parse --abbrev-ref HEAD 2&gt; /dev/null || echo &#39;&#39;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3621">
          <span class="hits">14</span>
          
          <code class="ruby">   if [[ $BRANCH_NAME == &quot;HEAD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3622">
          <span class="hits">14</span>
          
          <code class="ruby">     echo &quot;${red}NO WORKING BRANCH&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3623">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3624">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;On branch: ${green}${BRANCH_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3625">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3626">
          <span class="hits">14</span>
          
          <code class="ruby">  tput sgr0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3627">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: once &#39;git status&#39; once and capture output</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3628">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^ M&#39; | wc -l || true` &#39;modified&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3629">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^R &#39; | wc -l || true` &#39;renamed&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3630">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^RM&#39; | wc -l || true` &#39;renamed and modifed&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3631">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^D &#39; | wc -l || true` &#39;deleted&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3632">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^ D&#39; | wc -l || true` &#39;missing&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3633">
          <span class="hits">14</span>
          
          <code class="ruby">  statusReport `git status --porcelain | grep &#39;^??&#39; | wc -l || true` &#39;untracked&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3634">
          <span class="hits">14</span>
          
          <code class="ruby">  local TOTAL_COUNT=`git status --porcelain | wc -l | xargs || true`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3635">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $TOTAL_COUNT &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3636">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -e &quot;------------\n$TOTAL_COUNT total&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3637">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3638">
          <span class="hits">14</span>
          
          <code class="ruby"> )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3639">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3640">
          <span class="hits">14</span>
          
          <code class="ruby">  tput sgr0 # TODO: put this in the exit trap, too, I think.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3641">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3642">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3643">
          <span class="hits">14</span>
          
          <code class="ruby"># See &#39;liq help work resume&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3644">
          <span class="hits">14</span>
          
          <code class="ruby">work-resume() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3645">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3646">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3647">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions POP -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3648">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3649">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$POP&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3650">
          <span class="hits">14</span>
          
          <code class="ruby">    # if no args, gives list of availabale work units; otherwise interprets argument as a work name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3651">
          <span class="hits">14</span>
          
          <code class="ruby">    workUserSelectOne WORK_NAME &#39;&#39; true &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3652">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3653">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3654">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;${LIQ_WORK_DB}/curr_work&quot; -ef &quot;${LIQ_WORK_DB}/${WORK_NAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3655">
          <span class="hits">14</span>
          
          <code class="ruby">        echowarn &quot;&#39;$WORK_NAME&#39; is already the current unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3656">
          <span class="hits">14</span>
          
          <code class="ruby">        exit 0</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3657">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3658">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3659">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -f &quot;${LIQ_WORK_DB}/prev_work00&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3660">
          <span class="hits">14</span>
          
          <code class="ruby">    local PREV_WORK</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3661">
          <span class="hits">14</span>
          
          <code class="ruby">    PREV_WORK=&quot;$(ls ${LIQ_WORK_DB}/prev_work?? | sort --reverse | head -n 1)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3662">
          <span class="hits">14</span>
          
          <code class="ruby">    mv &quot;$PREV_WORK&quot; &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3663">
          <span class="hits">14</span>
          
          <code class="ruby">    WORK_NAME=&quot;$(source ${LIQ_WORK_DB}/curr_work; echo &quot;$WORK_BRANCH&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3664">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3665">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No previous unit of work found.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3666">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3667">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3668">
          <span class="hits">14</span>
          
          <code class="ruby">  workSwitchBranches &quot;$WORK_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3669">
          <span class="hits">14</span>
          
          <code class="ruby">  (</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3670">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_WORK_DB}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3671">
          <span class="hits">14</span>
          
          <code class="ruby">    rm -f curr_work</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3672">
          <span class="hits">14</span>
          
          <code class="ruby">    ln -s &quot;${WORK_NAME}&quot; curr_work</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3673">
          <span class="hits">14</span>
          
          <code class="ruby">  )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3674">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3675">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Resumed &#39;$WORK_NAME&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3676">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3677">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3678">
          <span class="hits">14</span>
          
          <code class="ruby"># Alias for &#39;work-resume&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3679">
          <span class="hits">14</span>
          
          <code class="ruby">work-join() { work-resume &quot;$@&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3680">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3681">
          <span class="hits">14</span>
          
          <code class="ruby">work-save() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3682">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3683">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3684">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions ALL MESSAGE= DESCRIPTION= NO_BACKUP:B BACKUP_ONLY -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3685">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3686">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$BACKUP_ONLY&quot; == true ]] &amp;&amp; [[ &quot;$NO_BACKUP&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3687">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Incompatible options: &#39;--backup-only&#39; and &#39;--no-backup&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3688">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3689">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3690">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$BACKUP_ONLY&quot; != true ]] &amp;&amp; [[ -z &quot;$MESSAGE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3691">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Must specify &#39;--message|-m&#39; (summary) for save.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3692">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3693">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3694">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$BACKUP_ONLY&quot; != true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3695">
          <span class="hits">14</span>
          
          <code class="ruby">    local OPTIONS=&quot;-m &#39;&quot;${MESSAGE//\&#39;/\&#39;\&quot;\&#39;\&quot;\&#39;}&quot;&#39; &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3696">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ $ALL == true ]]; then OPTIONS=&quot;${OPTIONS}--all &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3697">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ $DESCRIPTION == true ]]; then OPTIONS=&quot;${OPTIONS}-m &#39;&quot;${DESCRIPTION/&#39;//\&#39;/\&#39;\&quot;\&#39;\&quot;\&#39;}&quot;&#39; &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3698">
          <span class="hits">14</span>
          
          <code class="ruby">    # I have no idea why, but without the eval (even when &quot;$@&quot; dropped), this</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3699">
          <span class="hits">14</span>
          
          <code class="ruby">    # produced &#39;fatal: Paths with -a does not make sense.&#39; What&#39; path?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3700">
          <span class="hits">14</span>
          
          <code class="ruby">    eval git commit ${OPTIONS} &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3701">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3702">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$NO_BACKUP&quot; != true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3703">
          <span class="hits">14</span>
          
          <code class="ruby">    work-backup</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3704">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3705">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3706">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3707">
          <span class="hits">14</span>
          
          <code class="ruby">work-stage() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3708">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3709">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3710">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions ALL INTERACTIVE REVIEW DRY_RUN -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3711">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3712">
          <span class="hits">14</span>
          
          <code class="ruby">  local OPTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3713">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $ALL == true ]]; then OPTIONS=&quot;--all &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3714">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $INTERACTIVE == true ]]; then OPTIONS=&quot;${OPTIONS}--interactive &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3715">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $REVIEW == true ]]; then OPTIONS=&quot;${OPTIONS}--patch &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3716">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $DRY_RUN == true ]]; then OPTIONS=&quot;${OPTIONS}--dry-run &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3717">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3718">
          <span class="hits">14</span>
          
          <code class="ruby">  git add ${OPTIONS} &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3719">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3720">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3721">
          <span class="hits">14</span>
          
          <code class="ruby">work-status() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3722">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3723">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3724">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions PR_READY: NO_FETCH:F LIST_PROJECTS:p LIST_ISSUES:i -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3725">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3726">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3727">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_NAME LOCAL_COMMITS REMOTE_COMMITS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3728">
          <span class="hits">14</span>
          
          <code class="ruby">  WORK_NAME=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3729">
          <span class="hits">14</span>
          
          <code class="ruby">  # Set WORK_NAME to curr work if present</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3730">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${WORK_NAME}&quot; ]] || ! [[ -f &quot;${LIQ_WORK_DB}/curr_work&quot; ]] \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3731">
          <span class="hits">14</span>
          
          <code class="ruby">    || WORK_NAME=&quot;$(basename $(readlink &quot;${LIQ_WORK_DB}/curr_work&quot;))&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3732">
          <span class="hits">14</span>
          
          <code class="ruby">  [[ -n &quot;${WORK_NAME}&quot; ]] || echoerrandexit &quot;No current work. You must specify work to show status.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3733">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3734">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$PR_READY&quot; == true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3735">
          <span class="hits">14</span>
          
          <code class="ruby">    git fetch workspace &quot;${WORK_NAME}:remotes/workspace/${WORK_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3736">
          <span class="hits">14</span>
          
          <code class="ruby">    TMP=&quot;$(git rev-list --left-right --count $WORK_NAME...workspace/$WORK_NAME)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3737">
          <span class="hits">14</span>
          
          <code class="ruby">    LOCAL_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f1)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3738">
          <span class="hits">14</span>
          
          <code class="ruby">    REMOTE_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f2)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3739">
          <span class="hits">14</span>
          
          <code class="ruby">    (( $LOCAL_COMMITS == 0 )) &amp;&amp; (( $REMOTE_COMMITS == 0 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3740">
          <span class="hits">14</span>
          
          <code class="ruby">    return $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3741">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3742">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3743">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/${WORK_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3744">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$LIST_PROJECTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3745">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$INVOLVED_PROJECTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3746">
          <span class="hits">14</span>
          
          <code class="ruby">    return $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3747">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$LIST_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3748">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;$WORK_ISSUES&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3749">
          <span class="hits">14</span>
          
          <code class="ruby">    return $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3750">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3751">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3752">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$NO_FETCH&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3753">
          <span class="hits">14</span>
          
          <code class="ruby">    work-sync --fetch-only</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3754">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3755">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3756">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Branch name: $WORK_NAME&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3757">
          <span class="hits">14</span>
          
          <code class="ruby">  echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3758">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$INVOLVED_PROJECTS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3759">
          <span class="hits">14</span>
          
          <code class="ruby">    &quot;Involved projects: &lt;none&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3760">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3761">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Involved projects:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3762">
          <span class="hits">14</span>
          
          <code class="ruby">    local IP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3763">
          <span class="hits">14</span>
          
          <code class="ruby">    for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3764">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  $IP&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3765">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3766">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3767">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3768">
          <span class="hits">14</span>
          
          <code class="ruby">  echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3769">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$WORK_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3770">
          <span class="hits">14</span>
          
          <code class="ruby">    &quot;Issues: &lt;none&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3771">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3772">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Issues:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3773">
          <span class="hits">14</span>
          
          <code class="ruby">    local ISSUE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3774">
          <span class="hits">14</span>
          
          <code class="ruby">    for ISSUE in $WORK_ISSUES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3775">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  $ISSUE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3776">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3777">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3778">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3779">
          <span class="hits">14</span>
          
          <code class="ruby">  for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3780">
          <span class="hits">14</span>
          
          <code class="ruby">    IP=&quot;${IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3781">
          <span class="hits">14</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3782">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Repo status for $IP:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3783">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/$IP&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3784">
          <span class="hits">14</span>
          
          <code class="ruby">    TMP=&quot;$(git rev-list --left-right --count master...upstream/master)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3785">
          <span class="hits">14</span>
          
          <code class="ruby">    LOCAL_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f1)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3786">
          <span class="hits">14</span>
          
          <code class="ruby">    REMOTE_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f2)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3787">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $LOCAL_COMMITS == 0 )) &amp;&amp; (( $REMOTE_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3788">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  Local master up to date.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3789">
          <span class="hits">14</span>
          
          <code class="ruby">    elif (( $LOCAL_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3790">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow_b}Local master behind upstream/master $REMOTE_COMMITS.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3791">
          <span class="hits">14</span>
          
          <code class="ruby">    elif (( $REMOTE_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3792">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow_b}Local master ahead upstream/master $LOCAL_COMMITS.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3793">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3794">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow_b}Local master ahead upstream/master $LOCAL_COMMITS and behind $REMOTE_COMMITS.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3795">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3796">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3797">
          <span class="hits">14</span>
          
          <code class="ruby">    local NEED_SYNC</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3798">
          <span class="hits">14</span>
          
          <code class="ruby">    TMP=&quot;$(git rev-list --left-right --count $WORK_NAME...workspace/$WORK_NAME)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3799">
          <span class="hits">14</span>
          
          <code class="ruby">    LOCAL_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f1)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3800">
          <span class="hits">14</span>
          
          <code class="ruby">    REMOTE_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f2)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3801">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $REMOTE_COMMITS == 0 )) &amp;&amp; (( $LOCAL_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3802">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  Local workbranch up to date with workspace.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3803">
          <span class="hits">14</span>
          
          <code class="ruby">      TMP=&quot;$(git rev-list --left-right --count master...$WORK_NAME)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3804">
          <span class="hits">14</span>
          
          <code class="ruby">      local MASTER_COMMITS WORKBRANCH_COMMITS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3805">
          <span class="hits">14</span>
          
          <code class="ruby">      MASTER_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f1)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3806">
          <span class="hits">14</span>
          
          <code class="ruby">      WORKBRANCH_COMMITS=$(echo $TMP | cut -d&#39; &#39; -f2)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3807">
          <span class="hits">14</span>
          
          <code class="ruby">      if (( $MASTER_COMMITS == 0 )) &amp;&amp; (( $WORKBRANCH_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3808">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Local workbranch and master up to date.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3809">
          <span class="hits">14</span>
          
          <code class="ruby">      elif (( $MASTER_COMMITS &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3810">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  ${yellow}Workbranch behind master $MASTER_COMMITS commits.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3811">
          <span class="hits">14</span>
          
          <code class="ruby">        NEED_SYNC=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3812">
          <span class="hits">14</span>
          
          <code class="ruby">      elif (( $WORKBRANCH_COMMITS &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3813">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;  Local workbranch ahead of master $WORKBRANCH_COMMITS commits.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3814">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3815">
          <span class="hits">14</span>
          
          <code class="ruby">    elif (( $LOCAL_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3816">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow}Local workbranch behind workspace by $REMOTE_COMMITS commits.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3817">
          <span class="hits">14</span>
          
          <code class="ruby">      NEED_SYNC=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3818">
          <span class="hits">14</span>
          
          <code class="ruby">    elif (( $REMOTE_COMMITS == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3819">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow}Local workranch ahead of workspace by $LOCAL_COMMITS commits.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3820">
          <span class="hits">14</span>
          
          <code class="ruby">      NEED_SYNC=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3821">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3822">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow}Local workranch ahead of workspace by $LOCAL_COMMITS and behind ${REMOTE_COMMITS} commits.${reset}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3823">
          <span class="hits">14</span>
          
          <code class="ruby">      NEED_SYNC=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3824">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3825">
          <span class="hits">14</span>
          
          <code class="ruby">    if (( $REMOTE_COMMITS != 0 )) || (( $LOCAL_COMMITS != 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3826">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  ${yellow}Unable to analyze master-workbranch drift due to above issues.${reset}&quot; | fold -sw 82</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3827">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3828">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$NEED_SYNC&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3829">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;  Consider running:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3830">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;    liq work sync&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3831">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3832">
          <span class="hits">14</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3833">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;  Local changes:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3834">
          <span class="hits">14</span>
          
          <code class="ruby">    git status --short</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3835">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3836">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3837">
          <span class="hits">14</span>
          
          <code class="ruby"># alias TODO: I think I might like &#39;show&#39; better after all</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3838">
          <span class="hits">14</span>
          
          <code class="ruby">work-show() { work-status &quot;$@&quot;; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3839">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3840">
          <span class="hits">14</span>
          
          <code class="ruby">work-start() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3841">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3842">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3843">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3844">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3845">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions ISSUES= PUSH DESCRIPTION= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3846">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3847">
          <span class="hits">14</span>
          
          <code class="ruby">  local CURR_PROJECT ISSUES_URL BUGS_URL WORK_ISSUES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3848">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$BASE_DIR&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3849">
          <span class="hits">14</span>
          
          <code class="ruby">    CURR_PROJECT=$(cat &quot;$BASE_DIR/package.json&quot; | jq --raw-output &#39;.name&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3850">
          <span class="hits">14</span>
          
          <code class="ruby">    BUGS_URL=$(cat &quot;$BASE_DIR/package.json&quot; | jq --raw-output &#39;.bugs.url&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3851">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3852">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3853">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3854">
          <span class="hits">14</span>
          
          <code class="ruby">  work-lib-process-issues WORK_ISSUES &quot;$ISSUES&quot; &quot;$BUGS_URL&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3855">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3856">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$WORK_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3857">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Must specify at least 1 issue when starting a new unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3858">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3859">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3860">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$DESCRIPTION&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3861">
          <span class="hits">14</span>
          
          <code class="ruby">    local PRIMARY_ISSUE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3862">
          <span class="hits">14</span>
          
          <code class="ruby">    # The issues have been normalized, so his is always a URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3863">
          <span class="hits">14</span>
          
          <code class="ruby">    PRIMARY_ISSUE=$(list-get-item WORK_ISSUES 0 | sed -Ee &#39;s|.+/([[:digit:]]+)$|\1|&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3864">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3865">
          <span class="hits">14</span>
          
          <code class="ruby">    DESCRIPTION=&quot;$(hub issue show $PRIMARY_ISSUE | head -n 1 | sed -E &#39;s/^# *//&#39;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3866">
          <span class="hits">14</span>
          
          <code class="ruby">      || echoerrandexit &quot;Error trying to extract issue description from: ${BUGS_URL}/${PRIMARY_ISSUE}\nThe primary issues must be part of the current project.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3867">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3868">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3869">
          <span class="hits">14</span>
          
          <code class="ruby">  WORK_STARTED=$(date &quot;+%Y.%m.%d&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3870">
          <span class="hits">14</span>
          
          <code class="ruby">  WORK_INITIATOR=$(whoami)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3871">
          <span class="hits">14</span>
          
          <code class="ruby">  WORK_BRANCH=`work-lib-branch-name &quot;${DESCRIPTION}&quot;`</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3872">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3873">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -f &quot;${LIQ_WORK_DB}/${WORK_BRANCH}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3874">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Unit of work &#39;${WORK_BRANCH}&#39; aready exists. Bailing out.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3875">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3876">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3877">
          <span class="hits">14</span>
          
          <code class="ruby">  # TODO: check that current work branch is clean before switching away from it</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3878">
          <span class="hits">14</span>
          
          <code class="ruby">  # https://github.com/Liquid-Labs/liq-cli/issues/14</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3879">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3880">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3881">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$PUSH&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3882">
          <span class="hits">14</span>
          
          <code class="ruby">      local PREV_WORK LAST NEXT</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3883">
          <span class="hits">14</span>
          
          <code class="ruby">      LAST=&#39;-1&#39; # starts us at 0 after the undconditional +1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3884">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -f ${LIQ_WORK_DB}/prev_work00 ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3885">
          <span class="hits">14</span>
          
          <code class="ruby">        for PREV_WORK in $(ls ${LIQ_WORK_DB}/prev_work?? | sort); do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3886">
          <span class="hits">14</span>
          
          <code class="ruby">          LAST=${i:$((${#i} - 2))}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3887">
          <span class="hits">14</span>
          
          <code class="ruby">        done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3888">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3889">
          <span class="hits">14</span>
          
          <code class="ruby">      NEXT=$(( $LAST + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3890">
          <span class="hits">14</span>
          
          <code class="ruby">      if (( $NEXT &gt; 99 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3891">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerrandexit &quot;There are already 100 &#39;pushed&#39; units of work; limit reached.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3892">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3893">
          <span class="hits">14</span>
          
          <code class="ruby">      mv &quot;${LIQ_WORK_DB}/curr_work&quot; &quot;${LIQ_WORK_DB}/prev_work$(printf &#39;%02d&#39; &quot;${NEXT}&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3894">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3895">
          <span class="hits">14</span>
          
          <code class="ruby">      rm &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3896">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3897">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3898">
          <span class="hits">14</span>
          
          <code class="ruby">  touch &quot;${LIQ_WORK_DB}/${WORK_BRANCH}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3899">
          <span class="hits">14</span>
          
          <code class="ruby">  cd ${LIQ_WORK_DB} &amp;&amp; ln -s &quot;${WORK_BRANCH}&quot; curr_work</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3900">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_DESC=&quot;$DESCRIPTION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3901">
          <span class="hits">14</span>
          
          <code class="ruby">  workUpdateWorkDb</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3902">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3903">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$CURR_PROJECT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3904">
          <span class="hits">14</span>
          
          <code class="ruby">    (</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3905">
          <span class="hits">14</span>
          
          <code class="ruby">      cd &quot;${LIQ_PLAYGROUND}/${CURR_PROJECT/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3906">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Adding current project &#39;$CURR_PROJECT&#39; to unit of work...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3907">
          <span class="hits">14</span>
          
          <code class="ruby">      work-involve &quot;$CURR_PROJECT&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3908">
          <span class="hits">14</span>
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3909">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3910">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3911">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3912">
          <span class="hits">14</span>
          
          <code class="ruby">work-stop() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3913">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase # TODO: basically, we use this to imply that we&#39;re in a repo. It&#39;s not quite the right quetsion.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3914">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3915">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions KEEP_CHECKOUT -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3916">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3917">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3918">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3919">
          <span class="hits">14</span>
          
          <code class="ruby">    local CURR_WORK=$(basename $(readlink &quot;${LIQ_WORK_DB}/curr_work&quot;))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3920">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$KEEP_CHECKOUT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3921">
          <span class="hits">14</span>
          
          <code class="ruby">      workSwitchBranches master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3922">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3923">
          <span class="hits">14</span>
          
          <code class="ruby">      source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3924">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Current branch &quot;$CURR_WORK&quot; maintained for ${INVOLVED_PROJECTS}.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3925">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3926">
          <span class="hits">14</span>
          
          <code class="ruby">    rm &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3927">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Paused work on &#39;$CURR_WORK&#39;. No current unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3928">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3929">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No current unit of work to stop.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3930">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3931">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3932">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3933">
          <span class="hits">14</span>
          
          <code class="ruby">work-sync() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3934">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions FETCH_ONLY -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3935">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3936">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3937">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -f &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3938">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No current unit of work. Try:\nliq projects sync&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3939">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3940">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3941">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3942">
          <span class="hits">14</span>
          
          <code class="ruby">  local IP OPTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3943">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;$FETCH_ONLY&quot; ]]; then OPTS=&quot;--fetch-only &quot;; fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3944">
          <span class="hits">14</span>
          
          <code class="ruby">  for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3945">
          <span class="hits">14</span>
          
          <code class="ruby">    (</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3946">
          <span class="hits">14</span>
          
          <code class="ruby">      cd &quot;${LIQ_PLAYGROUND}/${IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3947">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;Syncing project &#39;${IP}&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3948">
          <span class="hits">14</span>
          
          <code class="ruby">      projects-sync ${OPTS} &quot;${IP}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3949">
          <span class="hits">14</span>
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3950">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3951">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3952">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3953">
          <span class="hits">14</span>
          
          <code class="ruby">work-test() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3954">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions SELECT -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3955">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3956">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3957">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3958">
          <span class="hits">14</span>
          
          <code class="ruby">  workUserSelectOne WORK_NAME &quot;$((test -n &quot;$SELECT&quot; &amp;&amp; echo &#39;&#39;) || echo &quot;true&quot;)&quot; &#39;&#39; &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3959">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/${WORK_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3960">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3961">
          <span class="hits">14</span>
          
          <code class="ruby">  local IP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3962">
          <span class="hits">14</span>
          
          <code class="ruby">  for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3963">
          <span class="hits">14</span>
          
          <code class="ruby">    IP=&quot;${IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3964">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Testing ${IP}...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3965">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${IP}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3966">
          <span class="hits">14</span>
          
          <code class="ruby">    projects-test &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3967">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3968">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3969">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3970">
          <span class="hits">14</span>
          
          <code class="ruby">work-submit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3971">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions MESSAGE= NOT_CLEAN:C NO_CLOSE:X NO_BROWSE:B FORCE -- &quot;$@&quot;)&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3972">
          <span class="hits">14</span>
          
          <code class="ruby">    || ( contextHelp; echoerrandexit &quot;Bad options.&quot; )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3973">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3974">
          <span class="hits">14</span>
          
          <code class="ruby">  findBase</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3975">
          <span class="hits">14</span>
          
          <code class="ruby">  check-git-access</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3976">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3977">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ ! -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3978">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;No current unit of work. Try:\nliq work select.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3979">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3980">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3981">
          <span class="hits">14</span>
          
          <code class="ruby">  source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3982">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3983">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$MESSAGE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3984">
          <span class="hits">14</span>
          
          <code class="ruby">    MESSAGE=&quot;$WORK_DESC&quot; # sourced from current work</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3985">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3986">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3987">
          <span class="hits">14</span>
          
          <code class="ruby">  local TO_SUBMIT=&quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3988">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$TO_SUBMIT&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3989">
          <span class="hits">14</span>
          
          <code class="ruby">    TO_SUBMIT=&quot;$INVOLVED_PROJECTS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3990">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3991">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3992">
          <span class="hits">14</span>
          
          <code class="ruby">  local IP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3993">
          <span class="hits">14</span>
          
          <code class="ruby">  # preflilght check</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3994">
          <span class="hits">14</span>
          
          <code class="ruby">  for IP in $TO_SUBMIT; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3995">
          <span class="hits">14</span>
          
          <code class="ruby">    IP=$(workConvertDot &quot;$IP&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3996">
          <span class="hits">14</span>
          
          <code class="ruby">    if ! echo &quot;$INVOLVED_PROJECTS&quot; | grep -qE &#39;(^| +)&#39;$IP&#39;( +|$)&#39;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3997">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Project &#39;$IP&#39; not in the current unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3998">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="3999">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4000">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$NOT_CLEAN&quot; != true ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4001">
          <span class="hits">14</span>
          
          <code class="ruby">      requireCleanRepo &quot;${IP}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4002">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4003">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: This is incorrect, we need to check IP; https://github.com/Liquid-Labs/liq-cli/issues/121</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4004">
          <span class="hits">14</span>
          
          <code class="ruby">    # TODO: might also be redundant with &#39;requireCleanRepo&#39;...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4005">
          <span class="hits">14</span>
          
          <code class="ruby">    if ! work-status --pr-ready; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4006">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Local work branch not in sync with remote work branch. Try:\nliq work save --backup-only&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4007">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4008">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4009">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4010">
          <span class="hits">14</span>
          
          <code class="ruby">  # OK, let&#39;s do it</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4011">
          <span class="hits">14</span>
          
          <code class="ruby">  for IP in $TO_SUBMIT; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4012">
          <span class="hits">14</span>
          
          <code class="ruby">    IP=$(workConvertDot &quot;$IP&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4013">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4014">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Preparing PR for ${IP}...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4015">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4016">
          <span class="hits">14</span>
          
          <code class="ruby">    local DESC=&quot;Merge ${WORK_BRANCH} to master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4017">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4018">
          <span class="hits">14</span>
          
          <code class="ruby">## Summary</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4019">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4020">
          <span class="hits">14</span>
          
          <code class="ruby">${MESSAGE}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4021">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4022">
          <span class="hits">14</span>
          
          <code class="ruby">## Issues</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4023">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4024">
          <span class="hits">14</span>
          
          <code class="ruby">&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4025">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4026">
          <span class="hits">14</span>
          
          <code class="ruby">    local PROJ_ISSUES=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4027">
          <span class="hits">14</span>
          
          <code class="ruby">    local OTHER_ISSUES=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4028">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4029">
          <span class="hits">14</span>
          
          <code class="ruby">    # get IP bugs URL in order to figure out what tasks are directly related to this project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4030">
          <span class="hits">14</span>
          
          <code class="ruby">    local BUGS_URL</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4031">
          <span class="hits">14</span>
          
          <code class="ruby">    BUGS_URL=$(cat &quot;${LIQ_PLAYGROUND}/${IP/@/}/package.json&quot; | jq --raw-output &#39;.bugs.url&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4032">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4033">
          <span class="hits">14</span>
          
          <code class="ruby">    local ISSUE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4034">
          <span class="hits">14</span>
          
          <code class="ruby">    for ISSUE in $WORK_ISSUES; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4035">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ $ISSUE == $BUGS_URL* ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4036">
          <span class="hits">14</span>
          
          <code class="ruby">        local NUMBER=${ISSUE/$BUGS_URL/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4037">
          <span class="hits">14</span>
          
          <code class="ruby">        NUMBER=${NUMBER/\//}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4038">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item PROJ_ISSUES &quot;#${NUMBER}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4039">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4040">
          <span class="hits">14</span>
          
          <code class="ruby">        local LABEL=&quot;$(echo &quot;$ISSUE&quot; | awk -F/ &#39;{ print $4&quot;/&quot;$5&quot;#&quot;$7 }&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4041">
          <span class="hits">14</span>
          
          <code class="ruby">        list-add-item OTHER_ISSUES &quot;[${LABEL}](${ISSUE})&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4042">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4043">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4044">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4045">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$PROJ_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4046">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;$NO_CLOSE&quot; ]];then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4047">
          <span class="hits">14</span>
          
          <code class="ruby">        DESC=&quot;${DESC}&quot;$&#39;\n&#39;&quot;$( for ISSUE in $PROJ_ISSUES; do echo &quot;* closes $ISSUE&quot;; done)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4048">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4049">
          <span class="hits">14</span>
          
          <code class="ruby">        DESC=&quot;${DESC}&quot;$&#39;\n&#39;&quot;$( for ISSUE in $PROJ_ISSUES; do echo &quot;* driven by $ISSUE&quot;; done)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4050">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4051">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4052">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$OTHER_ISSUES&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4053">
          <span class="hits">14</span>
          
          <code class="ruby">      DESC=&quot;${DESC}&quot;$&#39;\n&#39;&quot;$( for ISSUE in ${OTHER_ISSUES}; do echo &quot;* involved with $ISSUE&quot;; done)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4054">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4055">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4056">
          <span class="hits">14</span>
          
          <code class="ruby">    # check for the &#39;work-policy-review&#39; extension point</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4057">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ $(type -t &quot;work-policy-review&quot; || echo &#39;&#39;) == &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4058">
          <span class="hits">14</span>
          
          <code class="ruby">      DESC=&quot;${DESC}$(work-policy-review &quot;$TO_SUBMIT&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4059">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4060">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4061">
          <span class="hits">14</span>
          
          <code class="ruby">    local BASE_TARGET # this is the &#39;org&#39; of the upsteram branch</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4062">
          <span class="hits">14</span>
          
          <code class="ruby">    BASE_TARGET=$(git remote -v | grep &#39;^upstream&#39; | grep &#39;(push)&#39; | sed -E &#39;s|.+[/:]([^/]+)/[^/]+$|\1|&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4063">
          <span class="hits">14</span>
          
          <code class="ruby">    # Some research indicates that explicitly specifying head can work around some bugs...</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4064">
          <span class="hits">14</span>
          
          <code class="ruby">    # local BASE_HEAD</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4065">
          <span class="hits">14</span>
          
          <code class="ruby">    # BASE_HEAD=$(git remote -v | grep &#39;^workspace&#39; | grep &#39;(push)&#39; | sed -E &#39;s|.+[/:]([^/]+)/[^/]+$|\1|&#39;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4066">
          <span class="hits">14</span>
          
          <code class="ruby">    local PULL_OPTS=&quot;--push --base=${BASE_TARGET}:master&quot; #--head=${BASE_HEAD}:${WORK_BRANCH}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4067">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$NO_BROWSE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4068">
          <span class="hits">14</span>
          
          <code class="ruby">      PULL_OPTS=&quot;$PULL_OPTS --browse&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4069">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4070">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;$FORCE&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4071">
          <span class="hits">14</span>
          
          <code class="ruby">      PULL_OPTS=&quot;$PULL_OPTS --force&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4072">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4073">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Submitting PR for &#39;$IP&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4074">
          <span class="hits">14</span>
          
          <code class="ruby">    hub pull-request $PULL_OPTS -m &quot;${DESC}&quot; || {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4075">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;Submission failed. If you see an error mentioning &#39;Invalid value for \&quot;head\&quot;&#39;, check to see if your forked working repository has become detached. If this is the case, you can delete the working repo on GitHub, refork from the source, and then &#39;liq work save --backup-only&#39; from your local checkout. This will update the new forked repo with your workbranch changes and you should be able to submit after that.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4076">
          <span class="hits">14</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4077">
          <span class="hits">14</span>
          
          <code class="ruby">  done # TO_SUBMIT processing loop</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4078">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4079">
          <span class="hits">8</span>
          
          <code class="ruby">WORK_GROUPS=&quot;links&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4080">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4081">
          <span class="hits">14</span>
          
          <code class="ruby">help-work() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4082">
          <span class="hits">14</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4083">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4084">
          <span class="hits">14</span>
          
          <code class="ruby">  local SUMMARY=&quot;Manages the current unit of work.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4085">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4086">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}work${reset} &lt;action&gt;: ${SUMMARY}&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4087">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}work${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4088">
          <span class="hits">14</span>
          
          <code class="ruby">$(echo &quot;${SUMMARY} A &#39;unit of work&#39; is essentially a set of work branches across all involved projects. The first project involved in a unit of work is considered the primary project, which will effect automated linking when involving other projects.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4089">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4090">
          <span class="hits">14</span>
          
          <code class="ruby">${red_b}ALPHA Note:${reset} The &#39;stop&#39; and &#39;resume&#39; actions do not currently manage the work branches and only updates the &#39;current work&#39; pointer.&quot; | fold -sw 82 | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4091">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list work diff-master edit ignore-rest involve issues list merge report qa resume save stage start status stop submit sync test | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4092">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-sub-group-list work WORK_GROUPS)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4093">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4094">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4095">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4096">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-diff-master() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4097">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary diff-master &quot;[--mine|-m]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4098">
          <span class="hits">14</span>
          
          <code class="ruby">Shows committed changes since branch from &#39;master&#39; for all involved repositories.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4099">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4100">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4101">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4102">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-edit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4103">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary edit</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4104">
          <span class="hits">14</span>
          
          <code class="ruby">Opens a local project editor for all involved repositories. See `liq help projects edit`.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4105">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4106">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4107">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4108">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-ignore-rest() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4109">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary ignore-rest</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4110">
          <span class="hits">14</span>
          
          <code class="ruby">Adds any currently untracked files to &#39;.gitignore&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4111">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4112">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4113">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4114">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-involve() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4115">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary involve &quot;[--no-link|-L] [&lt;repository name&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4116">
          <span class="hits">14</span>
          
          <code class="ruby">Involves the current or named repository in the current unit of work. The newly involved project will be linked to other involved projects with a dependincy, and vice-a-versa, unless this would result in a circular reference in which case the &#39;back link&#39; (from the prior involved project to the newly added project) is skipped and a warning is given. The &#39;--no-link&#39; option will suppress the linking behavior.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4117">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4118">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4119">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4120">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-issues() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4121">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary issues &quot;[--list|--add|--remove]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4122">
          <span class="hits">14</span>
          
          <code class="ruby">Manages issues associated with the current unit of work. TODO: this should be re-worked as sub-group.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4123">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4124">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4125">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4126">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4127">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary list</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4128">
          <span class="hits">14</span>
          
          <code class="ruby">Lists the current, local, unclosed units of work.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4129">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4130">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4131">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4132">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-merge() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4133">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary merge</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4134">
          <span class="hits">14</span>
          
          <code class="ruby">Merges current work unit to master branches and updates mirrors.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4135">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4136">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4137">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4138">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-report() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4139">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary report</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4140">
          <span class="hits">14</span>
          
          <code class="ruby">Reports status of files in the current unit of work.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4141">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4142">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4143">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4144">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-qa() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4145">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary qa</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4146">
          <span class="hits">14</span>
          
          <code class="ruby">Checks the playground status and runs package audit, version check, and tests.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4147">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4148">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4149">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4150">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-resume() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4151">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary resume &quot;[--pop] [&lt;name&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4152">
          <span class="hits">14</span>
          
          <code class="ruby">alias: ${underline}join${reset}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4153">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4154">
          <span class="hits">14</span>
          
          <code class="ruby">Resume work or join an existing unit of work. If the &#39;--pop&#39; option is specified, then arguments will be ignored and the last &#39;pushed&#39; unit of work (see &#39;liq work start --push&#39;) will be resumed.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4155">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4156">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4157">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4158">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-save() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4159">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary save &quot;[-a|--all] [--backup-only|-b] [--message|-m=&lt;version ][&lt;path spec&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4160">
          <span class="hits">14</span>
          
          <code class="ruby">Save staged files to the local working branch. &#39;--all&#39; auto stages all known files (does not include new files) and saves them to the local working branch. &#39;--backup-only&#39; is useful if local commits have been made directly through &#39;git&#39; and you want to push them.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4161">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4162">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4163">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4164">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-stage() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4165">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary stage &quot;[-a|--all] [-i|--interactive] [-r|--review] [-d|--dry-run] [&lt;path spec&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4166">
          <span class="hits">14</span>
          
          <code class="ruby">Stages files for save.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4167">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4168">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4169">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4170">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-start() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4171">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary start &quot;[--issues|-i &lt;# or URL&gt;] [--description|-d &lt;work desc&gt;] [--push|-p]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4172">
          <span class="hits">14</span>
          
          <code class="ruby">Creates a new unit of work and adds the current repository (if any) to it. You must specify at least one issue. Use a comma separated list to specify mutliple issues. The first issue must be in the current working project and by default the &#39;work description&#39; is extracted from the issue summary/title. If &#39;--description&#39; is specified, then that description is used instead of the first issue title. The &#39;--push&#39; option will record the current unit of work which can then be recovered with &#39;liq work resume --pop&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4173">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4174">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4175">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4176">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-status() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4177">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary status &quot;[--list-projects|-p] [--list-issues|-i] [--no-fetch|-F] [--pr-ready] [&lt;name&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4178">
          <span class="hits">14</span>
          
          <code class="ruby">Shows details for the current or named unit of work. Will enter interactive selection if no option and no current work or the &#39;--select&#39; option is given. The &#39;--list-projects&#39; and &#39;--list-issues&#39; options are meant to be used on their own and will just list the involved projects or associated issues respectively. &#39;--no-fetch&#39; skips updating the local repositories. &#39;--pr-ready&#39; suppresses all output and just return (bash) true or false.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4179">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4180">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4181">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4182">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-stop() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4183">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary stop &quot;[-k|--keep-checkout]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4184">
          <span class="hits">14</span>
          
          <code class="ruby">Stops working on the current unit of work. The master branch will be checked out for all involved projects unless &#39;--keep-checkout&#39; is used.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4185">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4186">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4187">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4188">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-submit() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4189">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary submit &quot;[--message|-m &lt;summary message&gt;][--not-clean|-C] [--no-close|-X][&lt;projects&gt;]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4190">
          <span class="hits">14</span>
          
          <code class="ruby">Submits pull request for the current unit of work. With no projects specified, submits patches for all projects in the current unit of work. By default, PR will claim to close related issues unless &#39;--no-close&#39; is included.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4191">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4192">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4193">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4194">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-sync() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4195">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary sync &quot;[--fetch-only|-f] [--no-work-master-merge|-M]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4196">
          <span class="hits">14</span>
          
          <code class="ruby">Synchronizes local project repos for all work. See &#39;liq help work sync&#39; for details.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4197">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4198">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4199">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4200">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-test() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4201">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary test</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4202">
          <span class="hits">14</span>
          
          <code class="ruby">Runs tests for each involved project in the current unit of work. See &#39;project test&#39; for details on options for the &#39;test&#39; action.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4203">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4204">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4205">
          <span class="hits">14</span>
          
          <code class="ruby">work-lib-branch-name() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4206">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_DESC=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4207">
          <span class="hits">14</span>
          
          <code class="ruby">  requireArgs &quot;$WORK_DESC&quot; || exit $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4208">
          <span class="hits">14</span>
          
          <code class="ruby">  requireArgs &quot;$WORK_STARTED&quot; || exit $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4209">
          <span class="hits">14</span>
          
          <code class="ruby">  requireArgs &quot;$WORK_INITIATOR&quot; || exit $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4210">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;${WORK_STARTED}-${WORK_INITIATOR}-$(work-lib-safe-desc &quot;$WORK_DESC&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4211">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4212">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4213">
          <span class="hits">14</span>
          
          <code class="ruby">workConvertDot() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4214">
          <span class="hits">14</span>
          
          <code class="ruby">  local PROJ=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4215">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;${PROJ}&quot; == &quot;.&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4216">
          <span class="hits">14</span>
          
          <code class="ruby">    PROJ=$(cat &quot;$BASE_DIR/package.json&quot; | jq --raw-output &#39;.name&#39; | tr -d &quot;&#39;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4217">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4218">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$PROJ&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4219">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4220">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4221">
          <span class="hits">14</span>
          
          <code class="ruby">workCurrentWorkBranch() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4222">
          <span class="hits">14</span>
          
          <code class="ruby">  git branch | (grep &#39;*&#39; || true) | awk &#39;{print $2}&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4223">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4224">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4225">
          <span class="hits">14</span>
          
          <code class="ruby">work-lib-safe-desc() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4226">
          <span class="hits">14</span>
          
          <code class="ruby">  local WORK_DESC=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4227">
          <span class="hits">14</span>
          
          <code class="ruby">  requireArgs &quot;$WORK_DESC&quot; || exit $?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4228">
          <span class="hits">14</span>
          
          <code class="ruby">  # 1) change all spaces and hyphens to underscores.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4229">
          <span class="hits">14</span>
          
          <code class="ruby">  # 2) lower case everything.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4230">
          <span class="hits">14</span>
          
          <code class="ruby">  # 3) Remove any non-alphanumeric characters except &#39;_&#39;.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4231">
          <span class="hits">14</span>
          
          <code class="ruby">  # 4) Extract the first four words.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4232">
          <span class="hits">14</span>
          
          <code class="ruby">  # 5) Remove any trailing underscore.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4233">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;$WORK_DESC&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4234">
          <span class="hits">14</span>
          
          <code class="ruby">    | tr &#39; -&#39; &#39;_&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4235">
          <span class="hits">14</span>
          
          <code class="ruby">    | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4236">
          <span class="hits">14</span>
          
          <code class="ruby">    | sed -Ee &#39;s/[^[:alnum:]_]//g&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4237">
          <span class="hits">14</span>
          
          <code class="ruby">      -e &#39;s/(([[:alnum:]]+(_|$)){1,4}).*/\1/&#39; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4238">
          <span class="hits">14</span>
          
          <code class="ruby">      -e &#39;s/_$//&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4239">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4240">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4241">
          <span class="hits">14</span>
          
          <code class="ruby"># Runs submitter through interactive submit checks specified by company policy. Expects the CWD to be that of or within</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4242">
          <span class="hits">14</span>
          
          <code class="ruby"># the project being submitted.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4243">
          <span class="hits">14</span>
          
          <code class="ruby">workSubmitChecks() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4244">
          <span class="hits">14</span>
          
          <code class="ruby">  local RESULT_VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4245">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4246">
          <span class="hits">14</span>
          
          <code class="ruby">  local POLICY_DIR CC_TYPE CHECKS_FILE QUESTION RECORD</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4247">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4248">
          <span class="hits">14</span>
          
          <code class="ruby">  requirePackage</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4249">
          <span class="hits">14</span>
          
          <code class="ruby">  local CC_QUERY=&quot;.${LIQ_NPM_KEY}.changeControl.type&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4250">
          <span class="hits">14</span>
          
          <code class="ruby">  CC_TYPE=&quot;$(echo &quot;$PACKAGE&quot; | jq --raw-output &quot;$CC_QUERY&quot; | tr -d &quot;&#39;&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4251">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$CC_TYPE&quot; ]] || [[ &quot;$CC_TYPE&quot; == &#39;null&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4252">
          <span class="hits">14</span>
          
          <code class="ruby">    echoerrandexit &quot;Package &#39;$PACKAGE_NAME&#39; does not define &#39;$CC_QUERY&#39;; bailing out.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4253">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4254">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4255">
          <span class="hits">14</span>
          
          <code class="ruby">  local FIRST_REASON=true</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4256">
          <span class="hits">14</span>
          
          <code class="ruby">  local HAS_EXCEPTIONS=&#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4257">
          <span class="hits">14</span>
          
          <code class="ruby">  local DEF_REASON DEF_MITIGATION</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4258">
          <span class="hits">14</span>
          
          <code class="ruby">  # you would think we wou we would declare these in &#39;getReasons&#39;, but bash is funny with vars, and the inner-function</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4259">
          <span class="hits">14</span>
          
          <code class="ruby">  # locals (appearently) have strange effects and even &#39;unset&#39;-ing them doesn&#39;t clear the vars as they appear to the</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4260">
          <span class="hits">14</span>
          
          <code class="ruby">  # &#39;require-answer&#39; function.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4261">
          <span class="hits">14</span>
          
          <code class="ruby">  local REASON MITIGATION</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4262">
          <span class="hits">14</span>
          
          <code class="ruby">  getReasons() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4263">
          <span class="hits">14</span>
          
          <code class="ruby">    unset REASON MITIGATION</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4264">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4265">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${FIRST_REASON:-}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4266">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4267">
          <span class="hits">14</span>
          
          <code class="ruby">      yes-no &quot;By continuing, you are submitting these changes with an explicit exception. Do you wish to continue? (yes/no) &quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4268">
          <span class="hits">14</span>
          
          <code class="ruby">        || { echo &quot;Submission cancelled.&quot;; exit 0; }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4269">
          <span class="hits">14</span>
          
          <code class="ruby">      unset FIRST_REASON</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4270">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4271">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4272">
          <span class="hits">14</span>
          
          <code class="ruby">      echofmt &quot;reset&quot; &quot;(Your explanation may use markdown format, but it is not required.)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4273">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4274">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4275">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4276">
          <span class="hits">14</span>
          
          <code class="ruby">    require-answer --multi-line &quot;${yellow}Please provide a complete description as to why the exception is necessary:${reset} &quot; REASON &quot;$DEF_REASON&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4277">
          <span class="hits">14</span>
          
          <code class="ruby">    require-answer --multi-line &quot;${yellow}Please describe the steps ALREADY TAKEN (such as creating a task to revisit the issue, etc.) to mitigate and/or address this exception in a timely manner:${reset} &quot; MITIGATION &quot;$DEF_MITIGATION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4278">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4279">
          <span class="hits">14</span>
          
          <code class="ruby">    DEF_REASON=&quot;${REASON}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4280">
          <span class="hits">14</span>
          
          <code class="ruby">    DEF_MITIGATION=&quot;${MITIGATION}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4281">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4282">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt yellow &quot;You will now be asked to review and confirm your answers. (Hit enter to continue.)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4283">
          <span class="hits">14</span>
          
          <code class="ruby">    read</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4284">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt green_b &quot;Reason for the exception:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4285">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${REASON}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4286">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;(Hit enter to continue)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4287">
          <span class="hits">14</span>
          
          <code class="ruby">    read</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4288">
          <span class="hits">14</span>
          
          <code class="ruby">    echofmt green_b &quot;Steps taken to mitigate exception:&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4289">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;${MITIGATION}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4290">
          <span class="hits">14</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4291">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4292">
          <span class="hits">14</span>
          
          <code class="ruby">    if yes-no &quot;Are these statements true and complete? (yes/no) &quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4293">
          <span class="hits">14</span>
          
          <code class="ruby">      RECORD=&quot;${RECORD}&quot;$&#39;\n&#39;&#39; &#39;$&#39;\n&#39;&quot;**_Reason given for excepion:_**&quot;$&#39;\n&#39;&quot;$REASON&quot;$&#39;\n&#39;&#39; &#39;$&#39;\n&#39;&quot;**_Steps taken to mitigate:_**&quot;$&#39;\n&#39;&quot;$MITIGATION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4294">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4295">
          <span class="hits">14</span>
          
          <code class="ruby">      getReasons</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4296">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4297">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4298">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4299">
          <span class="hits">14</span>
          
          <code class="ruby">  submitQuery() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4300">
          <span class="hits">14</span>
          
          <code class="ruby">    local ANSWER</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4301">
          <span class="hits">14</span>
          
          <code class="ruby">    require-answer &quot;confirmed/no/cancel: &quot; ANSWER</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4302">
          <span class="hits">14</span>
          
          <code class="ruby">    ANSWER=&quot;$(echo &quot;$ANSWER&quot; | tr &#39;[:upper:]&#39; &#39;[:lower:]&#39;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4303">
          <span class="hits">14</span>
          
          <code class="ruby">    case &quot;$ANSWER&quot; in</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4304">
          <span class="hits">14</span>
          
          <code class="ruby">      confirmed)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4305">
          <span class="hits">14</span>
          
          <code class="ruby">        RECORD=&quot;$RECORD&quot;$&#39;\n&#39;&quot;**_Answer:_** $ANSWER&quot;;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4306">
          <span class="hits">14</span>
          
          <code class="ruby">      no)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4307">
          <span class="hits">14</span>
          
          <code class="ruby">        HAS_EXCEPTIONS=false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4308">
          <span class="hits">14</span>
          
          <code class="ruby">        RECORD=&quot;$RECORD&quot;$&#39;\n&#39;&quot;**_Answer:_** $ANSWER&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4309">
          <span class="hits">14</span>
          
          <code class="ruby">        getReasons;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4310">
          <span class="hits">14</span>
          
          <code class="ruby">      cancel)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4311">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;Submission cancelled.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4312">
          <span class="hits">14</span>
          
          <code class="ruby">        exit 0;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4313">
          <span class="hits">14</span>
          
          <code class="ruby">      *)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4314">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerr &quot;You must fully spell out &#39;confirmed&#39;, &#39;no&#39;, or &#39;cancel&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4315">
          <span class="hits">14</span>
          
          <code class="ruby">        submitQuery;;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4316">
          <span class="hits">14</span>
          
          <code class="ruby">    esac</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4317">
          <span class="hits">14</span>
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4318">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4319">
          <span class="hits">14</span>
          
          <code class="ruby">  # We setup named pipes that we use to feed the embedded reads without them stepping on each other.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4320">
          <span class="hits">14</span>
          
          <code class="ruby">  local POLICY_DIRS=/tmp/policy_dirs</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4321">
          <span class="hits">14</span>
          
          <code class="ruby">  rm -f $POLICY_DIRS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4322">
          <span class="hits">14</span>
          
          <code class="ruby">  policiesGetPolicyDirs &gt; $POLICY_DIRS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4323">
          <span class="hits">14</span>
          
          <code class="ruby">  exec 10&lt; $POLICY_DIRS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4324">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4325">
          <span class="hits">14</span>
          
          <code class="ruby">  while read -u 10 POLICY_DIR; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4326">
          <span class="hits">14</span>
          
          <code class="ruby">    local CHECKS_FILES=/tmp/checks_files</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4327">
          <span class="hits">14</span>
          
          <code class="ruby">    rm -f $CHECKS_FILES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4328">
          <span class="hits">14</span>
          
          <code class="ruby">    find &quot;${POLICY_DIR}&quot; -path &quot;*/policy/change-control/${CC_TYPE}/*&quot; -name &quot;*submit-checks.tsv&quot; &gt; $CHECKS_FILES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4329">
          <span class="hits">14</span>
          
          <code class="ruby">    exec 11&lt; $CHECKS_FILES</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4330">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4331">
          <span class="hits">14</span>
          
          <code class="ruby">    while read -u 11 CHECKS_FILE; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4332">
          <span class="hits">14</span>
          
          <code class="ruby">      local QUESTIONS=/tmp/questions</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4333">
          <span class="hits">14</span>
          
          <code class="ruby">      rm -f $QUESTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4334">
          <span class="hits">14</span>
          
          <code class="ruby">      tail +2 &quot;${CHECKS_FILE}&quot; | perl -e &#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4335">
          <span class="hits">14</span>
          
          <code class="ruby">        use strict; use warnings;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4336">
          <span class="hits">14</span>
          
          <code class="ruby">        while (&lt;&gt;) {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4337">
          <span class="hits">14</span>
          
          <code class="ruby">          if (!/^\s*$/) {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4338">
          <span class="hits">14</span>
          
          <code class="ruby">            my ($question, $absCondition) = split(/\t/, &quot;$_&quot;);</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4339">
          <span class="hits">14</span>
          
          <code class="ruby">            chomp($question);</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4340">
          <span class="hits">14</span>
          
          <code class="ruby">            my $include = 1;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4341">
          <span class="hits">14</span>
          
          <code class="ruby">            if ($absCondition) {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4342">
          <span class="hits">14</span>
          
          <code class="ruby">              my @conditions = split(/\s*,\s*/, $absCondition);</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4343">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4344">
          <span class="hits">14</span>
          
          <code class="ruby">              while (@conditions &amp;&amp; $include) {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4345">
          <span class="hits">14</span>
          
          <code class="ruby">                my $condition = shift @conditions;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4346">
          <span class="hits">14</span>
          
          <code class="ruby">                $condition =~ s/HAS_TECHNICAL_OPS/$ENV{&quot;HAS_TECHNICAL_OPS&quot;}/;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4347">
          <span class="hits">14</span>
          
          <code class="ruby">                $condition =~ s/DEVELOPS_APPS/$ENV{&quot;DEVELOPS_APPS&quot;}/;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4348">
          <span class="hits">14</span>
          
          <code class="ruby">                $condition =~ s/GEN_SEC_LVL/$ENV{&quot;GEN_SEC_LVL&quot;}/;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4349">
          <span class="hits">14</span>
          
          <code class="ruby">                $condition =~ s/SEC_TRIVIAL/1/;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4350">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4351">
          <span class="hits">14</span>
          
          <code class="ruby">                eval &quot;$condition&quot; or $include = 0;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4352">
          <span class="hits">14</span>
          
          <code class="ruby">              }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4353">
          <span class="hits">14</span>
          
          <code class="ruby">            }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4354">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4355">
          <span class="hits">14</span>
          
          <code class="ruby">            print &quot;$question\n&quot; if $include;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4356">
          <span class="hits">14</span>
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4357">
          <span class="hits">14</span>
          
          <code class="ruby">        }&#39; &gt; $QUESTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4358">
          <span class="hits">14</span>
          
          <code class="ruby">      exec 12&lt; $QUESTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4359">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4360">
          <span class="hits">14</span>
          
          <code class="ruby">      local QUESTION_COUNT=1</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4361">
          <span class="hits">14</span>
          
          <code class="ruby">      while read -u 12 QUESTION; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4362">
          <span class="hits">14</span>
          
          <code class="ruby">        echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4363">
          <span class="hits">14</span>
          
          <code class="ruby">        echofmt yellow &quot;${QUESTION_COUNT}) $QUESTION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4364">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ -z &quot;$RECORD&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4365">
          <span class="hits">14</span>
          
          <code class="ruby">          RECORD=&quot;### $QUESTION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4366">
          <span class="hits">14</span>
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4367">
          <span class="hits">14</span>
          
          <code class="ruby">          RECORD=&quot;$RECORD&quot;$&#39;\n&#39;$&#39;\n&#39;&quot;### $QUESTION&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4368">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4369">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4370">
          <span class="hits">14</span>
          
          <code class="ruby">        submitQuery</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4371">
          <span class="hits">14</span>
          
          <code class="ruby">        QUESTION_COUNT=$(( $QUESTION_COUNT + 1 ))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4372">
          <span class="hits">14</span>
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4373">
          <span class="hits">14</span>
          
          <code class="ruby">      exec 12&lt;&amp;-</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4374">
          <span class="hits">14</span>
          
          <code class="ruby">      rm &quot;$QUESTIONS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4375">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4376">
          <span class="hits">14</span>
          
          <code class="ruby">    exec 11&lt;&amp;-</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4377">
          <span class="hits">14</span>
          
          <code class="ruby">    rm &quot;$CHECKS_FILES&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4378">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4379">
          <span class="hits">14</span>
          
          <code class="ruby">  exec 10&lt;&amp;-</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4380">
          <span class="hits">14</span>
          
          <code class="ruby">  rm &quot;$POLICY_DIRS&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4381">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4382">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -z &quot;$HAS_EXCEPTIONS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4383">
          <span class="hits">14</span>
          
          <code class="ruby">    RECORD=&quot;**All certifications satisfied.**&quot;$&#39;\n&#39;$&#39;\n&#39;&quot;${RECORD}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4384">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4385">
          <span class="hits">14</span>
          
          <code class="ruby">    RECORD=&quot;**EXCEPTIONS PRESENT.**&quot;$&#39;\n&#39;$&#39;\n&#39;&quot;${RECORD}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4386">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4387">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4388">
          <span class="hits">14</span>
          
          <code class="ruby">  eval $RESULT_VAR=&#39;&quot;${RECORD}&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4389">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4390">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4391">
          <span class="hits">14</span>
          
          <code class="ruby">workUpdateWorkDb() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4392">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF &gt; &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4393">
          <span class="hits">14</span>
          
          <code class="ruby">WORK_DESC=&#39;${WORK_DESC//\&#39;/}&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4394">
          <span class="hits">14</span>
          
          <code class="ruby">WORK_STARTED=&#39;$WORK_STARTED&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4395">
          <span class="hits">14</span>
          
          <code class="ruby">WORK_INITIATOR=&#39;$WORK_INITIATOR&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4396">
          <span class="hits">14</span>
          
          <code class="ruby">WORK_BRANCH=&#39;$WORK_BRANCH&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4397">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4398">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;INVOLVED_PROJECTS=&#39;${INVOLVED_PROJECTS:-}&#39;&quot; &gt;&gt; &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4399">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;WORK_ISSUES=&#39;${WORK_ISSUES:-}&#39;&quot; &gt;&gt; &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4400">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4401">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4402">
          <span class="hits">14</span>
          
          <code class="ruby">workUserSelectOne() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4403">
          <span class="hits">14</span>
          
          <code class="ruby">  local _VAR_NAME=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4404">
          <span class="hits">14</span>
          
          <code class="ruby">  local _DEFAULT_TO_CURRENT=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4405">
          <span class="hits">14</span>
          
          <code class="ruby">  local _TRIM_CURR=&quot;$1&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4406">
          <span class="hits">14</span>
          
          <code class="ruby">  local _WORK_NAME</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4407">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4408">
          <span class="hits">14</span>
          
          <code class="ruby">  if (( $# &gt; 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4409">
          <span class="hits">14</span>
          
          <code class="ruby">    exactUserArgs _WORK_NAME -- &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4410">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ ! -f &quot;${LIQ_WORK_DB}/${_WORK_NAME}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4411">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;No such unit of work &#39;$_WORK_NAME&#39;. Try selecting in interactive mode:\nliq ${GROUP} ${ACTION}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4412">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4413">
          <span class="hits">14</span>
          
          <code class="ruby">  elif [[ -n &quot;$_DEFAULT_TO_CURRENT&quot; ]] &amp;&amp; [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4414">
          <span class="hits">14</span>
          
          <code class="ruby">    _WORK_NAME=$(basename $(readlink &quot;${LIQ_WORK_DB}/curr_work&quot;))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4415">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4416">
          <span class="hits">14</span>
          
          <code class="ruby">    local _OPTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4417">
          <span class="hits">14</span>
          
          <code class="ruby">    if ls &quot;${LIQ_WORK_DB}/&quot;* &gt; /dev/null 2&gt; /dev/null; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4418">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -n &quot;$_TRIM_CURR&quot; ]] &amp;&amp; [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4419">
          <span class="hits">14</span>
          
          <code class="ruby">        local _CURR_WORK=$(basename $(readlink &quot;${LIQ_WORK_DB}/curr_work&quot;))</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4420">
          <span class="hits">14</span>
          
          <code class="ruby">        _OPTIONS=$(find &quot;${LIQ_WORK_DB}&quot; -maxdepth 1 -not -name &quot;*~&quot; -not -name &quot;$_CURR_WORK&quot; -type f -exec basename &#39;{}&#39; \; | sort || true)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4421">
          <span class="hits">14</span>
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4422">
          <span class="hits">14</span>
          
          <code class="ruby">        _OPTIONS=$(find &quot;${LIQ_WORK_DB}&quot; -maxdepth 1 -not -name &quot;*~&quot; -type f -exec basename &#39;{}&#39; \; | sort || true)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4423">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4424">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4425">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4426">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$_OPTIONS&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4427">
          <span class="hits">14</span>
          
          <code class="ruby">      echoerrandexit &quot;No outstanding work to select.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4428">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4429">
          <span class="hits">14</span>
          
          <code class="ruby">      selectOneCancel _WORK_NAME _OPTIONS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4430">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4431">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4432">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4433">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$_VAR_NAME=&#39;${_WORK_NAME}&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4434">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4435">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4436">
          <span class="hits">14</span>
          
          <code class="ruby">workSwitchBranches() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4437">
          <span class="hits">14</span>
          
          <code class="ruby">  local _BRANCH_NAME=&quot;$1&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4438">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4439">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -L &quot;${LIQ_WORK_DB}/curr_work&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4440">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepos</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4441">
          <span class="hits">14</span>
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4442">
          <span class="hits">14</span>
          
          <code class="ruby">    echo &quot;Resetting current work unit repos to &#39;master&#39;...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4443">
          <span class="hits">14</span>
          
          <code class="ruby">    local IP</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4444">
          <span class="hits">14</span>
          
          <code class="ruby">    for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4445">
          <span class="hits">14</span>
          
          <code class="ruby">      IP=&quot;${IP/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4446">
          <span class="hits">14</span>
          
          <code class="ruby">      git checkout master</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4447">
          <span class="hits">14</span>
          
          <code class="ruby">    done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4448">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4449">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4450">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ &quot;$_BRANCH_NAME&quot; != &quot;master&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4451">
          <span class="hits">14</span>
          
          <code class="ruby">    requireCleanRepos &quot;${_BRANCH_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4452">
          <span class="hits">14</span>
          
          <code class="ruby">    ( # we don&#39;t want overwrite the sourced vars</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4453">
          <span class="hits">14</span>
          
          <code class="ruby">      source &quot;${LIQ_WORK_DB}/${_BRANCH_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4454">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4455">
          <span class="hits">14</span>
          
          <code class="ruby">      for IP in $INVOLVED_PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4456">
          <span class="hits">14</span>
          
          <code class="ruby">        IP=${IP/@/}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4457">
          <span class="hits">14</span>
          
          <code class="ruby">        if [[ ! -d &quot;${LIQ_PLAYGROUND}/${IP}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4458">
          <span class="hits">14</span>
          
          <code class="ruby">          echoerr &quot;Project @${IP} is not locally available. Try:\nliq projects import ${IP}\nliq work resume ${WORK_NAME}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4459">
          <span class="hits">14</span>
          
          <code class="ruby">          continue</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4460">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4461">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4462">
          <span class="hits">14</span>
          
          <code class="ruby">        echo &quot;Updating project &#39;$IP&#39; to branch &#39;${_BRANCH_NAME}&#39;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4463">
          <span class="hits">14</span>
          
          <code class="ruby">        cd &quot;${LIQ_PLAYGROUND}/${IP}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4464">
          <span class="hits">14</span>
          
          <code class="ruby">        if git show-ref --verify --quiet &quot;refs/heads/${_BRANCH_NAME}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4465">
          <span class="hits">14</span>
          
          <code class="ruby">          git checkout &quot;${_BRANCH_NAME}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4466">
          <span class="hits">14</span>
          
          <code class="ruby">            || echoerrandexit &quot;Error updating &#39;${IP}&#39; to work branch &#39;${_BRANCH_NAME}&#39;. See above for details.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4467">
          <span class="hits">14</span>
          
          <code class="ruby">        else # the branch is not locally availble, but lets check the workspace</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4468">
          <span class="hits">14</span>
          
          <code class="ruby">          echo &quot;Work branch not locally available, checking workspace...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4469">
          <span class="hits">14</span>
          
          <code class="ruby">          git fetch --quiet workspace</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4470">
          <span class="hits">14</span>
          
          <code class="ruby">          if git show-ref --verify --quiet &quot;refs/remotes/workspace/${_BRANCH_NAME}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4471">
          <span class="hits">14</span>
          
          <code class="ruby">            git checkout --track &quot;workspace/${_BRANCH_NAME}&quot; \</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4472">
          <span class="hits">14</span>
          
          <code class="ruby">              || echoerrandexit &quot;Found branch on workspace, but there were problems checking it out.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4473">
          <span class="hits">14</span>
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4474">
          <span class="hits">14</span>
          
          <code class="ruby">            echoerrandexit &quot;Could not find the indicated work branch either localaly or on workspace. It is possible the work has been completed or dropped.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4475">
          <span class="hits">14</span>
          
          <code class="ruby">            # TODO: long term, we want to be able to resurrect old branches, and we&#39;d offer that as a &#39;try&#39; option here.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4476">
          <span class="hits">14</span>
          
          <code class="ruby">          fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4477">
          <span class="hits">14</span>
          
          <code class="ruby">        fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4478">
          <span class="hits">14</span>
          
          <code class="ruby">      done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4479">
          <span class="hits">14</span>
          
          <code class="ruby">    ) # source-isolating subshel</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4480">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4481">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4482">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4483">
          <span class="hits">14</span>
          
          <code class="ruby">work-lib-process-issues() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4484">
          <span class="hits">14</span>
          
          <code class="ruby">  local VAR=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4485">
          <span class="hits">14</span>
          
          <code class="ruby">  local CSV_ISSUES=&quot;${2}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4486">
          <span class="hits">14</span>
          
          <code class="ruby">  local BUGS_URL=&quot;${3}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4487">
          <span class="hits">14</span>
          
          <code class="ruby">  local ISSUES ISSUE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4488">
          <span class="hits">14</span>
          
          <code class="ruby">  list-from-csv &quot;${VAR}&quot; &quot;$CSV_ISSUES&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4489">
          <span class="hits">14</span>
          
          <code class="ruby">  for ISSUE in ${!VAR}; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4490">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ &quot;$ISSUE&quot; =~ ^[0-9]+$ ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4491">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;$BUGS_URL&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4492">
          <span class="hits">14</span>
          
          <code class="ruby">        echoerrandexit &quot;Cannot ref issue number outside project context. Either issue in context or use full URL.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4493">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4494">
          <span class="hits">14</span>
          
          <code class="ruby">      list-replace-by-string ${VAR} $ISSUE &quot;$BUGS_URL/$ISSUE&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4495">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4496">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4497">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4498">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4499">
          <span class="hits">14</span>
          
          <code class="ruby">work-links() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4500">
          <span class="hits">14</span>
          
          <code class="ruby">  local ACTION=&quot;${1}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4501">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4502">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ $(type -t &quot;work-links-${ACTION}&quot; || echo &#39;&#39;) == &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4503">
          <span class="hits">14</span>
          
          <code class="ruby">    work-links-${ACTION} &quot;$@&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4504">
          <span class="hits">14</span>
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4505">
          <span class="hits">14</span>
          
          <code class="ruby">    exitUnknownHelpTopic &quot;$ACTION&quot; work links</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4506">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4507">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4508">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4509">
          <span class="hits">14</span>
          
          <code class="ruby"># See &#39;liq help work links add&#39;. Also supports the internal option &#39;--set-links &lt;var name&gt;&#39; which will set the value of the indicataed variable with a lost of the packages linked.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4510">
          <span class="hits">14</span>
          
          <code class="ruby">work-links-add() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4511">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions IMPORT PROJECTS= FORCE: SET_LINKS:= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4512">
          <span class="hits">14</span>
          
          <code class="ruby">  local SOURCE_PROJ=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4513">
          <span class="hits">14</span>
          
          <code class="ruby">  local LINKS_MADE</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4514">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4515">
          <span class="hits">14</span>
          
          <code class="ruby">  local INVOLVED_PROJECTS TARGET_PROJ</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4516">
          <span class="hits">14</span>
          
          <code class="ruby">  work-links-lib-working-set # sets PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4517">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4518">
          <span class="hits">14</span>
          
          <code class="ruby">  # preflight checks</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4519">
          <span class="hits">14</span>
          
          <code class="ruby">  for TARGET_PROJ in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4520">
          <span class="hits">14</span>
          
          <code class="ruby">    [[ -d &quot;${LIQ_PLAYGROUND}/${TARGET_PROJ/@/}&quot; ]] || echoerrandexit &quot;No such target project: ${TARGET_PROJ}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4521">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4522">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4523">
          <span class="hits">14</span>
          
          <code class="ruby">  # ensure the source project is present</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4524">
          <span class="hits">14</span>
          
          <code class="ruby">  local SOURCE_PROJ_DIR=&quot;${LIQ_PLAYGROUND}/${SOURCE_PROJ//@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4525">
          <span class="hits">14</span>
          
          <code class="ruby">  if ! [[ -d &quot;${SOURCE_PROJ_DIR}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4526">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${IMPORT}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4527">
          <span class="hits">14</span>
          
          <code class="ruby">      projects-import &quot;@${SOURCE_PROJ/@/}&quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4528">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4529">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4530">
          <span class="hits">14</span>
          
          <code class="ruby">  # publish the source</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4531">
          <span class="hits">14</span>
          
          <code class="ruby">  cd &quot;${SOURCE_PROJ_DIR}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4532">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Publishing &#39;${SOURCE_PROJ_DIR}&#39; locally...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4533">
          <span class="hits">14</span>
          
          <code class="ruby">  yalc publish</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4534">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4535">
          <span class="hits">14</span>
          
          <code class="ruby">  # link to targets</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4536">
          <span class="hits">14</span>
          
          <code class="ruby">  for TARGET_PROJ in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4537">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${TARGET_PROJ/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4538">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -n &quot;Checking &#39;${TARGET_PROJ}&#39;... &quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4539">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -n &quot;${FORCE}&quot; ]] || projects-lib-has-any-dep &quot;${TARGET_PROJ/@/}&quot; &quot;${SOURCE_PROJ}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4540">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;linking...&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4541">
          <span class="hits">14</span>
          
          <code class="ruby">      yalc add &quot;@${SOURCE_PROJ/@/}&quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4542">
          <span class="hits">14</span>
          
          <code class="ruby">      list-add-item LINKS_MADE &quot;${TARGET_PROJ}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4543">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4544">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;skipping (no dependency).&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4545">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4546">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4547">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4548">
          <span class="hits">14</span>
          
          <code class="ruby">  if [[ -n &quot;${SET_LINKS}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4549">
          <span class="hits">14</span>
          
          <code class="ruby">    eval &quot;${SET_LINKS}=\&quot;${LINKS_MADE}\&quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4550">
          <span class="hits">14</span>
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4551">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4552">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4553">
          <span class="hits">14</span>
          
          <code class="ruby">work-links-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4554">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions PROJECTS= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4555">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4556">
          <span class="hits">14</span>
          
          <code class="ruby">  local INVOLVED_PROJECTS TARGET_PROJ</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4557">
          <span class="hits">14</span>
          
          <code class="ruby">  work-links-lib-working-set # sets PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4558">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4559">
          <span class="hits">14</span>
          
          <code class="ruby">  for TARGET_PROJ in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4560">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${TARGET_PROJ/@/}&quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4561">
          <span class="hits">14</span>
          
          <code class="ruby">    echo -n &quot;${TARGET_PROJ/@/}: &quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4562">
          <span class="hits">14</span>
          
          <code class="ruby">    local YALC_CHECK=&quot;$(yalc check || true)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4563">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ -z &quot;$YALC_CHECK&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4564">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;none&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4565">
          <span class="hits">14</span>
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4566">
          <span class="hits">14</span>
          
          <code class="ruby">      echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4567">
          <span class="hits">14</span>
          
          <code class="ruby">      echo &quot;$YALC_CHECK&quot; | awk -F: &#39;{print $2}&#39; | tr &quot;&#39;&quot; &#39;&quot;&#39; | jq -r &#39;.[]&#39; | sed -E &#39;s/^/- /&#39;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4568">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4569">
          <span class="hits">14</span>
          
          <code class="ruby">    echo</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4570">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4571">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4572">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4573">
          <span class="hits">14</span>
          
          <code class="ruby"># see liq help work links remove</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4574">
          <span class="hits">14</span>
          
          <code class="ruby">work-links-remove() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4575">
          <span class="hits">14</span>
          
          <code class="ruby">  eval &quot;$(setSimpleOptions NO_UPDATE:U PROJECTS= -- &quot;$@&quot;)&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4576">
          <span class="hits">14</span>
          
          <code class="ruby">  local SOURCE_PROJ=&quot;${1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4577">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4578">
          <span class="hits">14</span>
          
          <code class="ruby">  local INVOLVED_PROJECTS TARGET_PROJ</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4579">
          <span class="hits">14</span>
          
          <code class="ruby">  work-links-lib-working-set # sets PROJECTS</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4580">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4581">
          <span class="hits">14</span>
          
          <code class="ruby">  for TARGET_PROJ in $PROJECTS; do</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4582">
          <span class="hits">14</span>
          
          <code class="ruby">    cd &quot;${LIQ_PLAYGROUND}/${TARGET_PROJ/@/}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4583">
          <span class="hits">14</span>
          
          <code class="ruby">    if { yalc check || true; } | grep -q &quot;${SOURCE_PROJ}&quot;; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4584">
          <span class="hits">14</span>
          
          <code class="ruby">      yalc remove &quot;@${SOURCE_PROJ/@/}&quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4585">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ -z &quot;${NO_UPDATE}&quot; ]]; then</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4586">
          <span class="hits">14</span>
          
          <code class="ruby">        npm i &quot;@${SOURCE_PROJ/@/}&quot; # TODO: regularize reference style</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4587">
          <span class="hits">14</span>
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4588">
          <span class="hits">14</span>
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4589">
          <span class="hits">14</span>
          
          <code class="ruby">  done</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4590">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4591">
          <span class="hits">14</span>
          
          <code class="ruby">  echo &quot;Successfully unlinked &#39;${SOURCE_PROJ}&#39;.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4592">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4593">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-links() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4594">
          <span class="hits">14</span>
          
          <code class="ruby">  local PREFIX=&quot;${1:-}&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4595">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4596">
          <span class="hits">14</span>
          
          <code class="ruby">  local SUMMARY=&quot;Manage working links between projects.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4597">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4598">
          <span class="hits">14</span>
          
          <code class="ruby">  handleSummary &quot;${PREFIX}${cyan_u}work links${reset} &lt;action&gt;: ${SUMMARY}&quot; || cat &lt;&lt;EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4599">
          <span class="hits">14</span>
          
          <code class="ruby">${PREFIX}${cyan_u}projects issues${reset} &lt;action&gt;:</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4600">
          <span class="hits">14</span>
          
          <code class="ruby">  ${SUMMARY}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4601">
          <span class="hits">14</span>
          
          <code class="ruby">$(_help-actions-list work-links add list remove | indent)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4602">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4603">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4604">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4605">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-links-add() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4606">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary add &quot;[--import|-i] [--projects|-p &lt;target proj&gt;...] [--force|-f] &lt;source proj&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4607">
          <span class="hits">14</span>
          
          <code class="ruby">Links the source project to all projects in the current unit of work or the specified target projects that have a dependency on the source project. The source project must be present in the playground, unless &#39;--import&#39; is specified, in which case it will be imported if not present.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4608">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4609">
          <span class="hits">14</span>
          
          <code class="ruby">The &#39;--force&#39; option will add the dependency even if the target project is not already dependent. E.g., for use when the work adds the dependency and the source project is also being updated or is newly created.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4610">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4611">
          <span class="hits">14</span>
          
          <code class="ruby">If &#39;--projects&#39; is specified (as a space or comma separated list), then only those project, which must be in the working set, is linked to the local source project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4612">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4613">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4614">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4615">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-links-list() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4616">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary list &quot;[--projects|-p &lt;target proj&gt;...]&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4617">
          <span class="hits">14</span>
          
          <code class="ruby">List all the for each each project in the currrent unit of work or, if specified, the &#39;--projects&#39; option (a (as a space or comma separated list).</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4618">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4619">
          <span class="hits">14</span>
          
          <code class="ruby">}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4620">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4621">
          <span class="hits">14</span>
          
          <code class="ruby">help-work-links-remove() {</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4622">
          <span class="hits">14</span>
          
          <code class="ruby">  cat &lt;&lt;EOF | _help-func-summary remove &quot;[--no-update|-U] [--projects|-p &lt;target proj&gt;...] &lt;source proj&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4623">
          <span class="hits">14</span>
          
          <code class="ruby">Removes the source project link to all projects in the current unit of work. Exits in error if there are no linkes with the source project. By default, the source project package will be updated after being removed unless &#39;--no-update&#39; is specified.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4624">
          <span class="hits">14</span>
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4625">
          <span class="hits">14</span>
          
          <code class="ruby">If &#39;--projects&#39; is specified (as a space or comma separated list), then only those project, which must be in the working set, are de-linked from the source project.</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4626">
          <span class="hits">14</span>
          
          <code class="ruby">EOF</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4627">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4628">
          
          
          <code class="ruby">work-links-lib-working-set() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4629">
          
          
          <code class="ruby">  if [[ -n &quot;${PROJECTS}&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4630">
          
          
          <code class="ruby">    PROJECTS=&quot;$(echo &quot;${PROJECTS}&quot; | tr &#39;,&#39; &#39; &#39;)&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4631">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4632">
          
          
          <code class="ruby">    source &quot;${LIQ_WORK_DB}/curr_work&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4633">
          
          
          <code class="ruby">    PROJECTS=&quot;${INVOLVED_PROJECTS}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4634">
          
          
          <code class="ruby">  fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4635">
          
          
          <code class="ruby">}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4636">
          
          
          <code class="ruby"># process global overrides of the form &#39;key=&quot;value&quot;&#39;</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="4637">
          <span class="hits">16</span>
          
          <code class="ruby">while (( $# &gt; 0 )) &amp;&amp; [[ $1 == *&quot;=&quot;* ]]; do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4638">
          
          
          <code class="ruby">  eval ${1%=*}=&quot;&#39;${1#*=}&#39;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4639">
          
          
          <code class="ruby">  shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4640">
          
          
          <code class="ruby">done</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4641">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4642">
          <span class="hits">8</span>
          
          <code class="ruby">if [[ -f &quot;${LIQ_EXTS_DB}/exts.sh&quot; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4643">
          
          
          <code class="ruby">  source &quot;${LIQ_EXTS_DB}/exts.sh&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4644">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4645">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4646">
          <span class="hits">8</span>
          
          <code class="ruby">if [[ $# -lt 1 ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4647">
          
          
          <code class="ruby">  help --summary-only</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4648">
          
          
          <code class="ruby">  echoerr &quot;Invalid invocation. See help above.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4649">
          
          
          <code class="ruby">  exit 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4650">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4651">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4652">
          <span class="hits">8</span>
          
          <code class="ruby">if (( $# == 0 )); then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4653">
          
          
          <code class="ruby">  echoerrandexit &quot;No arguments provided. Try:\nliq help&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4654">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4655">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4656">
          
          
          <code class="ruby"># support for trailing &#39;help&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4657">
          <span class="hits">8</span>
          
          <code class="ruby">LAST_ARG=&quot;${@: -1}&quot;</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="4658">
          <span class="hits">16</span>
          
          <code class="ruby">if [[ &quot;${LAST_ARG}&quot; == &#39;help&#39; ]] || [[ &quot;${LAST_ARG}&quot; == &#39;?&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4659">
          
          
          <code class="ruby">  GROUP=&#39;help&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4660">
          
          
          <code class="ruby">  set -- &quot;${@:1:$(($#-1))}&quot; # &#39;pops&#39; the last arg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4661">
          
          
          <code class="ruby">else</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="4662">
          <span class="hits">16</span>
          
          <code class="ruby">  GROUP=&quot;${1:-}&quot;; shift # or global command</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4663">
          
          
          <code class="ruby">fi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4664">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4665">
          <span class="hits">8</span>
          
          <code class="ruby">case &quot;$GROUP&quot; in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4666">
          
          
          <code class="ruby">  # global actions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4667">
          
          
          <code class="ruby">  help|?)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4668">
          
          
          <code class="ruby">    help &quot;$@&quot;;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4669">
          
          
          <code class="ruby">  # components and actionsprojct</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4670">
          
          
          <code class="ruby">  *)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="4671">
          <span class="hits">8</span>
          
          <code class="ruby">    if (( $# == 0 )); then</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4672">
          <span class="hits">1</span>
          
          <code class="ruby">      help $GROUP</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4673">
          <span class="hits">1</span>
          
          <code class="ruby">      echoerrandexit &quot;\nNo action argument provided. See valid actions above.&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4674">
          <span class="hits">14</span>
          
          <code class="ruby">		elif [[ $(type -t &quot;requirements-${GROUP}&quot; || echo &#39;&#39;) != &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4675">
          
          
          <code class="ruby">			exitUnknownHelpTopic &quot;$GROUP&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4676">
          
          
          <code class="ruby">    fi</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4677">
          <span class="hits">14</span>
          
          <code class="ruby">    ACTION=&quot;${1:-}&quot;; shift</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4678">
          <span class="hits">14</span>
          
          <code class="ruby">    if [[ $(type -t &quot;${GROUP}-${ACTION}&quot; || echo &#39;&#39;) == &#39;function&#39; ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4679">
          
          
          <code class="ruby">      # the only exception to requiring a playground configuration is the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4680">
          
          
          <code class="ruby">      # &#39;playground init&#39; command</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="4681">
          <span class="hits">14</span>
          
          <code class="ruby">      if [[ &quot;$GROUP&quot; != &#39;meta&#39; ]] || [[ &quot;$ACTION&quot; != &#39;init&#39; ]]; then</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4682">
          
          
          <code class="ruby">        # source is not like other commands (?) and the attempt to replace possible source error with friendlier</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4683">
          
          
          <code class="ruby">        # message fails. The &#39;or&#39; never gets evaluated, even when source fails.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4684">
          
          
          <code class="ruby">        source &quot;${LIQ_SETTINGS}&quot; \ #2&gt; /dev/null \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4685">
          
          
          <code class="ruby">          # || echoerrandexit &quot;Could not source global Catalyst settings. Try:\nliq meta init&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4686">
          
          
          <code class="ruby">      fi</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="4687">
          <span class="hits">7</span>
          
          <code class="ruby">      requirements-${GROUP}</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="4688">
          <span class="hits">7</span>
          
          <code class="ruby">      ${GROUP}-${ACTION} &quot;$@&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4689">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4690">
          
          
          <code class="ruby">      exitUnknownHelpTopic &quot;$ACTION&quot; &quot;$GROUP&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4691">
          
          
          <code class="ruby">    fi;;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4692">
          
          
          <code class="ruby">esac</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4693">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="4694">
          <span class="hits">5</span>
          
          <code class="ruby">exit 0</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
